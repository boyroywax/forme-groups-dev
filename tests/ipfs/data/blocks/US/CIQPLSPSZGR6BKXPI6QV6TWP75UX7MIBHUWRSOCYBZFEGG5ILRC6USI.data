op()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getRandomGossipPeers",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return!0},i=this.topics.get(e);if(!i)return new Set;var o=[];return i.forEach((function(e){var t=n.streamsOutbound.get(e);t&&n.multicodecs.includes(t.protocol)&&r(e)&&o.push(e)})),o=cC(o),t>0&&o.length>t&&(o=o.slice(0,t)),new Set(o)}},{key:"onScrapeMetrics",value:function(e){var t,n;e.mcacheSize.set(this.mcache.size),e.mcacheNotValidatedCount.set(this.mcache.notValidatedCount),e.cacheSize.set({cache:"direct"},this.direct.size),e.cacheSize.set({cache:"seenCache"},this.seenCache.size),e.cacheSize.set({cache:"fastMsgIdCache"},null!==(t=null===(n=this.fastMsgIdCache)||void 0===n?void 0:n.size)&&void 0!==t?t:0),e.cacheSize.set({cache:"publishedMessageIds"},this.publishedMessageIds.size),e.cacheSize.set({cache:"mcache"},this.mcache.size),e.cacheSize.set({cache:"score"},this.score.size),e.cacheSize.set({cache:"gossipTracer.promises"},this.gossipTracer.size),e.cacheSize.set({cache:"gossipTracer.requests"},this.gossipTracer.requestMsByMsgSize),e.cacheSize.set({cache:"topics"},this.topics.size),e.cacheSize.set({cache:"subscriptions"},this.subscriptions.size),e.cacheSize.set({cache:"mesh"},this.mesh.size),e.cacheSize.set({cache:"fanout"},this.fanout.size),e.cacheSize.set({cache:"peers"},this.peers.size),e.cacheSize.set({cache:"streamsOutbound"},this.streamsOutbound.size),e.cacheSize.set({cache:"streamsInbound"},this.streamsInbound.size),e.cacheSize.set({cache:"acceptFromWhitelist"},this.acceptFromWhitelist.size),e.cacheSize.set({cache:"gossip"},this.gossip.size),e.cacheSize.set({cache:"control"},this.control.size),e.cacheSize.set({cache:"peerhave"},this.peerhave.size),e.cacheSize.set({cache:"outbound"},this.outbound.size);var r,i=0,o=(0,Ae.Z)(this.backoff.values());try{for(o.s();!(r=o.n()).done;){i+=r.value.size}}catch(A){o.e(A)}finally{o.f()}e.cacheSize.set({cache:"backoff"},i);var a,s=(0,Ae.Z)(this.topics);try{for(s.s();!(a=s.n()).done;){var u=(0,k.Z)(a.value,2),c=u[0],l=u[1];e.topicPeersCount.set({topicStr:c},l.size)}}catch(A){s.e(A)}finally{s.f()}var f,h=(0,Ae.Z)(this.mesh);try{for(h.s();!(f=h.n()).done;){var p=(0,k.Z)(f.value,2),d=p[0],v=p[1];e.meshPeerCounts.set({topicStr:d},v.size)}}catch(A){h.e(A)}finally{h.f()}var y=[],g=new Map;e.behaviourPenalty.reset();var m,b=(0,Ae.Z)(this.peers.keys());try{for(b.s();!(m=b.n()).done;){var w,E,x=m.value,_=this.score.score(x);y.push(_),g.set(x,_),e.behaviourPenalty.observe(null!==(w=null===(E=this.score.peerStats.get(x))||void 0===E?void 0:E.behaviourPenalty)&&void 0!==w?w:0)}}catch(A){b.e(A)}finally{b.f()}e.registerScores(y,this.opts.scoreThresholds),e.registerScorePerMesh(this.mesh,g);var S=function(e,t,n,r,i){var o,a={byTopic:new Map,p5w:[],p6w:[],p7w:[],score:[]},s=(0,Ae.Z)(e);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=t.get(u);if(c){var l,f=yI(u,c,n,r,i),h=(0,Ae.Z)(f.byTopic);try{for(h.s();!(l=h.n()).done;){var p=(0,k.Z)(l.value,2),d=p[0],v=p[1],y=a.byTopic.get(d);y||(y={p1w:[],p2w:[],p3w:[],p3bw:[],p4w:[]},a.byTopic.set(d,y)),y.p1w.push(v.p1w),y.p2w.push(v.p2w),y.p3w.push(v.p3w),y.p3bw.push(v.p3bw),y.p4w.push(v.p4w)}}catch(A){h.e(A)}finally{h.f()}a.p5w.push(f.p5w),a.p6w.push(f.p6w),a.p7w.push(f.p7w),a.score.push(f.score)}else a.p5w.push(0),a.p6w.push(0),a.p7w.push(0),a.score.push(0)}}catch(A){s.e(A)}finally{s.f()}return a}(this.peers.keys(),this.score.peerStats,this.score.params,this.score.peerIPs,e.topicStrToLabel);e.registerScoreWeights(S)}}]),n}(Ch);function JI(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){return new $I(t,e)}}function eD(){var e=Ut(),t=!1;return{sink:function(){var n=(0,u.Z)((0,s.Z)().mark((function n(r){return(0,s.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t){n.next=2;break}throw new Error("already piped");case 2:t=!0,e.resolve(r);case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),source:(0,g.Z)((0,s.Z)().mark((function t(){var n;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,m.Z)(e.promise);case 2:return n=t.sent,t.delegateYield((0,at.Z)((0,y.Z)(n),m.Z),"t0",4);case 4:case"end":return t.stop()}}),t)})))()}}function tD(){var e=eD(),t=eD();return[{source:e.source,sink:t.sink},{source:t.source,sink:e.sink}]}$I.multicodec=sC;var nD=65535,rD=Boolean(null===(QI=globalThis.process)||void 0===QI||null===(XI=QI.env)||void 0===XI?void 0:XI.DUMP_SESSION_KEYS),iD={hashSHA256:function(e){return Un(e)},getHKDF:function(e,t){var n=Rn(Un,t,e,void 0,96);return[n.subarray(0,32),n.subarray(32,64),n.subarray(64,96)]},generateX25519KeyPair:function(){var e=Hn.Au();return{publicKey:e.publicKey,privateKey:e.secretKey}},generateX25519KeyPairFromSeed:function(e){var t=Hn._w(e);return{publicKey:t.publicKey,privateKey:t.secretKey}},generateX25519SharedKey:function(e,t){return Hn.gi(e,t)},chaCha20Poly1305Encrypt:function(e,t,n,r){return new zn.OK(r).seal(t,e,n)},chaCha20Poly1305Decrypt:function(e,t,n,r,i){return new zn.OK(r).open(t,e,n,i)}},oD=function(e){var t,n=(t=2,globalThis.Buffer?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t));return new DataView(n.buffer,n.byteOffset,n.byteLength).setUint16(0,e,!1),n};oD.bytes=2;var aD,sD,uD=function(e){if(e.length<2)throw RangeError("Could not decode int16BE");return e instanceof Uint8Array?new DataView(e.buffer,e.byteOffset,e.byteLength).getUint16(0,!1):e.getUint16(0)};function cD(e){return aS([e.ne,e.ciphertext],e.ne.length+e.ciphertext.length)}function lD(e){return aS([e.ne,e.ns,e.ciphertext],e.ne.length+e.ns.length+e.ciphertext.length)}function fD(e){return aS([e.ns,e.ciphertext],e.ns.length+e.ciphertext.length)}function hD(e){if(e.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:e.subarray(0,32),ciphertext:e.subarray(32,e.length),ns:new Uint8Array(0)}}function pD(e){if(e.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:e.subarray(0,32),ns:e.subarray(32,80),ciphertext:e.subarray(80,e.length)}}function dD(e){if(e.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:new Uint8Array(0),ns:e.subarray(0,48),ciphertext:e.subarray(48,e.length)}}function vD(e,t){return function(){var n=(0,g.Z)((0,s.Z)().mark((function n(r){var i,o,a,u,c,l,f,h,p;return(0,s.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=!1,o=!1,n.prev=2,u=(0,y.Z)(r);case 4:return n.next=6,(0,m.Z)(u.next());case 6:if(!(i=!(c=n.sent).done)){n.next=24;break}l=c.value,f=0;case 9:if(!(f<l.length)){n.next=21;break}return(h=f+65519)>l.length&&(h=l.length),p=e.encrypt(l.subarray(f,h),e.session),null===t||void 0===t||t.encryptedPackets.increment(),n.next=16,oD(p.byteLength);case 16:return n.next=18,p;case 18:f+=65519,n.next=9;break;case 21:i=!1,n.next=4;break;case 24:n.next=30;break;case 26:n.prev=26,n.t0=n.catch(2),o=!0,a=n.t0;case 30:if(n.prev=30,n.prev=31,!i||null==u.return){n.next=35;break}return n.next=35,(0,m.Z)(u.return());case 35:if(n.prev=35,!o){n.next=38;break}throw a;case 38:return n.finish(35);case 39:return n.finish(30);case 40:case"end":return n.stop()}}),n,null,[[2,26,30,40],[31,,35,39]])})));return function(e){return n.apply(this,arguments)}}()}function yD(e,t){return function(){var n=(0,g.Z)((0,s.Z)().mark((function n(r){var i,o,a,u,c,l,f,h,p,d,v,g;return(0,s.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=!1,o=!1,n.prev=2,u=(0,y.Z)(r);case 4:return n.next=6,(0,m.Z)(u.next());case 6:if(!(i=!(c=n.sent).done)){n.next=29;break}l=c.value,f=0;case 9:if(!(f<l.length)){n.next=26;break}if((h=f+nD)>l.length&&(h=l.length),!(h-zn.pg<f)){n.next=14;break}throw new Error("Invalid chunk");case 14:if(p=l.subarray(f,h),d=l.subarray(f,h-zn.pg),v=e.decrypt(p,e.session,d),g=v.plaintext,v.valid){n.next=20;break}throw null===t||void 0===t||t.decryptErrors.increment(),new Error("Failed to validate decrypted chunk");case 20:return null===t||void 0===t||t.decryptedPackets.increment(),n.next=23,g;case 23:f+=nD,n.next=9;break;case 26:i=!1,n.next=4;break;case 29:n.next=35;break;case 31:n.prev=31,n.t0=n.catch(2),o=!0,a=n.t0;case 35:if(n.prev=35,n.prev=36,!i||null==u.return){n.next=40;break}return n.next=40,(0,m.Z)(u.return());case 40:if(n.prev=40,!o){n.next=43;break}throw a;case 43:return n.finish(40);case 44:return n.finish(35);case 45:case"end":return n.stop()}}),n,null,[[2,31,35,45],[36,,40,44]])})));return function(e){return n.apply(this,arguments)}}()}function gD(e,t,n){return mD.apply(this,arguments)}function mD(){return(mD=(0,u.Z)((0,s.Z)().mark((function e(t,n,r){var i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,wD(t,SD(n));case 2:if(i=e.sent,null!=t.publicKey){e.next=5;break}throw new Error("PublicKey was missing from local PeerId");case 5:return e.abrupt("return",bD(t.publicKey,i,r));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function bD(e,t,n){return sD.encode({identityKey:e,identitySig:t,extensions:null!==n&&void 0!==n?n:{webtransportCerthashes:[]}}).subarray()}function wD(e,t){return kD.apply(this,arguments)}function kD(){return(kD=(0,u.Z)((0,s.Z)().mark((function e(t,n){var r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t.privateKey){e.next=2;break}throw new Error("PrivateKey was missing from PeerId");case 2:return e.next=4,Cs(t.privateKey);case 4:return r=e.sent,e.abrupt("return",r.sign(n));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ED(e){return xD.apply(this,arguments)}function xD(){return(xD=(0,u.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,Ps.y5)(t.identityKey));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _D(e){return sD.decode(e)}function SD(e){var t=Dm("noise-libp2p-static-key:");return aS([t,e],t.length+e.length)}function AD(e,t,n){return ZD.apply(this,arguments)}function ZD(){return(ZD=(0,u.Z)((0,s.Z)().mark((function e(t,n,r){var i,o,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,Ps.y5)(n.identityKey);case 2:if((i=e.sent).equals(r)){e.next=5;break}throw new Error("Payload identity key ".concat(i.toString()," does not match expected remote peer ").concat(r.toString()));case 5:if(o=SD(t),null!=i.publicKey){e.next=8;break}throw new Error("PublicKey was missing from PeerId");case 8:if(null!=n.identitySig){e.next=10;break}throw new Error("Signature was missing from message");case 10:return a=Zs(i.publicKey),e.next=13,a.verify(o,n.identitySig);case 13:if(e.sent){e.next=16;break}throw new Error("Static key doesn't match to peer that signed payload!");case 16:return e.abrupt("return",i);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function TD(e){return e instanceof Uint8Array&&32===e.length}uD.bytes=2,function(e){var t;e.codec=function(){return null==t&&(t=lo((function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&t.fork(),null!=e.webtransportCerthashes){var r,i=(0,Ae.Z)(e.webtransportCerthashes);try{for(i.s();!(r=i.n()).done;){var o=r.value;t.uint32(10),t.bytes(o)}}catch(a){i.e(a)}finally{i.f()}}!1!==n.lengthDelimited&&t.ldelim()}),(function(e,t){for(var n={webtransportCerthashes:[]},r=null==t?e.len:e.pos+t;e.pos<r;){var i=e.uint32();if(i>>>3===1)n.webtransportCerthashes.push(e.bytes());else e.skipType(7&i)}return n}))),t},e.encode=function(t){return so(t,e.codec())},e.decode=function(t){return ao(t,e.codec())}}(aD||(aD={})),function(e){var t;e.codec=function(){return null==t&&(t=lo((function(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(!1!==i.lengthDelimited&&t.fork(),!0===i.writeDefaults||null!=e.identityKey&&e.identityKey.byteLength>0)&&(t.uint32(10),t.bytes(null!==(n=e.identityKey)&&void 0!==n?n:new Uint8Array(0)));(!0===i.writeDefaults||null!=e.identitySig&&e.identitySig.byteLength>0)&&(t.uint32(18),t.bytes(null!==(r=e.identitySig)&&void 0!==r?r:new Uint8Array(0)));null!=e.extensions&&(t.uint32(34),aD.codec().encode(e.extensions,t,{writeDefaults:!1})),!1!==i.lengthDelimited&&t.ldelim()}),(function(e,t){for(var n={identityKey:new Uint8Array(0),identitySig:new Uint8Array(0)},r=null==t?e.len:e.pos+t;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.identityKey=e.bytes();break;case 2:n.identitySig=e.bytes();break;case 4:n.extensions=aD.codec().decode(e,e.uint32());break;default:e.skipType(7&i)}}return n}))),t},e.encode=function(t){return so(t,e.codec())},e.decode=function(t){return ao(t,e.codec())}}(sD||(sD={}));var CD,ID=(0,ru.kg)("libp2p:noise");function DD(e){e?(CD("LOCAL_PUBLIC_EPHEMERAL_KEY ".concat(Om(e.publicKey,"hex"))),CD("LOCAL_PRIVATE_EPHEMERAL_KEY ".concat(Om(e.privateKey,"hex")))):CD("Missing local ephemeral keys.")}function OD(e){CD("REMOTE_EPHEMERAL_PUBLIC_KEY ".concat(Om(e,"hex")))}CD=rD?ID:Object.assign((function(){}),{enabled:!1,trace:function(){},error:function(){}});var RD=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;(0,K.Z)(this,e),(0,ot.Z)(this,"n",void 0),(0,ot.Z)(this,"bytes",void 0),(0,ot.Z)(this,"view",void 0),this.n=t,this.bytes=new Uint8Array(12),this.view=new DataView(this.bytes.buffer,this.bytes.byteOffset,this.bytes.byteLength),this.view.setUint32(4,t,!0)}return(0,W.Z)(e,[{key:"increment",value:function(){this.n++,this.view.setUint32(4,this.n,!0)}},{key:"getBytes",value:function(){return this.bytes}},{key:"getUint64",value:function(){return this.n}},{key:"assertValue",value:function(){if(this.n>4294967295)throw new Error("Cipherstate has reached maximum n, a new handshake must be performed")}}]),e}(),PD=function(){function e(t){(0,K.Z)(this,e),(0,ot.Z)(this,"crypto",void 0),this.crypto=t}return(0,W.Z)(e,[{key:"encryptWithAd",value:function(e,t,n){var r=this.encrypt(e.k,e.n,t,n);return e.n.increment(),r}},{key:"decryptWithAd",value:function(e,t,n,r){var i=this.decrypt(e.k,e.n,t,n,r),o=i.plaintext,a=i.valid;return a&&e.n.increment(),{plaintext:o,valid:a}}},{key:"hasKey",value:function(e){return!this.isEmptyKey(e.k)}},{key:"createEmptyKey",value:function(){return new Uint8Array(32)}},{key:"isEmptyKey",value:function(e){return lb(this.createEmptyKey(),e)}},{key:"encrypt",value:function(e,t,n,r){return t.assertValue(),this.crypto.chaCha20Poly1305Encrypt(r,t.getBytes(),n,e)}},{key:"encryptAndHash",value:function(e,t){var n;return n=this.hasKey(e.cs)?this.encryptWithAd(e.cs,e.h,t):t,this.mixHash(e,n),n}},{key:"decrypt",value:function(e,t,n,r,i){t.assertValue();var o=this.crypto.chaCha20Poly1305Decrypt(r,t.getBytes(),n,e,i);return o?{plaintext:o,valid:!0}:{plaintext:new Uint8Array(0),valid:!1}}},{key:"decryptAndHash",value:function(e,t){var n,r=!0;if(this.hasKey(e.cs)){var i=this.decryptWithAd(e.cs,e.h,t);n=i.plaintext,r=i.valid}else n=t;return this.mixHash(e,t),{plaintext:n,valid:r}}},{key:"dh",value:function(e,t){try{var n=this.crypto.generateX25519SharedKey(e,t);return 32===n.length?n:n.subarray(0,32)}catch(i){var r=i;return ID.error(r),new Uint8Array(32)}}},{key:"mixHash",value:function(e,t){e.h=this.getHash(e.h,t)}},{key:"getHash",value:function(e,t){return this.crypto.hashSHA256(aS([e,t],e.length+t.length))}},{key:"mixKey",value:function(e,t){var n=this.crypto.getHKDF(e.ck,t),r=(0,k.Z)(n,2),i=r[0],o=r[1];e.cs=this.initializeKey(o),e.ck=i}},{key:"initializeKey",value:function(e){return{k:e,n:new RD}}},{key:"initializeSymmetric",value:function(e){var t=Dm(e,"utf-8"),n=this.hashProtocolName(t),r=n,i=this.createEmptyKey();return{cs:this.initializeKey(i),ck:r,h:n}}},{key:"hashProtocolName",value:function(e){if(e.length<=32){var t=new Uint8Array(32);return t.set(e),t}return this.getHash(e,new Uint8Array(0))}},{key:"split",value:function(e){var t=this.crypto.getHKDF(e.ck,new Uint8Array(0)),n=(0,k.Z)(t,2),r=n[0],i=n[1];return{cs1:this.initializeKey(r),cs2:this.initializeKey(i)}}},{key:"writeMessageRegular",value:function(e,t){var n=this.encryptWithAd(e,new Uint8Array(0),t);return{ne:this.createEmptyKey(),ns:new Uint8Array(0),ciphertext:n}}},{key:"readMessageRegular",value:function(e,t){return this.decryptWithAd(e,new Uint8Array(0),t.ciphertext)}}]),e}(),LD=function(e){(0,X.Z)(n,e);var t=(0,$.Z)(n);function n(){return(0,K.Z)(this,n),t.apply(this,arguments)}return(0,W.Z)(n,[{key:"initializeInitiator",value:function(e,t,n,r){var i=this.initializeSymmetric("Noise_XX_25519_ChaChaPoly_SHA256");return this.mixHash(i,e),{ss:i,s:t,rs:n,psk:r,re:new Uint8Array(32)}}},{key:"initializeResponder",value:function(e,t,n,r){var i=this.initializeSymmetric("Noise_XX_25519_ChaChaPoly_SHA256");return this.mixHash(i,e),{ss:i,s:t,rs:n,psk:r,re:new Uint8Array(32)}}},{key:"writeMessageA",value:function(e,t,n){var r=new Uint8Array(0);e.e=void 0!==n?n:this.crypto.generateX25519KeyPair();var i=e.e.publicKey;return this.mixHash(e.ss,i),{ne:i,ns:r,ciphertext:this.encryptAndHash(e.ss,t)}}},{key:"writeMessageB",value:function(e,t){e.e=this.crypto.generateX25519KeyPair();var n=e.e.publicKey;this.mixHash(e.ss,n),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));var r=e.s.publicKey,i=this.encryptAndHash(e.ss,r);return this.mixKey(e.ss,this.dh(e.s.privateKey,e.re)),{ne:n,ns:i,ciphertext:this.encryptAndHash(e.ss,t)}}},{key:"writeMessageC",value:function(e,t){var n=e.s.publicKey,r=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));var i=this.encryptAndHash(e.ss,t),o={ne:this.createEmptyKey(),ns:r,ciphertext:i},a=this.split(e.ss),s=a.cs1,u=a.cs2;return{h:e.ss.h,messageBuffer:o,cs1:s,cs2:u}}},{key:"readMessageA",value:function(e,t){return TD(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),this.decryptAndHash(e.ss,t.ciphertext)}},{key:"readMessageB",value:function(e,t){if(TD(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));var n=this.decryptAndHash(e.ss,t.ns),r=n.plaintext,i=n.valid;i&&TD(r)&&(e.rs=r),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));var o=this.decryptAndHash(e.ss,t.ciphertext),a=o.plaintext,s=o.valid;return{plaintext:a,valid:i&&s}}},{key:"readMessageC",value:function(e,t){var n=this.decryptAndHash(e.ss,t.ns),r=n.plaintext,i=n.valid;if(i&&TD(r)&&(e.rs=r),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));var o=this.decryptAndHash(e.ss,t.ciphertext),a=o.plaintext,s=o.valid,u=this.split(e.ss),c=u.cs1,l=u.cs2;return{h:e.ss.h,plaintext:a,valid:i&&s,cs1:c,cs2:l}}},{key:"initSession",value:function(e,t,n){var r=this.createEmptyKey(),i=new Uint8Array(32);return{hs:e?this.initializeInitiator(t,n,i,r):this.initializeResponder(t,n,i,r),i:e,mc:0}}},{key:"sendMessage",value:function(e,t,n){var r;if(0===e.mc)r=this.writeMessageA(e.hs,t,n);else if(1===e.mc)r=this.writeMessageB(e.hs,t);else if(2===e.mc){var i=this.writeMessageC(e.hs,t),o=i.h,a=i.messageBuffer,s=i.cs1,u=i.cs2;r=a,e.h=o,e.cs1=s,e.cs2=u}else{if(!(e.mc>2))throw new Error("Session invalid.");if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");r=this.writeMessageRegular(e.cs1,t)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");r=this.writeMessageRegular(e.cs2,t)}}return e.mc++,r}},{key:"recvMessage",value:function(e,t){var n=new Uint8Array(0),r=!1;if(0===e.mc){var i=this.readMessageA(e.hs,t);n=i.plaintext,r=i.valid}else if(1===e.mc){var o=this.readMessageB(e.hs,t);n=o.plaintext,r=o.valid}else if(2===e.mc){var a=this.readMessageC(e.hs,t),s=a.h,u=a.plaintext,c=a.valid,l=a.cs1,f=a.cs2;n=u,r=c,e.h=s,e.cs1=l,e.cs2=f}return e.mc++,{plaintext:n,valid:r}}}]),n}(PD),ND=function(){function e(t,n,r,i,o,a,s,u){(0,K.Z)(this,e),(0,ot.Z)(this,"isInitiator",void 0),(0,ot.Z)(this,"session",void 0),(0,ot.Z)(this,"remotePeer",void 0),(0,ot.Z)(this,"remoteExtensions",{webtransportCerthashes:[]}),(0,ot.Z)(this,"payload",void 0),(0,ot.Z)(this,"connection",void 0),(0,ot.Z)(this,"xx",void 0),(0,ot.Z)(this,"staticKeypair",void 0),(0,ot.Z)(this,"prologue",void 0),this.isInitiator=t,this.payload=n,this.prologue=r,this.staticKeypair=o,this.connection=a,s&&(this.remotePeer=s),this.xx=null!==u&&void 0!==u?u:new LD(i),this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair)}return(0,W.Z)(e,[{key:"propose",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t,n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.session.hs.s,CD("LOCAL_STATIC_PUBLIC_KEY ".concat(Om(i.publicKey,"hex"))),CD("LOCAL_STATIC_PRIVATE_KEY ".concat(Om(i.privateKey,"hex"))),!this.isInitiator){e.next=9;break}ID.trace("Stage 0 - Initiator starting to send first message."),t=this.xx.sendMessage(this.session,new Uint8Array(0)),this.connection.writeLP(cD(t)),ID.trace("Stage 0 - Initiator finished sending first message."),DD(this.session.hs.e),e.next=20;break;case 9:return ID.trace("Stage 0 - Responder waiting to receive first message..."),e.t0=hD,e.next=13,this.connection.readLP();case 13:if(e.t1=e.sent.subarray(),n=(0,e.t0)(e.t1),r=this.xx.recvMessage(this.session,n),r.valid){e.next=18;break}throw new ir("xx handshake stage 0 validation fail");case 18:ID.trace("Stage 0 - Responder received first message."),OD(this.session.hs.re);case 20:case"end":return e.stop()}var i}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"exchange",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t,n,r,i,o,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isInitiator){e.next=34;break}return ID.trace("Stage 1 - Initiator waiting to receive first message from responder..."),e.t0=pD,e.next=5,this.connection.readLP();case 5:if(e.t1=e.sent.subarray(),t=(0,e.t0)(e.t1),n=this.xx.recvMessage(this.session,t),r=n.plaintext,n.valid){e.next=10;break}throw new ir("xx handshake stage 1 validation fail");case 10:if(ID.trace("Stage 1 - Initiator received the message."),OD(this.session.hs.re),s=this.session.hs.rs,CD("REMOTE_STATIC_PUBLIC_KEY ".concat(Om(s,"hex"))),ID.trace("Initiator going to check remote's signature..."),e.prev=14,i=_D(r),e.t2=this.remotePeer,e.t2){e.next=21;break}return e.next=20,ED(i);case 20:e.t2=e.sent;case 21:return this.remotePeer=e.t2,e.next=24,AD(this.session.hs.rs,i,this.remotePeer);case 24:this.setRemoteNoiseExtension(i.extensions),e.next=31;break;case 27:throw e.prev=27,e.t3=e.catch(14),o=e.t3,new rr("Error occurred while verifying signed payload: ".concat(o.message));case 31:ID.trace("All good with the signature!"),e.next=39;break;case 34:ID.trace("Stage 1 - Responder sending out first message with signed payload and static key."),a=this.xx.sendMessage(this.session,this.payload),this.connection.writeLP(lD(a)),ID.trace("Stage 1 - Responder sent the second handshake message with signed payload."),DD(this.session.hs.e);case 39:case"end":return e.stop()}var s}),e,this,[[14,27]])})));return function(){return e.apply(this,arguments)}}()},{key:"finish",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t,n,r,i,o,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isInitiator){e.next=7;break}ID.trace("Stage 2 - Initiator sending third handshake message."),t=this.xx.sendMessage(this.session,this.payload),this.connection.writeLP(fD(t)),ID.trace("Stage 2 - Initiator sent message with signed payload."),e.next=34;break;case 7:return ID.trace("Stage 2 - Responder waiting for third handshake message..."),e.t0=dD,e.next=11,this.connection.readLP();case 11:if(e.t1=e.sent.subarray(),n=(0,e.t0)(e.t1),r=this.xx.recvMessage(this.session,n),i=r.plaintext,r.valid){e.next=16;break}throw new ir("xx handshake stage 2 validation fail");case 16:if(ID.trace("Stage 2 - Responder received the message, finished handshake."),e.prev=17,o=_D(i),e.t2=this.remotePeer,e.t2){e.next=24;break}return e.next=23,ED(o);case 23:e.t2=e.sent;case 24:return this.remotePeer=e.t2,e.next=27,AD(this.session.hs.rs,o,this.remotePeer);case 27:this.setRemoteNoiseExtension(o.extensions),e.next=34;break;case 30:throw e.prev=30,e.t3=e.catch(17),a=e.t3,new rr("Error occurred while verifying signed payload: ".concat(a.message));case 34:(s=this.session).cs1&&s.cs2?(CD("CIPHER_STATE_1 ".concat(s.cs1.n.getUint64()," ").concat(Om(s.cs1.k,"hex"))),CD("CIPHER_STATE_2 ".concat(s.cs2.n.getUint64()," ").concat(Om(s.cs2.k,"hex")))):CD("Missing cipher state.");case 35:case"end":return e.stop()}var s}),e,this,[[17,30]])})));return function(){return e.apply(this,arguments)}}()},{key:"encrypt",value:function(e,t){var n=this.getCS(t);return this.xx.encryptWithAd(n,new Uint8Array(0),e)}},{key:"decrypt",value:function(e,t,n){var r=this.getCS(t,!1);return this.xx.decryptWithAd(r,new Uint8Array(0),e,n)}},{key:"getRemoteStaticKey",value:function(){return this.session.hs.rs}},{key:"getCS",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e.cs1||!e.cs2)throw new ir("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?t?e.cs1:e.cs2:t?e.cs2:e.cs1}},{key:"setRemoteNoiseExtension",value:function(e){e&&(this.remoteExtensions=e)}}]),e}();var BD=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,K.Z)(this,e),(0,ot.Z)(this,"protocol","/noise"),(0,ot.Z)(this,"crypto",void 0),(0,ot.Z)(this,"prologue",void 0),(0,ot.Z)(this,"staticKeys",void 0),(0,ot.Z)(this,"extensions",void 0),(0,ot.Z)(this,"metrics",void 0);var n=t.staticNoiseKey,r=t.extensions,i=t.crypto,o=t.prologueBytes,a=t.metrics;this.crypto=null!==i&&void 0!==i?i:iD,this.extensions=r,this.metrics=a?function(e){return{xxHandshakeSuccesses:e.registerCounter("libp2p_noise_xxhandshake_successes_total",{help:"Total count of noise xxHandshakes successes_"}),xxHandshakeErrors:e.registerCounter("libp2p_noise_xxhandshake_error_total",{help:"Total count of noise xxHandshakes errors"}),encryptedPackets:e.registerCounter("libp2p_noise_encrypted_packets_total",{help:"Total count of noise encrypted packets successfully"}),decryptedPackets:e.registerCounter("libp2p_noise_decrypted_packets_total",{help:"Total count of noise decrypted packets"}),decryptErrors:e.registerCounter("libp2p_noise_decrypt_errors_total",{help:"Total count of noise decrypt errors"})}}(a):void 0,this.staticKeys=n?this.crypto.generateX25519KeyPairFromSeed(n):this.crypto.generateX25519KeyPair(),this.prologue=null!==o&&void 0!==o?o:new Uint8Array(0)}return(0,W.Z)(e,[{key:"secureOutbound",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,n,r){var i,o,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=nn(n,{lengthEncoder:oD,lengthDecoder:uD,maxDataLength:nD}),e.next=3,this.performHandshake({connection:i,isInitiator:!0,localPeer:t,remotePeer:r});case 3:return o=e.sent,e.next=6,this.createSecureConnection(i,o);case 6:return a=e.sent,e.abrupt("return",{conn:a,remoteExtensions:o.remoteExtensions,remotePeer:o.remotePeer});case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"secureInbound",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,n,r){var i,o,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=nn(n,{lengthEncoder:oD,lengthDecoder:uD,maxDataLength:nD}),e.next=3,this.performHandshake({connection:i,isInitiator:!1,localPeer:t,remotePeer:r});case 3:return o=e.sent,e.next=6,this.createSecureConnection(i,o);case 6:return a=e.sent,e.abrupt("return",{conn:a,remotePeer:o.remotePeer,remoteExtensions:o.remoteExtensions});case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"performHandshake",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,gD(t.localPeer,this.staticKeys.publicKey,this.extensions);case 2:return n=e.sent,e.abrupt("return",this.performXXHandshake(t,n));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"performXXHandshake",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,n){var r,i,o,a,u,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.isInitiator,i=t.remotePeer,o=t.connection,a=new ND(r,n,this.prologue,this.crypto,this.staticKeys,o,i),e.prev=2,e.next=5,a.propose();case 5:return e.next=7,a.exchange();case 7:return e.next=9,a.finish();case 9:null===(u=this.metrics)||void 0===u||u.xxHandshakeSuccesses.increment(),e.next=18;break;case 12:if(e.prev=12,e.t0=e.catch(2),null===(c=this.metrics)||void 0===c||c.xxHandshakeErrors.increment(),!(e.t0 instanceof Error)){e.next=18;break}throw e.t0.message="Error occurred during XX handshake: ".concat(e.t0.message),e.t0;case 18:return e.abrupt("return",a);case 19:case"end":return e.stop()}}),e,this,[[2,12]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createSecureConnection",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,n){var r,i,o,a,u;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=tD(),i=(0,k.Z)(r,2),o=i[0],a=i[1],u=t.unwrap(),e.next=4,Qm(o,vD(n,this.metrics),u,(function(e){return Hb(e,{lengthDecoder:uD})}),yD(n,this.metrics),o);case 4:return e.abrupt("return",a);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}();function MD(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(){return new BD(e)}}function FD(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function jD(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?FD(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function UD(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}var zD=UD("utf8","u",(function(e){return"u"+new TextDecoder("utf8").decode(e)}),(function(e){return(new TextEncoder).encode(e.substring(1))})),HD=UD("ascii","a",(function(e){for(var t="a",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}),(function(e){for(var t=jD((e=e.substring(1)).length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t})),VD=(0,Nt.Z)({utf8:zD,"utf-8":zD,hex:cr.gh.base16,latin1:HD,ascii:HD,binary:HD},cr.gh);function GD(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8",n=VD[t];if(null==n)throw new Error('Unsupported encoding "'.concat(t,'"'));return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}function KD(e,t){null==t&&(t=e.reduce((function(e,t){return e+t.length}),0));var n,r=jD(t),i=0,o=(0,Ae.Z)(e);try{for(o.s();!(n=o.n()).done;){var a=n.value;r.set(a,i),i+=a.length}}catch(s){o.e(s)}finally{o.f()}return FD(r)}function WD(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8",n=VD[t];if(null==n)throw new Error('Unsupported encoding "'.concat(t,'"'));return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.decoder.decode("".concat(n.prefix).concat(e)):FD(globalThis.Buffer.from(e,"utf-8"))}var qD=xl.C,YD=xl.aY,QD=function e(t){var n=0;if(t=t.toString().trim(),qD(t)){var r=new Uint8Array(n+4);return t.split(/\./g).forEach((function(e){r[n++]=255&parseInt(e,10)})),r}if(YD(t)){var i,o=t.split(":",8);for(i=0;i<o.length;i++){var a=void 0;qD(o[i])&&(a=e(o[i]),o[i]=GD(a.slice(0,2),"base16")),null!=a&&++i<8&&o.splice(i,0,GD(a.slice(2,4),"base16"))}if(""===o[0])for(;o.length<8;)o.unshift("0");else if(""===o[o.length-1])for(;o.length<8;)o.push("0");else if(o.length<8){for(i=0;i<o.length&&""!==o[i];i++);var s=[i,1];for(i=9-o.length;i>0;i--)s.push("0");o.splice.apply(o,s)}var u=new Uint8Array(n+16);for(i=0;i<o.length;i++){var c=parseInt(o[i],16);u[n++]=c>>8&255,u[n++]=255&c}return u}throw new Error("invalid ip address")},XD=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;n=~~n,r=null!==(t=r)&&void 0!==t?t:e.length-n;var i=new DataView(e.buffer);if(4===r){for(var o=[],a=0;a<r;a++)o.push(e[n+a]);return o.join(".")}if(16===r){for(var s=[],u=0;u<r;u+=2)s.push(i.getUint16(n+u).toString(16));return s.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""},$D=-1,JD={},eO={};function tO(e,t,n,r,i){return{code:e,size:t,name:n,resolvable:Boolean(r),path:Boolean(i)}}function nO(e){if("number"===typeof e){if(null!=eO[e])return eO[e];throw new Error("no protocol with code: ".concat(e))}if("string"===typeof e){if(null!=JD[e])return JD[e];throw new Error("no protocol with name: ".concat(e))}throw new Error("invalid protocol id type: ".concat(typeof e))}[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,$D,"ip6zone"],[43,8,"ipcidr"],[53,$D,"dns",!0],[54,$D,"dns4",!0],[55,$D,"dns6",!0],[56,$D,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,$D,"unix",!1,!0],[421,$D,"ipfs"],[421,$D,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,$D,"garlic64"],[448,0,"tls"],[449,$D,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,$D,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,$D,"memory"]].forEach((function(e){var t=tO.apply(void 0,(0,ye.Z)(e));eO[t.code]=t,JD[t.name]=t}));nO("ip4"),nO("ip6"),nO("ipcidr");function rO(e,t){switch(nO(e).code){case 4:case 41:return function(e){var t=XD(e,0,e.length);if(null==t)throw new Error("ipBuff is required");if(!xl.h6(t))throw new Error("invalid ip address");return t}(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return fO(t);case 6:case 273:case 33:case 132:return cO(t).toString();case 421:return function(e){var t=A().decode(e),n=e.slice(A().decode.bytes);if(n.length!==t)throw new Error("inconsistent lengths");return GD(n,"base58btc")}(t);case 444:case 445:return hO(t);case 466:return function(e){var t=A().decode(e),n=e.slice(A().decode.bytes);if(n.length!==t)throw new Error("inconsistent lengths");return"u"+GD(n,"base64url")}(t);default:return GD(t,"base16")}}function iO(e,t){switch(nO(e).code){case 4:case 41:return sO(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return lO(t);case 6:case 273:case 33:case 132:return uO(parseInt(t,10));case 421:return function(e){var t;t="Q"===e[0]||"1"===e[0]?b.decode(gr.base58btc.decode("z".concat(e))).bytes:c.CID.parse(e).multihash.bytes;var n=Uint8Array.from(A().encode(t.length));return KD([n,t],n.length+t.length)}(t);case 444:return function(e){var t=e.split(":");if(2!==t.length)throw new Error("failed to parse onion addr: [\"'".concat(t.join('", "'),"'\"]' does not contain a port number"));if(16!==t[0].length)throw new Error("failed to parse onion addr: ".concat(t[0]," not a Tor onion address."));var n=kl.base32.decode("b"+t[0]),r=parseInt(t[1],10);if(r<1||r>65536)throw new Error("Port number is not in range(1, 65536)");var i=uO(r);return KD([n,i],n.length+i.length)}(t);case 445:return function(e){var t=e.split(":");if(2!==t.length)throw new Error("failed to parse onion addr: [\"'".concat(t.join('", "'),"'\"]' does not contain a port number"));if(56!==t[0].length)throw new Error("failed to parse onion addr: ".concat(t[0]," not a Tor onion3 address."));var n=kl.base32.decode("b".concat(t[0])),r=parseInt(t[1],10);if(r<1||r>65536)throw new Error("Port number is not in range(1, 65536)");var i=uO(r);return KD([n,i],n.length+i.length)}(t);case 466:return function(e){var t=aO.decode(e),n=Uint8Array.from(A().encode(t.length));return KD([n,t],n.length+t.length)}(t);default:return WD(t,"base16")}}var oO=Object.values(cr.gh).map((function(e){return e.decoder})),aO=function(){var e=oO[0].or(oO[1]);return oO.slice(2).forEach((function(t){return e=e.or(t)})),e}();function sO(e){if(!xl.h6(e))throw new Error("invalid ip address");return QD(e)}function uO(e){var t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function cO(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function lO(e){var t=WD(e),n=Uint8Array.from(A().encode(t.length));return KD([n,t],n.length+t.length)}function fO(e){var t=A().decode(e);if((e=e.slice(A().decode.bytes)).length!==t)throw new Error("inconsistent lengths");return GD(e)}function hO(e){var t=e.slice(0,e.length-2),n=e.slice(e.length-2),r=GD(t,"base32"),i=cO(n);return"".concat(r,":").concat(i)}function pO(e){return e.map((function(e){var t=xO(e);return null!=e[1]?[t.code,rO(t.code,e[1])]:[t.code]}))}function dO(e){return bO(KD(e.map((function(e){var t=xO(e),n=Uint8Array.from(A().encode(t.code));return e.length>1&&null!=e[1]&&(n=KD([n,e[1]])),n}))))}function vO(e,t){return e.size>0?e.size/8:0===e.size?0:A().decode(t)+(null!==(n=A().decode.bytes)&&void 0!==n?n:0);var n}function yO(e){for(var t=[],n=0;n<e.length;){var r,i=A().decode(e,n),o=null!==(r=A().decode.bytes)&&void 0!==r?r:0,a=vO(nO(i),e.slice(n+o));if(0!==a){var s=e.slice(n+o,n+o+a);if((n+=a+o)>e.length)throw EO("Invalid address Uint8Array: "+GD(e,"base16"));t.push([i,s])}else t.push([i]),n+=o}return t}function gO(e){return function(e){var t=[];return e.map((function(e){var n=xO(e);return t.push(n.name),e.length>1&&null!=e[1]&&t.push(e[1]),null})),kO(t.join("/"))}(pO(yO(e)))}function mO(e){var t=function(e){var t=[],n=e.split("/").slice(1);if(1===n.length&&""===n[0])return[];for(var r=0;r<n.length;r++){var i=n[r],o=nO(i);if(0!==o.size){if(++r>=n.length)throw EO("invalid address: "+e);if(!0===o.path){t.push([i,kO(n.slice(r).join("/"))]);break}t.push([i,n[r]])}else t.push([i])}return t}(e=kO(e));return dO(t.map((function(e){Array.isArray(e)||(e=[e]);var t=xO(e);return e.length>1?[t.code,iO(t.code,e[1])]:[t.code]})))}function bO(e){var t=wO(e);if(null!=t)throw t;return Uint8Array.from(e)}function wO(e){try{yO(e)}catch(t){return t}}function kO(e){return"/"+e.trim().split("/").filter((function(e){return e})).join("/")}function EO(e){return new Error("Error parsing address: "+e)}function xO(e){return nO(e[0])}var _O=Symbol.for("nodejs.util.inspect.custom"),SO=[nO("dns").code,nO("dns4").code,nO("dns6").code,nO("dnsaddr").code],AO=new Map,ZO=Symbol.for("@multiformats/js-multiaddr/multiaddr");function TO(e){return Boolean(null===e||void 0===e?void 0:e[ZO])}var CO,IO=new WeakMap,DO=new WeakMap,OO=new WeakMap,RO=new WeakMap,PO=function(){function e(t){if((0,K.Z)(this,e),(0,ot.Z)(this,"bytes",void 0),(0,cl.Z)(this,IO,{writable:!0,value:void 0}),(0,cl.Z)(this,DO,{writable:!0,value:void 0}),(0,cl.Z)(this,OO,{writable:!0,value:void 0}),(0,cl.Z)(this,RO,{writable:!0,value:void 0}),(0,ot.Z)(this,ZO,!0),null==t&&(t=""),t instanceof Uint8Array)this.bytes=bO(t);else if("string"===typeof t){if(t.length>0&&"/"!==t.charAt(0))throw new Error('multiaddr "'.concat(t,'" must start with a "/"'));this.bytes=mO(t)}else{if(!TO(t))throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=bO(t.bytes)}}return(0,W.Z)(e,[{key:"toString",value:function(){return null==(0,fl.Z)(this,IO)&&(0,ll.Z)(this,IO,gO(this.bytes)),(0,fl.Z)(this,IO)}},{key:"toJSON",value:function(){return this.toString()}},{key:"toOptions",value:function(){var e,t,n,r,i,o="",a=nO("tcp"),s=nO("udp"),u=nO("ip4"),c=nO("ip6"),l=nO("dns6"),f=nO("ip6zone"),h=(0,Ae.Z)(this.stringTuples());try{for(h.s();!(i=h.n()).done;){var p=(0,k.Z)(i.value,2),d=p[0],v=p[1];d===f.code&&(o="%".concat(null!==v&&void 0!==v?v:"")),SO.includes(d)&&(t=a.name,r=443,n="".concat(null!==v&&void 0!==v?v:"").concat(o),e=d===l.code?6:4),d!==a.code&&d!==s.code||(t=nO(d).name,r=parseInt(null!==v&&void 0!==v?v:"")),d!==u.code&&d!==c.code||(t=nO(d).name,n="".concat(null!==v&&void 0!==v?v:"").concat(o),e=d===c.code?6:4)}}catch(y){h.e(y)}finally{h.f()}if(null==e||null==t||null==n||null==r)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:n,transport:t,port:r}}},{key:"protos",value:function(){return this.protoCodes().map((function(e){return Object.assign({},nO(e))}))}},{key:"protoCodes",value:function(){for(var e=[],t=this.bytes,n=0;n<t.length;){var r,i=A().decode(t,n),o=null!==(r=A().decode.bytes)&&void 0!==r?r:0;n+=vO(nO(i),t.slice(n+o))+o,e.push(i)}return e}},{key:"protoNames",value:function(){return this.protos().map((function(e){return e.name}))}},{key:"tuples",value:function(){return null==(0,fl.Z)(this,DO)&&(0,ll.Z)(this,DO,yO(this.bytes)),(0,fl.Z)(this,DO)}},{key:"stringTuples",value:function(){return null==(0,fl.Z)(this,OO)&&(0,ll.Z)(this,OO,pO(this.tuples())),(0,fl.Z)(this,OO)}},{key:"encapsulate",value:function(t){return t=new e(t),new e(this.toString()+t.toString())}},{key:"decapsulate",value:function(t){var n=t.toString(),r=this.toString(),i=r.lastIndexOf(n);if(i<0)throw new Error("Address ".concat(this.toString()," does not contain subaddress: ").concat(t.toString()));return new e(r.slice(0,i))}},{key:"decapsulateCode",value:function(t){for(var n=this.tuples(),r=n.length-1;r>=0;r--)if(n[r][0]===t)return new e(dO(n.slice(0,r)));return this}},{key:"getPeerId",value:function(){try{var e=this.stringTuples().filter((function(e){return e[0]===JD.ipfs.code})),t=e.pop();if(null!=(null===t||void 0===t?void 0:t[1])){var n=t[1];return"Q"===n[0]||"1"===n[0]?GD(gr.base58btc.decode("z".concat(n)),"base58btc"):GD(c.CID.parse(n).multihash.bytes,"base58btc")}return null}catch(r){return null}}},{key:"getPath",value:function(){if(void 0===(0,fl.Z)(this,RO))try{(0,ll.Z)(this,RO,this.stringTuples().filter((function(e){return!0===nO(e[0]).path}))[0][1]),null==(0,fl.Z)(this,RO)&&(0,ll.Z)(this,RO,null)}catch(e){(0,ll.Z)(this,RO,null)}return(0,fl.Z)(this,RO)}},{key:"equals",value:function(e){return function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(var n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}(this.bytes,e.bytes)}},{key:"resolve",value:function(){var t=(0,u.Z)((0,s.Z)().mark((function t(n){var r,i,o;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=(r=this.protos().find((function(e){return e.resolvable})))){t.next=3;break}return t.abrupt("return",[this]);case 3:if(null!=(i=AO.get(r.name))){t.next=6;break}throw new ar.s("no available resolver for ".concat(r.name),"ERR_NO_AVAILABLE_RESOLVER");case 6:return t.next=8,i(this,n);case 8:return o=t.sent,t.abrupt("return",o.map((function(t){return new e(t)})));case 10:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"nodeAddress",value:function(){var e=this.toOptions();if("tcp"!==e.transport&&"udp"!==e.transport)throw new Error('multiaddr must have a valid format - no protocol with name: "'.concat(e.transport,'". Must have a valid transport protocol: "{tcp, udp}"'));return{family:e.family,address:e.host,port:e.port}}},{key:"isThinWaistAddress",value:function(e){var t=(null!==e&&void 0!==e?e:this).protos();return 2===t.length&&((4===t[0].code||41===t[0].code)&&(6===t[1].code||273===t[1].code))}},{key:_O,value:function(){return"Multiaddr(".concat(gO(this.bytes),")")}}]),e}();var LO=(0,ru.kg)("libp2p:bootstrap");CO=Symbol.toStringTag;var NO=function(e){(0,X.Z)(n,e);var t=(0,$.Z)(n);function n(e){var r,i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{list:[]};if((0,K.Z)(this,n),null==o.list||0===o.list.length)throw new Error("Bootstrap requires a list of peer addresses");i=t.call(this),(0,ot.Z)((0,nr.Z)(i),"timer",void 0),(0,ot.Z)((0,nr.Z)(i),"list",void 0),(0,ot.Z)((0,nr.Z)(i),"timeout",void 0),(0,ot.Z)((0,nr.Z)(i),"components",void 0),(0,ot.Z)((0,nr.Z)(i),"_init",void 0),(0,ot.Z)((0,nr.Z)(i),dk,(0,nr.Z)(i)),(0,ot.Z)((0,nr.Z)(i),CO,"@libp2p/bootstrap"),i.components=e,i.timeout=null!==(r=o.timeout)&&void 0!==r?r:1e3,i.list=[];var a,s=(0,Ae.Z)(o.list);try{for(s.s();!(a=s.n()).done;){var u=a.value;if(ed.matches(u)){var c=new PO(u),l=c.getPeerId();if(null!=l){var f={id:(0,Ps.jE)(l),multiaddrs:[c],protocols:[]};i.list.push(f)}else LO.error("Invalid bootstrap multiaddr without peer id")}else LO.error("Invalid multiaddr")}}catch(h){s.e(h)}finally{s.f()}return i._init=o,i}return(0,W.Z)(n,[{key:"isStarted",value:function(){return Boolean(this.timer)}},{key:"start",value:function(){var e=this;this.isStarted()||(LO("Starting bootstrap node discovery, discovering peers after %s ms",this.timeout),this.timer=setTimeout((function(){e._discoverBootstrapPeers().catch((function(e){LO.error(e)}))}),this.timeout))}},{key:"_discoverBootstrapPeers",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t,n,r,i,o,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.timer){e.next=2;break}return e.abrupt("return");case 2:t=(0,Ae.Z)(this.list),e.prev=3,t.s();case 5:if((n=t.n()).done){e.next=14;break}return a=n.value,e.next=9,this.components.peerStore.merge(a.id,{tags:(0,ot.Z)({},null!==(r=this._init.tagName)&&void 0!==r?r:"bootstrap",{value:null!==(i=this._init.tagValue)&&void 0!==i?i:50,ttl:null!==(o=this._init.tagTTL)&&void 0!==o?o:12e4})});case 9:if(null!=this.timer){e.next=11;break}return e.abrupt("return");case 11:this.safeDispatchEvent("peer",{detail:a});case 12:e.next=5;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(3),t.e(e.t0);case 19:return e.prev=19,t.f(),e.finish(19);case 22:case"end":return e.stop()}}),e,this,[[3,16,19,22]])})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){null!=this.timer&&clearTimeout(this.timer),this.timer=void 0}}]),n}(Ch);function BO(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function MO(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?BO(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function FO(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}(0,ot.Z)(NO,"tag","bootstrap");var jO=FO("utf8","u",(function(e){return"u"+new TextDecoder("utf8").decode(e)}),(function(e){return(new TextEncoder).encode(e.substring(1))})),UO=FO("ascii","a",(function(e){for(var t="a",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}),(function(e){for(var t=MO((e=e.substring(1)).length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t})),zO=(0,Nt.Z)({utf8:jO,"utf-8":jO,hex:cr.gh.base16,latin1:UO,ascii:UO,binary:UO},cr.gh);function HO(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8",n=zO[t];if(null==n)throw new Error('Unsupported encoding "'.concat(t,'"'));return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}function VO(e,t){null==t&&(t=e.reduce((function(e,t){return e+t.length}),0));var n,r=MO(t),i=0,o=(0,Ae.Z)(e);try{for(o.s();!(n=o.n()).done;){var a=n.value;r.set(a,i),i+=a.length}}catch(s){o.e(s)}finally{o.f()}return BO(r)}function GO(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8",n=zO[t];if(null==n)throw new Error('Unsupported encoding "'.concat(t,'"'));return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.decoder.decode("".concat(n.prefix).concat(e)):BO(globalThis.Buffer.from(e,"utf-8"))}var KO=xl.C,WO=xl.aY,qO=function e(t){var n=0;if(t=t.toString().trim(),KO(t)){var r=new Uint8Array(n+4);return t.split(/\./g).forEach((function(e){r[n++]=255&parseInt(e,10)})),r}if(WO(t)){var i,o=t.split(":",8);for(i=0;i<o.length;i++){var a=void 0;KO(o[i])&&(a=e(o[i]),o[i]=HO(a.slice(0,2),"base16")),null!=a&&++i<8&&o.splice(i,0,HO(a.slice(2,4),"base16"))}if(""===o[0])for(;o.length<8;)o.unshift("0");else if(""===o[o.length-1])for(;o.length<8;)o.push("0");else if(o.length<8){for(i=0;i<o.length&&""!==o[i];i++);var s=[i,1];for(i=9-o.length;i>0;i--)s.push("0");o.splice.apply(o,s)}var u=new Uint8Array(n+16);for(i=0;i<o.length;i++){var c=parseInt(o[i],16);u[n++]=c>>8&255,u[n++]=255&c}return u}throw new Error("invalid ip address")},YO=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;n=~~n,r=null!==(t=r)&&void 0!==t?t:e.length-n;var i=new DataView(e.buffer);if(4===r){for(var o=[],a=0;a<r;a++)o.push(e[n+a]);return o.join(".")}if(16===r){for(var s=[],u=0;u<r;u+=2)s.push(i.getUint16(n+u).toString(16));return s.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""},QO=-1,XO={},$O={};function JO(e,t,n,r,i){return{code:e,size:t,name:n,resolvable:Boolean(r),path:Boolean(i)}}function eR(e){if("number"===typeof e){if(null!=$O[e])return $O[e];throw new Error("no protocol with code: ".concat(e))}if("string"===typeof e){if(null!=XO[e])return XO[e];throw new Error("no protocol with name: ".concat(e))}throw new Error("invalid protocol id type: ".concat(typeof e))}[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,QO,"ip6zone"],[43,8,"ipcidr"],[53,QO,"dns",!0],[54,QO,"dns4",!0],[55,QO,"dns6",!0],[56,QO,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,QO,"unix",!1,!0],[421,QO,"ipfs"],[421,QO,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,QO,"garlic64"],[448,0,"tls"],[449,QO,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,QO,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,QO,"memory"]].forEach((function(e){var t=JO.apply(void 0,(0,ye.Z)(e));$O[t.code]=t,XO[t.name]=t}));eR("ip4"),eR("ip6"),eR("ipcidr");function tR(e,t){switch(eR(e).code){case 4:case 41:return function(e){var t=YO(e,0,e.length);if(null==t)throw new Error("ipBuff is required");if(!xl.h6(t))throw new Error("invalid ip address");return t}(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return cR(t);case 6:case 273:case 33:case 132:return sR(t).toString();case 421:return function(e){var t=A().decode(e),n=e.slice(A().decode.bytes);if(n.length!==t)throw new Error("inconsistent lengths");return HO(n,"base58btc")}(t);case 444:case 445:return lR(t);case 466:return function(e){var t=A().decode(e),n=e.slice(A().decode.bytes);if(n.length!==t)throw new Error("inconsistent lengths");return"u"+HO(n,"base64url")}(t);default:return HO(t,"base16")}}function nR(e,t){switch(eR(e).code){case 4:case 41:return oR(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return uR(t);case 6:case 273:case 33:case 132:return aR(parseInt(t,10));case 421:return function(e){var t;t="Q"===e[0]||"1"===e[0]?b.decode(gr.base58btc.decode("z".concat(e))).bytes:c.CID.parse(e).multihash.bytes;var n=Uint8Array.from(A().encode(t.length));return VO([n,t],n.length+t.length)}(t);case 444:return function(e){var t=e.split(":");if(2!==t.length)throw new Error("failed to parse onion addr: [\"'".concat(t.join('", "'),"'\"]' does not contain a port number"));if(16!==t[0].length)throw new Error("failed to parse onion addr: ".concat(t[0]," not a Tor onion address."));var n=kl.base32.decode("b"+t[0]),r=parseInt(t[1],10);if(r<1||r>65536)throw new Error("Port number is not in range(1, 65536)");var i=aR(r);return VO([n,i],n.length+i.length)}(t);case 445:return function(e){var t=e.split(":");if(2!==t.length)throw new Error("failed to parse onion addr: [\"'".concat(t.join('", "'),"'\"]' does not contain a port number"));if(56!==t[0].length)throw new Error("failed to parse onion addr: ".concat(t[0]," not a Tor onion3 address."));var n=kl.base32.decode("b".concat(t[0])),r=parseInt(t[1],10);if(r<1||r>65536)throw new Error("Port number is not in range(1, 65536)");var i=aR(r);return VO([n,i],n.length+i.length)}(t);case 466:return function(e){var t=iR.decode(e),n=Uint8Array.from(A().encode(t.length));return VO([n,t],n.length+t.length)}(t);default:return GO(t,"base16")}}var rR=Object.values(cr.gh).map((function(e){return e.decoder})),iR=function(){var e=rR[0].or(rR[1]);return rR.slice(2).forEach((function(t){return e=e.or(t)})),e}();function oR(e){if(!xl.h6(e))throw new Error("invalid ip address");return qO(e)}function aR(e){var t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function sR(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function uR(e){var t=GO(e),n=Uint8Array.from(A().encode(t.length));return VO([n,t],n.length+t.length)}function cR(e){var t=A().decode(e);if((e=e.slice(A().decode.bytes)).length!==t)throw new Error("inconsistent lengths");return HO(e)}function lR(e){var t=e.slice(0,e.length-2),n=e.slice(e.length-2),r=HO(t,"base32"),i=sR(n);return"".concat(r,":").concat(i)}function fR(e){return e.map((function(e){var t=kR(e);return null!=e[1]?[t.code,tR(t.code,e[1])]:[t.code]}))}function hR(e){return gR(VO(e.map((function(e){var t=kR(e),n=Uint8Array.from(A().encode(t.code));return e.length>1&&null!=e[1]&&(n=VO([n,e[1]])),n}))))}function pR(e,t){return e.size>0?e.size/8:0===e.size?0:A().decode(t)+(null!==(n=A().decode.bytes)&&void 0!==n?n:0);var n}function dR(e){for(var t=[],n=0;n<e.length;){var r,i=A().decode(e,n),o=null!==(r=A().decode.bytes)&&void 0!==r?r:0,a=pR(eR(i),e.slice(n+o));if(0!==a){var s=e.slice(n+o,n+o+a);if((n+=a+o)>e.length)throw wR("Invalid address Uint8Array: "+HO(e,"base16"));t.push([i,s])}else t.push([i]),n+=o}return t}function vR(e){return function(e){var t=[];return e.map((function(e){var n=kR(e);return t.push(n.name),e.length>1&&null!=e[1]&&t.push(e[1]),null})),bR(t.join("/"))}(fR(dR(e)))}function yR(e){var t=function(e){var t=[],n=e.split("/").slice(1);if(1===n.length&&""===n[0])return[];for(var r=0;r<n.length;r++){var i=n[r],o=eR(i);if(0!==o.size){if(++r>=n.length)throw wR("invalid address: "+e);if(!0===o.path){t.push([i,bR(n.slice(r).join("/"))]);break}t.push([i,n[r]])}else t.push([i])}return t}(e=bR(e));return hR(t.map((function(e){Array.isArray(e)||(e=[e]);var t=kR(e);return e.length>1?[t.code,nR(t.code,e[1])]:[t.code]})))}function gR(e){var t=mR(e);if(null!=t)throw t;return Uint8Array.from(e)}function mR(e){try{dR(e)}catch(t){return t}}function bR(e){return"/"+e.trim().split("/").filter((function(e){return e})).join("/")}function wR(e){return new Error("Error parsing address: "+e)}function kR(e){return eR(e[0])}var ER=Symbol.for("nodejs.util.inspect.custom"),xR=[eR("dns").code,eR("dns4").code,eR("dns6").code,eR("dnsaddr").code],_R=new Map,SR=Symbol.for("@multiformats/js-multiaddr/multiaddr");function AR(e){return Boolean(null===e||void 0===e?void 0:e[SR])}var ZR=new WeakMap,TR=new WeakMap,CR=new WeakMap,IR=new WeakMap,DR=function(){function e(t){if((0,K.Z)(this,e),(0,ot.Z)(this,"bytes",void 0),(0,cl.Z)(this,ZR,{writable:!0,value:void 0}),(0,cl.Z)(this,TR,{writable:!0,value:void 0}),(0,cl.Z)(this,CR,{writable:!0,value:void 0}),(0,cl.Z)(this,IR,{writable:!0,value:void 0}),(0,ot.Z)(this,SR,!0),null==t&&(t=""),t instanceof Uint8Array)this.bytes=gR(t);else if("string"===typeof t){if(t.length>0&&"/"!==t.charAt(0))throw new Error('multiaddr "'.concat(t,'" must start with a "/"'));this.bytes=yR(t)}else{if(!AR(t))throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=gR(t.bytes)}}return(0,W.Z)(e,[{key:"toString",value:function(){return null==(0,fl.Z)(this,ZR)&&(0,ll.Z)(this,ZR,vR(this.bytes)),(0,fl.Z)(this,ZR)}},{key:"toJSON",value:function(){return this.toString()}},{key:"toOptions",value:function(){var e,t,n,r,i,o="",a=eR("tcp"),s=eR("udp"),u=eR("ip4"),c=eR("ip6"),l=eR("dns6"),f=eR("ip6zone"),h=(0,Ae.Z)(this.stringTuples());try{for(h.s();!(i=h.n()).done;){var p=(0,k.Z)(i.value,2),d=p[0],v=p[1];d===f.code&&(o="%".concat(null!==v&&void 0!==v?v:"")),xR.includes(d)&&(t=a.name,r=443,n="".concat(null!==v&&void 0!==v?v:"").concat(o),e=d===l.code?6:4),d!==a.code&&d!==s.code||(t=eR(d).name,r=parseInt(null!==v&&void 0!==v?v:"")),d!==u.code&&d!==c.code||(t=eR(d).name,n="".concat(null!==v&&void 0!==v?v:"").concat(o),e=d===c.code?6:4)}}catch(y){h.e(y)}finally{h.f()}if(null==e||null==t||null==n||null==r)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:n,transport:t,port:r}}},{key:"protos",value:function(){return this.protoCodes().map((function(e){return Object.assign({},eR(e))}))}},{key:"protoCodes",value:function(){for(var e=[],t=this.bytes,n=0;n<t.length;){var r,i=A().decode(t,n),o=null!==(r=A().decode.bytes)&&void 0!==r?r:0;n+=pR(eR(i),t.slice(n+o))+o,e.push(i)}return e}},{key:"protoNames",value:function(){return this.protos().map((function(e){return e.name}))}},{key:"tuples",value:function(){return null==(0,fl.Z)(this,TR)&&(0,ll.Z)(this,TR,dR(this.bytes)),(0,fl.Z)(this,TR)}},{key:"stringTuples",value:function(){return null==(0,fl.Z)(this,CR)&&(0,ll.Z)(this,CR,fR(this.tuples())),(0,fl.Z)(this,CR)}},{key:"encapsulate",value:function(t){return t=new e(t),new e(this.toString()+t.toString())}},{key:"decapsulate",value:function(t){var n=t.toString(),r=this.toString(),i=r.lastIndexOf(n);if(i<0)throw new Error("Address ".concat(this.toString()," does not contain subaddress: ").concat(t.toString()));return new e(r.slice(0,i))}},{key:"decapsulateCode",value:function(t){for(var n=this.tuples(),r=n.length-1;r>=0;r--)if(n[r][0]===t)return new e(hR(n.slice(0,r)));return this}},{key:"getPeerId",value:function(){try{var e=this.stringTuples().filter((function(e){return e[0]===XO.ipfs.code})),t=e.pop();if(null!=(null===t||void 0===t?void 0:t[1])){var n=t[1];return"Q"===n[0]||"1"===n[0]?HO(gr.base58btc.decode("z".concat(n)),"base58btc"):HO(c.CID.parse(n).multihash.bytes,"base58btc")}return null}catch(r){return null}}},{key:"getPath",value:function(){if(void 0===(0,fl.Z)(this,IR))try{(0,ll.Z)(this,IR,this.stringTuples().filter((function(e){return!0===eR(e[0]).path}))[0][1]),null==(0,fl.Z)(this,IR)&&(0,ll.Z)(this,IR,null)}catch(e){(0,ll.Z)(this,IR,null)}return(0,fl.Z)(this,IR)}},{key:"equals",value:function(e){return function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(var n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}(this.bytes,e.bytes)}},{key:"resolve",value:function(){var t=(0,u.Z)((0,s.Z)().mark((function t(n){var r,i,o;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=(r=this.protos().find((function(e){return e.resolvable})))){t.next=3;break}return t.abrupt("return",[this]);case 3:if(null!=(i=_R.get(r.name))){t.next=6;break}throw new ar.s("no available resolver for ".concat(r.name),"ERR_NO_AVAILABLE_RESOLVER");case 6:return t.next=8,i(this,n);case 8:return o=t.sent,t.abrupt("return",o.map((function(t){return new e(t)})));case 10:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"nodeAddress",value:function(){var e=this.toOptions();if("tcp"!==e.transport&&"udp"!==e.transport)throw new Error('multiaddr must have a valid format - no protocol with name: "'.concat(e.transport,'". Must have a valid transport protocol: "{tcp, udp}"'));return{family:e.family,address:e.host,port:e.port}}},{key:"isThinWaistAddress",value:function(e){var t=(null!==e&&void 0!==e?e:this).protos();return 2===t.length&&((4===t[0].code||41===t[0].code)&&(6===t[1].code||273===t[1].code))}},{key:ER,value:function(){return"Multiaddr(".concat(vR(this.bytes),")")}}]),e}();function OR(e){return new DR(e)}function RR(e){var t=new globalThis.AbortController;function n(){t.abort();var r,i=(0,Ae.Z)(e);try{for(i.s();!(r=i.n()).done;){var o=r.value;null!=(null===o||void 0===o?void 0:o.removeEventListener)&&o.removeEventListener("abort",n)}}catch(a){i.e(a)}finally{i.f()}}var r,i=(0,Ae.Z)(e);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(!0===(null===o||void 0===o?void 0:o.aborted)){n();break}null!=(null===o||void 0===o?void 0:o.addEventListener)&&o.addEventListener("abort",n)}}catch(s){i.e(s)}finally{i.f()}var a=t.signal;return a.clear=function(){var t,r=(0,Ae.Z)(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;null!=(null===i||void 0===i?void 0:i.removeEventListener)&&i.removeEventListener("abort",n)}}catch(s){r.e(s)}finally{r.f()}},a}var PR=n(75584),LR=n(73925),NR=n.n(LR),BR=(0,ru.kg)("ipni-content-routing"),MR=4,FR=3e4,jR=function(){function e(t){var n,r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,K.Z)(this,e),(0,ot.Z)(this,"started",void 0),(0,ot.Z)(this,"httpQueue",void 0),(0,ot.Z)(this,"shutDownController",void 0),(0,ot.Z)(this,"clientUrl",void 0),(0,ot.Z)(this,"timeout",void 0),BR("enabled IPNI routing via",t),this.started=!1,this.shutDownController=new AbortController,this.httpQueue=new uc.Z({concurrency:null!==(n=i.concurrentRequests)&&void 0!==n?n:MR}),this.clientUrl=t instanceof URL?t:new URL(t),this.timeout=null!==(r=i.timeout)&&void 0!==r?r:FR}return(0,W.Z)(e,[{key:"isStarted",value:function(){return this.started}},{key:"start",value:function(){this.started=!0}},{key:"stop",value:function(){this.httpQueue.clear(),this.shutDownController.abort(),this.started=!1}},{key:"findProviders",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,g.Z)((0,s.Z)().mark((function r(){var i,o,a,c,l,f,h,p,d,v,g,b;return(0,s.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return BR("findProviders starts: %c",e),i=RR([t.shutDownController.signal,n.signal,AbortSignal.timeout(t.timeout)]),o=Ut(),a=Ut(),t.httpQueue.add((0,u.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o.resolve(),e.abrupt("return",a.promise);case 2:case"end":return e.stop()}}),e)})))),r.prev=5,r.next=8,(0,m.Z)(o.promise);case 8:return c="".concat(t.clientUrl,"cid/").concat(e.toString(),"?cascade=ipfs-dht"),l={headers:{Accept:"application/x-ndjson"},signal:i},r.next=12,(0,m.Z)(fetch(c,l));case 12:if(null!=(f=r.sent).body){r.next=15;break}throw new ar.s("IPNI response had no body","ERR_BAD_RESPONSE");case 15:h=!1,p=!1,r.prev=17,v=(0,y.Z)(NR()((0,PR.Z)(f.body)));case 19:return r.next=21,(0,m.Z)(v.next());case 21:if(!(h=!(g=r.sent).done)){r.next=30;break}if("gBI="===(b=g.value).Metadata){r.next=25;break}return r.abrupt("continue",27);case 25:return r.next=27,t.mapEvent(b);case 27:h=!1,r.next=19;break;case 30:r.next=36;break;case 32:r.prev=32,r.t0=r.catch(17),p=!0,d=r.t0;case 36:if(r.prev=36,r.prev=37,!h||null==v.return){r.next=41;break}return r.next=41,(0,m.Z)(v.return());case 41:if(r.prev=41,!p){r.next=44;break}throw d;case 44:return r.finish(41);case 45:return r.finish(36);case 46:r.next=51;break;case 48:r.prev=48,r.t1=r.catch(5),BR.error("findProviders errored:",r.t1);case 51:return r.prev=51,i.clear(),a.resolve(),BR("findProviders finished: %c",e),r.finish(51);case 56:case"end":return r.stop()}}),r,null,[[5,48,51,56],[17,32,36,46],[37,,41,45]])})))()}},{key:"mapEvent",value:function(e){var t,n=(0,Ps.jE)(e.Provider.ID),r=[],i=(0,Ae.Z)(e.Provider.Addrs);try{for(i.s();!(t=i.n()).done;){var o=OR(t.value);r.push(o)}}catch(a){i.e(a)}finally{i.f()}return{id:n,multiaddrs:r,protocols:[]}}},{key:"provide",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"put",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new ar.s("Not found","ERR_NOT_FOUND");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}();function UR(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(){return new jR(e,t)}}var zR=function(e){if(null!=e[Symbol.asyncIterator])return(0,u.Z)((0,s.Z)().mark((function t(){var n,r,i,o,a;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=!1,r=!1,t.prev=2,o=(0,y.Z)(e);case 4:return t.next=6,o.next();case 6:if(!(n=!(a=t.sent).done)){t.next=11;break}a.value;case 8:n=!1,t.next=4;break;case 11:t.next=17;break;case 13:t.prev=13,t.t0=t.catch(2),r=!0,i=t.t0;case 17:if(t.prev=17,t.prev=18,!n||null==o.return){t.next=22;break}return t.next=22,o.return();case 22:if(t.prev=22,!r){t.next=25;break}throw i;case 25:return t.finish(22);case 26:return t.finish(17);case 27:case"end":return t.stop()}}),t,null,[[2,13,17,27],[18,,22,26]])})))();var t,n=(0,Ae.Z)(e);try{for(n.s();!(t=n.n()).done;)t.value}catch(r){n.e(r)}finally{n.f()}},HR=function(){function e(t){if((0,K.Z)(this,e),!(t>0)||0!==(t-1&t))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(t),this.mask=t-1,this.top=0,this.btm=0,this.next=null}return(0,W.Z)(e,[{key:"push",value:function(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}},{key:"shift",value:function(){var e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}},{key:"isEmpty",value:function(){return void 0===this.buffer[this.btm]}}]),e}(),VR=function(){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,K.Z)(this,e),this.hwm=null!==(t=n.splitLimit)&&void 0!==t?t:16,this.head=new HR(this.hwm),this.tail=this.head,this.size=0}return(0,W.Z)(e,[{key:"calculateSize",value:function(e){return null!=(null===e||void 0===e?void 0:e.byteLength)?e.byteLength:1}},{key:"push",value:function(e){if(null!=(null===e||void 0===e?void 0:e.value)&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){var t=this.head;this.head=t.next=new HR(2*this.head.buffer.length),this.head.push(e)}}},{key:"shift",value:function(){var e,t=this.tail.shift();if(void 0===t&&null!=this.tail.next){var n=this.tail.next;this.tail.next=null,this.tail=n,t=this.tail.shift()}return null!=(null===(e=t)||void 0===e?void 0:e.value)&&(this.size-=this.calculateSize(t.value)),t}},{key:"isEmpty",value:function(){return this.head.isEmpty()}}]),e}();function GR(){return KR((function(e){var t=e.shift();if(null==t)return{done:!0};if(null!=t.error)throw t.error;return{done:!0===t.done,value:t.value}}),arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function KR(e,t){var n,r,i,o,a,c,l=(t=null!==(n=t)&&void 0!==n?n:{}).onEnd,f=new VR,h=function(){var t=(0,u.Z)((0,s.Z)().mark((function t(){return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(f.isEmpty()){t.next=2;break}return t.abrupt("return",e(f));case 2:if(!c){t.next=4;break}return t.abrupt("return",{done:!0});case 4:return t.next=6,new Promise((function(t,n){a=function(r){a=null,f.push(r);try{t(e(f))}catch(i){n(i)}return o}}));case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),p=function(e){return null!=a?a(e):(f.push(e),o)},d=function(e){var n;if(c)return o;if(!0!==(null===(n=t)||void 0===n?void 0:n.objectMode)&&null==(null===e||void 0===e?void 0:e.byteLength))throw new Error("objectMode was not true but tried to push non-Uint8Array value");return p({done:!1,value:e})},v=function(e){return c?o:(c=!0,null!=e?function(e){return f=new VR,null!=a?a({error:e}):(f.push({error:e}),o)}(e):p({done:!0}))};if(r={},(0,ot.Z)(r,Symbol.asyncIterator,(function(){return this})),(0,ot.Z)(r,"next",h),(0,ot.Z)(r,"return",(function(){return f=new VR,v(),{done:!0}})),(0,ot.Z)(r,"throw",(function(e){return v(e),{done:!0}})),(0,ot.Z)(r,"push",d),(0,ot.Z)(r,"end",v),Xt("get",r,"readableLength",(function(){return f.size})),o=r,null==l)return o;var y=o;return i={},(0,ot.Z)(i,Symbol.asyncIterator,(function(){return this})),(0,ot.Z)(i,"next",(function(){return y.next()})),(0,ot.Z)(i,"throw",(function(e){return y.throw(e),null!=l&&(l(e),l=void 0),{done:!0}})),(0,ot.Z)(i,"return",(function(){return y.return(),null!=l&&(l(),l=void 0),{done:!0}})),(0,ot.Z)(i,"push",d),(0,ot.Z)(i,"end",(function(e){return y.end(e),null!=l&&(l(e),l=void 0),o})),Xt("get",i,"readableLength",(function(){return y.readableLength})),o=i}var WR=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var a=o[i];null==a[Symbol.asyncIterator]&&r.push(a)}return r.length===t.length?(0,s.Z)().mark((function e(){var t,n,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=(0,Ae.Z)(r),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=8;break}return i=n.value,e.delegateYield(i,"t0",6);case 6:e.next=3;break;case 8:e.next=13;break;case 10:e.prev=10,e.t1=e.catch(1),t.e(e.t1);case 13:return e.prev=13,t.f(),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[1,10,13,16]])}))():(0,g.Z)((0,s.Z)().mark((function e(){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=GR({objectMode:!0}),Promise.resolve().then((0,u.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all(t.map(function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var r,i,o,a,u,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=!1,i=!1,e.prev=2,a=(0,y.Z)(t);case 4:return e.next=6,a.next();case 6:if(!(r=!(u=e.sent).done)){e.next=12;break}c=u.value,n.push(c);case 9:r=!1,e.next=4;break;case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(2),i=!0,o=e.t0;case 18:if(e.prev=18,e.prev=19,!r||null==a.return){e.next=23;break}return e.next=23,a.return();case 23:if(e.prev=23,!i){e.next=26;break}throw o;case 26:return e.finish(23);case 27:return e.finish(18);case 28:case"end":return e.stop()}}),e,null,[[2,14,18,28],[19,,23,27]])})));return function(t){return e.apply(this,arguments)}}()));case 3:n.end(),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),n.end(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))),e.delegateYield((0,at.Z)((0,y.Z)(n),m.Z),"t0",3);case 3:case"end":return e.stop()}}),e)})))()};function qR(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?(t=globalThis.Buffer.allocUnsafe(n),null!=globalThis.Buffer?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t):new Uint8Array(n)}function YR(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}var QR=YR("utf8","u",(function(e){return"u"+new TextDecoder("utf8").decode(e)}),(function(e){return(new TextEncoder).encode(e.substring(1))})),XR=YR("ascii","a",(function(e){for(var t="a",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}),(function(e){for(var t=qR((e=e.substring(1)).length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t})),$R=(0,Nt.Z)({utf8:QR,"utf-8":QR,hex:cr.gh.base16,latin1:XR,ascii:XR,binary:XR},cr.gh);function JR(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8",n=$R[t];if(null==n)throw new Error('Unsupported encoding "'.concat(t,'"'));return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}function eP(e,t,n){if(0===n.length){throw new ar.s("No records given","ERR_NO_RECORDS_RECEIVED")}var r=JR(t).split("/");if(r.length<3){throw new ar.s("Record key does not have a selector function","ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")}var i=e[r[1].toString()];if(null==i){var o="Unrecognized key prefix: ".concat(r[1]);throw new ar.s(o,"ERR_UNRECOGNIZED_KEY_PREFIX")}return 1===n.length?0:i(t,n)}var tP={pk:function(e,t){return 0}};function nP(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(var n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}function rP(e,t){return iP.apply(this,arguments)}function iP(){return(iP=(0,u.Z)((0,s.Z)().mark((function e(t,n){var r,i,o,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.key,i=JR(r),!((o=i.split("/")).length<3)){e.next=5;break}return e.abrupt("return");case 5:if(null!=(a=t[o[1].toString()])){e.next=9;break}throw"Invalid record keytype",new ar.s("Invalid record keytype","ERR_INVALID_RECORD_KEY_TYPE");case 9:return e.next=11,a(r,n.value);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var oP,aP=function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,n){var r,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t instanceof Uint8Array){e.next=2;break}throw new ar.s('"key" must be a Uint8Array',"ERR_INVALID_RECORD_KEY_NOT_BUFFER");case 2:if(!(t.byteLength<5)){e.next=4;break}throw new ar.s("invalid public key record","ERR_INVALID_RECORD_KEY_TOO_SHORT");case 4:if("/pk/"===JR(t.subarray(0,4))){e.next=7;break}throw new ar.s("key was not prefixed with /pk/","ERR_INVALID_RECORD_KEY_BAD_PREFIX");case 7:return r=t.slice(4),e.next=10,h.sha256.digest(n);case 10:if(i=e.sent,nP(r,i.bytes)){e.next=13;break}throw new ar.s("public key does not match passed in key","ERR_INVALID_RECORD_HASH_MISMATCH");case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),sP={pk:aP},uP=1e3,cP="/dht/provider",lP=Number(3e5),fP=Number(Number(uP)),hP=Number(5e3),pP=Number(3e5),dP=Number(3e4),vP=Number(3e4);function yP(e){var t=e.getUTCFullYear(),n=String(e.getUTCMonth()+1).padStart(2,"0"),r=String(e.getUTCDate()).padStart(2,"0"),i=String(e.getUTCHours()).padStart(2,"0"),o=String(e.getUTCMinutes()).padStart(2,"0"),a=String(e.getUTCSeconds()).padStart(2,"0"),s=e.getUTCMilliseconds(),u=String(1e3*s*1e3).padStart(9,"0");return"".concat(t,"-").concat(n,"-").concat(r,"T").concat(i,":").concat(o,":").concat(a,".").concat(u,"Z")}!function(e){var t;e.codec=function(){return null==t&&(t=lo((function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.key&&e.key.byteLength>0&&(t.uint32(10),t.bytes(e.key)),null!=e.value&&e.value.byteLength>0&&(t.uint32(18),t.bytes(e.value)),null!=e.timeReceived&&""!==e.timeReceived&&(t.uint32(42),t.string(e.timeReceived)),!1!==n.lengthDelimited&&t.ldelim()}),(function(e,t){for(var n={key:new Uint8Array(0),value:new Uint8Array(0),timeReceived:""},r=null==t?e.len:e.pos+t;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.key=e.bytes();break;case 2:n.value=e.bytes();break;case 5:n.timeReceived=e.string();break;default:e.skipType(7&i)}}return n}))),t},e.encode=function(t){return so(t,e.codec())},e.decode=function(t){return ao(t,e.codec())}}(oP||(oP={}));var gP=function(){function e(t,n,r){if((0,K.Z)(this,e),!(t instanceof Uint8Array))throw new Error("key must be a Uint8Array");if(!(n instanceof Uint8Array))throw new Error("value must be a Uint8Array");this.key=t,this.value=n,this.timeReceived=r}return(0,W.Z)(e,[{key:"serialize",value:function(){return oP.encode(this.prepareSerialize())}},{key:"prepareSerialize",value:function(){return{key:this.key,value:this.value,timeReceived:yP(this.timeReceived)}}}],[{key:"deserialize",value:function(t){var n=oP.decode(t);return new e(n.key,n.value,new Date(n.timeReceived))}},{key:"fromDeserialized",value:function(t){var n=function(e){var t=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),n=String(e).trim().match(t);if(null==n)throw new Error("Invalid format");var r=parseInt(n[1],10),i=parseInt(n[2],10)-1,o=parseInt(n[3],10),a=parseInt(n[4],10),s=parseInt(n[5],10),u=parseInt(n[6],10),c=parseInt(n[7].slice(0,-6),10);return new Date(Date.UTC(r,i,o,a,s,u,c))}(t.timeReceived);if(null==t.key)throw new Error("key missing from deserialized object");if(null==t.value)throw new Error("value missing from deserialized object");return new e(t.key,t.value,n)}}]),e}();var mP=function(e){var t=null!=e[Symbol.asyncIterator]?[e[Symbol.asyncIterator](),Symbol.asyncIterator]:[e[Symbol.iterator](),Symbol.iterator],n=(0,k.Z)(t,2),r=n[0],i=n[1],o=[];return(0,ot.Z)({peek:function(){return r.next()},push:function(e){o.push(e)},next:function(){return o.length>0?{done:!1,value:o.shift()}:r.next()}},i,(function(){return this}))};var bP,wP=function(e,t){if(null!=e[Symbol.asyncIterator])return(0,g.Z)((0,s.Z)().mark((function n(){var r,i,o,a,u,c;return(0,s.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=!1,i=!1,n.prev=2,a=(0,y.Z)(e);case 4:return n.next=6,(0,m.Z)(a.next());case 6:if(!(r=!(u=n.sent).done)){n.next=13;break}return c=u.value,n.next=10,t(c);case 10:r=!1,n.next=4;break;case 13:n.next=19;break;case 15:n.prev=15,n.t0=n.catch(2),i=!0,o=n.t0;case 19:if(n.prev=19,n.prev=20,!r||null==a.return){n.next=24;break}return n.next=24,(0,m.Z)(a.return());case 24:if(n.prev=24,!i){n.next=27;break}throw o;case 27:return n.finish(24);case 28:return n.finish(19);case 29:case"end":return n.stop()}}),n,null,[[2,15,19,29],[20,,24,28]])})))();var n=mP(e),r=n.next(),i=r.value;if(!0===r.done)return(0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))();var o=t(i);if("function"===typeof o.then)return(0,g.Z)((0,s.Z)().mark((function e(){var r,i,a,u,c,l;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,m.Z)(o);case 2:return e.next=4,e.sent;case 4:r=!1,i=!1,e.prev=6,u=(0,y.Z)(n);case 8:return e.next=10,(0,m.Z)(u.next());case 10:if(!(r=!(c=e.sent).done)){e.next=17;break}return l=c.value,e.next=14,t(l);case 14:r=!1,e.next=8;break;case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(6),i=!0,a=e.t0;case 23:if(e.prev=23,e.prev=24,!r||null==u.return){e.next=28;break}return e.next=28,(0,m.Z)(u.return());case 28:if(e.prev=28,!i){e.next=31;break}throw a;case 31:return e.finish(28);case 32:return e.finish(23);case 33:case"end":return e.stop()}}),e,null,[[6,19,23,33],[24,,28,32]])})))();var a=t;return(0,s.Z)().mark((function e(){var t,r,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o;case 2:t=(0,Ae.Z)(n),e.prev=3,t.s();case 5:if((r=t.n()).done){e.next=11;break}return i=r.value,e.next=9,a(i);case 9:e.next=5;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),t.e(e.t0);case 16:return e.prev=16,t.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[3,13,16,19]])}))()},kP=null!==(bP=globalThis.CustomEvent)&&void 0!==bP?bP:Event;function EP(e){return xP.apply(this,arguments)}function xP(){return xP=(0,g.Z)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.Z)().mark((function n(){var r,i,o,a,c,l,f,h,p,d,v,g,b,w,k;return(0,s.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:k=function(){var e,t;return(0,s.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!b()){n.next=21;break}e=0;case 2:if(!(e<f.length)){n.next=19;break}if(!f[e].done){n.next=16;break}if(t=f[e],f.splice(e,1),e--,!t.ok){n.next=12;break}return n.next=10,t.value;case 10:n.next=15;break;case 12:throw g=!0,h.resolve(),t.err;case 15:h.resolve();case 16:e++,n.next=2;break;case 19:n.next=0;break;case 21:case"end":return n.stop()}}),o)},w=function(){var e;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(f.length>0&&f[0].done)){t.next=14;break}if(e=f[0],f.shift(),!e.ok){t.next=8;break}return t.next=6,e.value;case 6:t.next=11;break;case 8:throw g=!0,h.resolve(),e.err;case 11:h.resolve(),t.next=0;break;case 14:case"end":return t.stop()}}),i)},b=function(){var e;return c?null===(e=f[0])||void 0===e?void 0:e.done:Boolean(f.find((function(e){return e.done})))},i=(0,s.Z)().mark(w),o=(0,s.Z)().mark(k),(a=null!==(r=t.concurrency)&&void 0!==r?r:1/0)<1&&(a=1/0),c=null!=t.ordered&&t.ordered,l=new EventTarget,f=[],h=Ut(),p=Ut(),d=!1,g=!1,l.addEventListener("task-complete",(function(){p.resolve()})),Promise.resolve().then((0,u.Z)((0,s.Z)().mark((function t(){var n,r,i,o,u,c;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,n=!1,r=!1,t.prev=3,o=(0,s.Z)().mark((function e(){var t,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=c.value,f.length!==a){e.next=5;break}return h=Ut(),e.next=5,h.promise;case 5:if(!g){e.next=7;break}return e.abrupt("return","break");case 7:n={done:!1},f.push(n),t().then((function(e){n.done=!0,n.ok=!0,n.value=e,l.dispatchEvent(new kP("task-complete"))}),(function(e){n.done=!0,n.err=e,l.dispatchEvent(new kP("task-complete"))}));case 10:case"end":return e.stop()}}),e)})),u=(0,y.Z)(e);case 6:return t.next=8,u.next();case 8:if(!(n=!(c=t.sent).done)){t.next=16;break}return t.delegateYield(o(),"t0",10);case 10:if("break"!==t.t0){t.next=13;break}return t.abrupt("break",16);case 13:n=!1,t.next=6;break;case 16:t.next=22;break;case 18:t.prev=18,t.t1=t.catch(3),r=!0,i=t.t1;case 22:if(t.prev=22,t.prev=23,!n||null==u.return){t.next=27;break}return t.next=27,u.return();case 27:if(t.prev=27,!r){t.next=30;break}throw i;case 30:return t.finish(27);case 31:return t.finish(22);case 32:d=!0,l.dispatchEvent(new kP("task-complete")),t.next=40;break;case 36:t.prev=36,t.t2=t.catch(0),v=t.t2,l.dispatchEvent(new kP("task-complete"));case 40:case"end":return t.stop()}}),t,null,[[0,36],[3,18,22,32],[23,,27,31]])}))));case 15:if(b()){n.next=20;break}return p=Ut(),n.next=20,(0,m.Z)(p.promise);case 20:if(null==v){n.next=22;break}throw v;case 22:if(!c){n.next=26;break}return n.delegateYield((0,at.Z)((0,y.Z)(w()),m.Z),"t0",24);case 24:n.next=27;break;case 26:return n.delegateYield((0,at.Z)((0,y.Z)(k()),m.Z),"t1",27);case 27:if(!d||0!==f.length){n.next=29;break}return n.abrupt("break",31);case 29:n.next=15;break;case 31:case"end":return n.stop()}}),n)}))()})),xP.apply(this,arguments)}function _P(e){if(null==e)throw new Error("Empty pipeline");if(TP(e)){var t=e;e=function(){return t.source}}else if(ZP(e)||AP(e)){var n=e;e=function(){return n}}for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];var a=[e].concat(i);if(a.length>1&&TP(a[a.length-1])&&(a[a.length-1]=a[a.length-1].sink),a.length>2)for(var s=1;s<a.length-1;s++)TP(a[s])&&(a[s]=CP(a[s]));return SP.apply(void 0,(0,ye.Z)(a))}var SP=function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(;n.length>0;)e=n.shift()(e);return e},AP=function(e){return null!=(null===e||void 0===e?void 0:e[Symbol.asyncIterator])},ZP=function(e){return null!=(null===e||void 0===e?void 0:e[Symbol.iterator])},TP=function(e){return null!=e&&(null!=e.sink&&null!=e.source)},CP=function(e){return function(t){var n=e.sink(t);if(null!=(null===n||void 0===n?void 0:n.then)){var r,i=GR({objectMode:!0});n.then((function(){i.end()}),(function(e){i.end(e)}));var o=e.source;if(AP(o))r=function(){var e=(0,g.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield((0,at.Z)((0,y.Z)(o),m.Z),"t0",1);case 1:i.end();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();else{if(!ZP(o))throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");r=(0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(o,"t0",1);case 1:i.end();case 2:case"end":return e.stop()}}),e)}))}return WR(i,r())}return e.source}};function IP(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(var n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}function DP(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function OP(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?DP(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function RP(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}var PP=RP("utf8","u",(function(e){return"u"+new TextDecoder("utf8").decode(e)}),(function(e){return(new TextEncoder).encode(e.substring(1))})),LP=RP("ascii","a",(function(e){for(var t="a",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}),(function(e){for(var t=OP((e=e.substring(1)).length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t})),NP=(0,Nt.Z)({utf8:PP,"utf-8":PP,hex:cr.gh.base16,latin1:LP,ascii:LP,binary:LP},cr.gh);function BP(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8",n=NP[t];if(null==n)throw new Error('Unsupported encoding "'.concat(t,'"'));return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}function MP(e,t){null==t&&(t=e.reduce((function(e,t){return e+t.length}),0));var n,r=OP(t),i=0,o=(0,Ae.Z)(e);try{for(o.s();!(n=o.n()).done;){var a=n.value;r.set(a,i),i+=a.length}}catch(s){o.e(s)}finally{o.f()}return DP(r)}function FP(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8",n=NP[t];if(null==n)throw new Error('Unsupported encoding "'.concat(t,'"'));return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.decoder.decode("".concat(n.prefix).concat(e)):DP(globalThis.Buffer.from(e,"utf-8"))}var jP=xl.C,UP=xl.aY,zP=function e(t){var n=0;if(t=t.toString().trim(),jP(t)){var r=new Uint8Array(n+4);return t.split(/\./g).forEach((function(e){r[n++]=255&parseInt(e,10)})),r}if(UP(t)){var i,o=t.split(":",8);for(i=0;i<o.length;i++){var a=void 0;jP(o[i])&&(a=e(o[i]),o[i]=BP(a.slice(0,2),"base16")),null!=a&&++i<8&&o.splice(i,0,BP(a.slice(2,4),"base16"))}if(""===o[0])for(;o.length<8;)o.unshift("0");else if(""===o[o.length-1])for(;o.length<8;)o.push("0");else if(o.length<8){for(i=0;i<o.length&&""!==o[i];i++);var s=[i,1];for(i=9-o.length;i>0;i--)s.push("0");o.splice.apply(o,s)}var u=new Uint8Array(n+16);for(i=0;i<o.length;i++){var c=parseInt(o[i],16);u[n++]=c>>8&255,u[n++]=255&c}return u}throw new Error("invalid ip address")},HP=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;n=~~n,r=null!==(t=r)&&void 0!==t?t:e.length-n;var i=new DataView(e.buffer);if(4===r){for(var o=[],a=0;a<r;a++)o.push(e[n+a]);return o.join(".")}if(16===r){for(var s=[],u=0;u<r;u+=2)s.push(i.getUint16(n+u).toString(16));return s.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""},VP=-1,GP={},KP={};function WP(e,t,n,r,i){return{code:e,size:t,name:n,resolvable:Boolean(r),path:Boolean(i)}}function qP(e){if("number"===typeof e){if(null!=KP[e])return KP[e];throw new Error("no protocol with code: ".concat(e))}if("string"===typeof e){if(null!=GP[e])return GP[e];throw new Error("no protocol with name: ".concat(e))}throw new Error("invalid protocol id type: ".concat(typeof e))}[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,VP,"ip6zone"],[43,8,"ipcidr"],[53,VP,"dns",!0],[54,VP,"dns4",!0],[55,VP,"dns6",!0],[56,VP,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,VP,"unix",!1,!0],[421,VP,"ipfs"],[421,VP,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,VP,"garlic64"],[448,0,"tls"],[449,VP,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,VP,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,VP,"memory"]].forEach((function(e){var t=WP.apply(void 0,(0,ye.Z)(e));KP[t.code]=t,GP[t.name]=t}));qP("ip4"),qP("ip6"),qP("ipcidr");function YP(e,t){switch(qP(e).code){case 4:case 41:return function(e){var t=HP(e,0,e.length);if(null==t)throw new Error("ipBuff is required");if(!xl.h6(t))throw new Error("invalid ip address");return t}(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return rL(t);case 6:case 273:case 33:case 132:return tL(t).toString();case 421:return function(e){var t=A().decode(e),n=e.slice(A().decode.bytes);if(n.length!==t)throw new Error("inconsistent lengths");return BP(n,"base58btc")}(t);case 444:case 445:return iL(t);case 466:return function(e){var t=A().decode(e),n=e.slice(A().decode.bytes);if(n.length!==t)throw new Error("inconsistent lengths");return"u"+BP(n,"base64url")}(t);default:return BP(t,"base16")}}function QP(e,t){switch(qP(e).code){case 4:case 41:return JP(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return nL(t);case 6:case 273:case 33:case 132:return eL(parseInt(t,10));case 421:return function(e){var t;t="Q"===e[0]||"1"===e[0]?b.decode(gr.base58btc.decode("z".concat(e))).bytes:c.CID.parse(e).multihash.bytes;var n=Uint8Array.from(A().encode(t.length));return MP([n,t],n.length+t.length)}(t);case 444:return function(e){var t=e.split(":");if(2!==t.length)throw new Error("failed to parse onion addr: [\"'".concat(t.join('", "'),"'\"]' does not contain a port number"));if(16!==t[0].length)throw new Error("failed to parse onion addr: ".concat(t[0]," not a Tor onion address."));var n=kl.base32.decode("b"+t[0]),r=parseInt(t[1],10);if(r<1||r>65536)throw new Error("Port number is not in range(1, 65536)");var i=eL(r);return MP([n,i],n.length+i.length)}(t);case 445:return function(e){var t=e.split(":");if(2!==t.length)throw new Error("failed to parse onion addr: [\"'".concat(t.join('", "'),"'\"]' does not contain a port number"));if(56!==t[0].length)throw new Error("failed to parse onion addr: ".concat(t[0]," not a Tor onion3 address."));var n=kl.base32.decode("b".concat(t[0])),r=parseInt(t[1],10);if(r<1||r>65536)throw new Error("Port number is not in range(1, 65536)");var i=eL(r);return MP([n,i],n.length+i.length)}(t);case 466:return function(e){var t=$P.decode(e),n=Uint8Array.from(A().encode(t.length));return MP([n,t],n.length+t.length)}(t);default:return FP(t,"base16")}}var XP=Object.values(cr.gh).map((function(e){return e.decoder})),$P=function(){var e=XP[0].or(XP[1]);return XP.slice(2).forEach((function(t){return e=e.or(t)})),e}();function JP(e){if(!xl.h6(e))throw new Error("invalid ip address");return zP(e)}function eL(e){var t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function tL(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function nL(e){var t=FP(e),n=Uint8Array.from(A().encode(t.length));return MP([n,t],n.length+t.length)}function rL(e){var t=A().decode(e);if((e=e.slice(A().decode.bytes)).length!==t)throw new Error("inconsistent lengths");return BP(e)}function iL(e){var t=e.slice(0,e.length-2),n=e.slice(e.length-2),r=BP(t,"base32"),i=tL(n);return"".concat(r,":").concat(i)}function oL(e){return e.map((function(e){var t=vL(e);return null!=e[1]?[t.code,YP(t.code,e[1])]:[t.code]}))}function aL(e){return fL(MP(e.map((function(e){var t=vL(e),n=Uint8Array.from(A().encode(t.code));return e.length>1&&null!=e[1]&&(n=MP([n,e[1]])),n}))))}function sL(e,t){return e.size>0?e.size/8:0===e.size?0:A().decode(t)+(null!==(n=A().decode.bytes)&&void 0!==n?n:0);var n}function uL(e){for(var t=[],n=0;n<e.length;){var r,i=A().decode(e,n),o=null!==(r=A().decode.bytes)&&void 0!==r?r:0,a=sL(qP(i),e.slice(n+o));if(0!==a){var s=e.slice(n+o,n+o+a);if((n+=a+o)>e.length)throw dL("Invalid address Uint8Array: "+BP(e,"base16"));t.push([i,s])}else t.push([i]),n+=o}return t}function cL(e){return function(e){var t=[];return e.map((function(e){var n=vL(e);return t.push(n.name),e.length>1&&null!=e[1]&&t.push(e[1]),null})),pL(t.join("/"))}(oL(uL(e)))}function lL(e){var t=function(e){var t=[],n=e.split("/").slice(1);if(1===n.length&&""===n[0])return[];for(var r=0;r<n.length;r++){var i=n[r],o=qP(i);if(0!==o.size){if(++r>=n.length)throw dL("invalid address: "+e);if(!0===o.path){t.push([i,pL(n.slice(r).join("/"))]);break}t.push([i,n[r]])}else t.push([i])}return t}(e=pL(e));return aL(t.map((function(e){Array.isArray(e)||(e=[e]);var t=vL(e);return e.length>1?[t.code,QP(t.code,e[1])]:[t.code]})))}function fL(e){var t=hL(e);if(null!=t)throw t;return Uint8Array.from(e)}function hL(e){try{uL(e)}catch(t){return t}}function pL(e){return"/"+e.trim().split("/").filter((function(e){return e})).join("/")}function dL(e){return new Error("Error parsing address: "+e)}function vL(e){return qP(e[0])}var yL=Symbol.for("nodejs.util.inspect.custom"),gL=[qP("dns").code,qP("dns4").code,qP("dns6").code,qP("dnsaddr").code],mL=new Map,bL=Symbol.for("@multiformats/js-multiaddr/multiaddr");function wL(e){return Boolean(null===e||void 0===e?void 0:e[bL])}var kL,EL,xL=new WeakMap,_L=new WeakMap,SL=new WeakMap,AL=new WeakMap,ZL=function(){function e(t){if((0,K.Z)(this,e),(0,ot.Z)(this,"bytes",void 0),(0,cl.Z)(this,xL,{writable:!0,value:void 0}),(0,cl.Z)(this,_L,{writable:!0,value:void 0}),(0,cl.Z)(this,SL,{writable:!0,value:void 0}),(0,cl.Z)(this,AL,{writable:!0,value:void 0}),(0,ot.Z)(this,bL,!0),null==t&&(t=""),t instanceof Uint8Array)this.bytes=fL(t);else if("string"===typeof t){if(t.length>0&&"/"!==t.charAt(0))throw new Error('multiaddr "'.concat(t,'" must start with a "/"'));this.bytes=lL(t)}else{if(!wL(t))throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=fL(t.bytes)}}return(0,W.Z)(e,[{key:"toString",value:function(){return null==(0,fl.Z)(this,xL)&&(0,ll.Z)(this,xL,cL(this.bytes)),(0,fl.Z)(this,xL)}},{key:"toJSON",value:function(){return this.toString()}},{key:"toOptions",value:function(){var e,t,n,r,i,o="",a=qP("tcp"),s=qP("udp"),u=qP("ip4"),c=qP("ip6"),l=qP("dns6"),f=qP("ip6zone"),h=(0,Ae.Z)(this.stringTuples());try{for(h.s();!(i=h.n()).done;){var p=(0,k.Z)(i.value,2),d=p[0],v=p[1];d===f.code&&(o="%".concat(null!==v&&void 0!==v?v:"")),gL.includes(d)&&(t=a.name,r=443,n="".concat(null!==v&&void 0!==v?v:"").concat(o),e=d===l.code?6:4),d!==a.code&&d!==s.code||(t=qP(d).name,r=parseInt(null!==v&&void 0!==v?v:"")),d!==u.code&&d!==c.code||(t=qP(d).name,n="".concat(null!==v&&void 0!==v?v:"").concat(o),e=d===c.code?6:4)}}catch(y){h.e(y)}finally{h.f()}if(null==e||null==t||null==n||null==r)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:n,transport:t,port:r}}},{key:"protos",value:function(){return this.protoCodes().map((function(e){return Object.assign({},qP(e))}))}},{key:"protoCodes",value:function(){for(var e=[],t=this.bytes,n=0;n<t.length;){var r,i=A().decode(t,n),o=null!==(r=A().decode.bytes)&&void 0!==r?r:0;n+=sL(qP(i),t.slice(n+o))+o,e.push(i)}return e}},{key:"protoNames",value:function(){return this.protos().map((function(e){return e.name}))}},{key:"tuples",value:function(){return null==(0,fl.Z)(this,_L)&&(0,ll.Z)(this,_L,uL(this.bytes)),(0,fl.Z)(this,_L)}},{key:"stringTuples",value:function(){return null==(0,fl.Z)(this,SL)&&(0,ll.Z)(this,SL,oL(this.tuples())),(0,fl.Z)(this,SL)}},{key:"encapsulate",value:function(t){return t=new e(t),new e(this.toString()+t.toString())}},{key:"decapsulate",value:function(t){var n=t.toString(),r=this.toString(),i=r.lastIndexOf(n);if(i<0)throw new Error("Address ".concat(this.toString()," does not contain subaddress: ").concat(t.toString()));return new e(r.slice(0,i))}},{key:"decapsulateCode",value:function(t){for(var n=this.tuples(),r=n.length-1;r>=0;r--)if(n[r][0]===t)return new e(aL(n.slice(0,r)));return this}},{key:"getPeerId",value:function(){try{var e=this.stringTuples().filter((function(e){return e[0]===GP.ipfs.code})),t=e.pop();if(null!=(null===t||void 0===t?void 0:t[1])){var n=t[1];return"Q"===n[0]||"1"===n[0]?BP(gr.base58btc.decode("z".concat(n)),"base58btc"):BP(c.CID.parse(n).multihash.bytes,"base58btc")}return null}catch(r){return null}}},{key:"getPath",value:function(){if(void 0===(0,fl.Z)(this,AL))try{(0,ll.Z)(this,AL,this.stringTuples().filter((function(e){return!0===qP(e[0]).path}))[0][1]),null==(0,fl.Z)(this,AL)&&(0,ll.Z)(this,AL,null)}catch(e){(0,ll.Z)(this,AL,null)}return(0,fl.Z)(this,AL)}},{key:"equals",value:function(e){return IP(this.bytes,e.bytes)}},{key:"resolve",value:function(){var t=(0,u.Z)((0,s.Z)().mark((function t(n){var r,i,o;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=(r=this.protos().find((function(e){return e.resolvable})))){t.next=3;break}return t.abrupt("return",[this]);case 3:if(null!=(i=mL.get(r.name))){t.next=6;break}throw new ar.s("no available resolver for ".concat(r.name),"ERR_NO_AVAILABLE_RESOLVER");case 6:return t.next=8,i(this,n);case 8:return o=t.sent,t.abrupt("return",o.map((function(t){return new e(t)})));case 10:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"nodeAddress",value:function(){var e=this.toOptions();if("tcp"!==e.transport&&"udp"!==e.transport)throw new Error('multiaddr must have a valid format - no protocol with name: "'.concat(e.transport,'". Must have a valid transport protocol: "{tcp, udp}"'));return{family:e.family,address:e.host,port:e.port}}},{key:"isThinWaistAddress",value:function(e){var t=(null!==e&&void 0!==e?e:this).protos();return 2===t.length&&((4===t[0].code||41===t[0].code)&&(6===t[1].code||273===t[1].code))}},{key:yL,value:function(){return"Multiaddr(".concat(cL(this.bytes),")")}}]),e}();!function(e){var t;e.codec=function(){return null==t&&(t=lo((function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.key&&(t.uint32(10),t.bytes(e.key)),null!=e.value&&(t.uint32(18),t.bytes(e.value)),null!=e.author&&(t.uint32(26),t.bytes(e.author)),null!=e.signature&&(t.uint32(34),t.bytes(e.signature)),null!=e.timeReceived&&(t.uint32(42),t.string(e.timeReceived)),!1!==n.lengthDelimited&&t.ldelim()}),(function(e,t){for(var n={},r=null==t?e.len:e.pos+t;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.key=e.bytes();break;case 2:n.value=e.bytes();break;case 3:n.author=e.bytes();break;case 4:n.signature=e.bytes();break;case 5:n.timeReceived=e.string();break;default:e.skipType(7&i)}}return n}))),t},e.encode=function(t){return so(t,e.codec())},e.decode=function(t){return ao(t,e.codec())}}(kL||(kL={})),function(e){var t,n,r;!function(e){e.PUT_VALUE="PUT_VALUE",e.GET_VALUE="GET_VALUE",e.ADD_PROVIDER="ADD_PROVIDER",e.GET_PROVIDERS="GET_PROVIDERS",e.FIND_NODE="FIND_NODE",e.PING="PING"}(e.MessageType||(e.MessageType={})),function(e){e[e.PUT_VALUE=0]="PUT_VALUE",e[e.GET_VALUE=1]="GET_VALUE",e[e.ADD_PROVIDER=2]="ADD_PROVIDER",e[e.GET_PROVIDERS=3]="GET_PROVIDERS",e[e.FIND_NODE=4]="FIND_NODE",e[e.PING=5]="PING"}(t||(t={})),function(e){e.codec=function(){return co(t)}}(e.MessageType||(e.MessageType={})),function(e){e.NOT_CONNECTED="NOT_CONNECTED",e.CONNECTED="CONNECTED",e.CAN_CONNECT="CAN_CONNECT",e.CANNOT_CONNECT="CANNOT_CONNECT"}(e.ConnectionType||(e.ConnectionType={})),function(e){e[e.NOT_CONNECTED=0]="NOT_CONNECTED",e[e.CONNECTED=1]="CONNECTED",e[e.CAN_CONNECT=2]="CAN_CONNECT",e[e.CANNOT_CONNECT=3]="CANNOT_CONNECT"}(n||(n={})),function(e){e.codec=function(){return co(n)}}(e.ConnectionType||(e.ConnectionType={})),function(t){var n;t.codec=function(){return null==n&&(n=lo((function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==r.lengthDelimited&&n.fork(),null!=t.id&&(n.uint32(10),n.bytes(t.id)),null!=t.addrs){var i,o=(0,Ae.Z)(t.addrs);try{for(o.s();!(i=o.n()).done;){var a=i.value;n.uint32(18),n.bytes(a)}}catch(s){o.e(s)}finally{o.f()}}null!=t.connection&&(n.uint32(24),e.ConnectionType.codec().encode(t.connection,n)),!1!==r.lengthDelimited&&n.ldelim()}),(function(t,n){for(var r={addrs:[]},i=null==n?t.len:t.pos+n;t.pos<i;){var o=t.uint32();switch(o>>>3){case 1:r.id=t.bytes();break;case 2:r.addrs.push(t.bytes());break;case 3:r.connection=e.ConnectionType.codec().decode(t);break;default:t.skipType(7&o)}}return r}))),n},t.encode=function(e){return so(e,t.codec())},t.decode=function(e){return ao(e,t.codec())}}(e.Peer||(e.Peer={})),e.codec=function(){return null==r&&(r=lo((function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==r.lengthDelimited&&n.fork(),null!=t.type&&(n.uint32(8),e.MessageType.codec().encode(t.type,n)),null!=t.clusterLevelRaw&&(n.uint32(80),n.int32(t.clusterLevelRaw)),null!=t.key&&(n.uint32(18),n.bytes(t.key)),null!=t.record&&(n.uint32(26),n.bytes(t.record)),null!=t.closerPeers){var i,o=(0,Ae.Z)(t.closerPeers);try{for(o.s();!(i=o.n()).done;){var a=i.value;n.uint32(66),e.Peer.codec().encode(a,n)}}catch(l){o.e(l)}finally{o.f()}}if(null!=t.providerPeers){var s,u=(0,Ae.Z)(t.providerPeers);try{for(u.s();!(s=u.n()).done;){var c=s.value;n.uint32(74),e.Peer.codec().encode(c,n)}}catch(l){u.e(l)}finally{u.f()}}!1!==r.lengthDelimited&&n.ldelim()}),(function(t,n){for(var r={closerPeers:[],providerPeers:[]},i=null==n?t.len:t.pos+n;t.pos<i;){var o=t.uint32();switch(o>>>3){case 1:r.type=e.MessageType.codec().decode(t);break;case 10:r.clusterLevelRaw=t.int32();break;case 2:r.key=t.bytes();break;case 3:r.record=t.bytes();break;case 8:r.closerPeers.push(e.Peer.codec().decode(t,t.uint32()));break;case 9:r.providerPeers.push(e.Peer.codec().decode(t,t.uint32()));break;default:t.skipType(7&o)}}return r}))),r},e.encode=function(t){return so(t,e.codec())},e.decode=function(t){return ao(t,e.codec())}}(EL||(EL={}));var TL=EL.MessageType,CL=EL.ConnectionType,IL=Object.keys(TL),DL=function(){function e(t,n,r){if((0,K.Z)(this,e),(0,ot.Z)(this,"type",void 0),(0,ot.Z)(this,"key",void 0),(0,ot.Z)(this,"clusterLevelRaw",void 0),(0,ot.Z)(this,"closerPeers",void 0),(0,ot.Z)(this,"providerPeers",void 0),(0,ot.Z)(this,"record",void 0),!(n instanceof Uint8Array))throw new Error("Key must be a Uint8Array");this.type=t,this.key=n,this.clusterLevelRaw=r,this.closerPeers=[],this.providerPeers=[],this.record=void 0}return(0,W.Z)(e,[{key:"clusterLevel",get:function(){var e=this.clusterLevelRaw-1;return e<0?0:e},set:function(e){this.clusterLevelRaw=e}},{key:"serialize",value:function(){return EL.encode({key:this.key,type:this.type,clusterLevelRaw:this.clusterLevelRaw,closerPeers:this.closerPeers.map(OL),providerPeers:this.providerPeers.map(OL),record:null==this.record?void 0:this.record.serialize().subarray()})}}],[{key:"deserialize",value:function(t){var n,r,i,o,a=EL.decode(t),s=new e(null!==(n=a.type)&&void 0!==n?n:EL.MessageType.PUT_VALUE,null!==(r=a.key)&&void 0!==r?r:Uint8Array.from([]),null!==(i=a.clusterLevelRaw)&&void 0!==i?i:0);return s.closerPeers=a.closerPeers.map(RL),s.providerPeers=a.providerPeers.map(RL),null!=(null===(o=a.record)||void 0===o?void 0:o.length)&&(s.record=gP.deserialize(a.record)),s}}]),e}();function OL(e){var t;return{id:e.id.toBytes(),addrs:(null!==(t=e.multiaddrs)&&void 0!==t?t:[]).map((function(e){return e.bytes})),connection:CL.CONNECTED}}function RL(e){var t;if(null==e.id)throw new Error("Invalid peer in message");return{id:(0,Ps.cv)(e.id),multiaddrs:(null!==(t=e.addrs)&&void 0!==t?t:[]).map((function(e){return new ZL(e)})),protocols:[]}}function PL(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,Nt.Z)((0,Nt.Z)({},e),{},{name:"SEND_QUERY",type:0,messageName:e.type,messageType:IL.indexOf(e.type.toString())});return null===(t=n.onProgress)||void 0===t||t.call(n,new Dh("kad-dht:query:send-query",{detail:r})),r}function LL(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,Nt.Z)((0,Nt.Z)({},e),{},{name:"PEER_RESPONSE",type:1,messageName:e.messageType,closer:null!=e.closer?e.closer:[],providers:null!=e.providers?e.providers:[]});return null===(t=n.onProgress)||void 0===t||t.call(n,new Dh("kad-dht:query:peer-response",{detail:r})),r}function NL(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,Nt.Z)((0,Nt.Z)({},e),{},{name:"FINAL_PEER",type:2});return null===(t=n.onProgress)||void 0===t||t.call(n,new Dh("kad-dht:query:final-peer",{detail:r})),r}function BL(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,Nt.Z)((0,Nt.Z)({},e),{},{name:"QUERY_ERROR",type:3});return null===(t=n.onProgress)||void 0===t||t.call(n,new Dh("kad-dht:query:query-error",{detail:r})),r}function ML(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,Nt.Z)((0,Nt.Z)({},e),{},{name:"PROVIDER",type:4});return null===(t=n.onProgress)||void 0===t||t.call(n,new Dh("kad-dht:query:provider",{detail:r})),r}function FL(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,Nt.Z)((0,Nt.Z)({},e),{},{name:"VALUE",type:5});return null===(t=n.onProgress)||void 0===t||t.call(n,new Dh("kad-dht:query:value",{detail:r})),r}function jL(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,Nt.Z)((0,Nt.Z)({},e),{},{name:"DIAL_PEER",type:7});return null===(t=n.onProgress)||void 0===t||t.call(n,new Dh("kad-dht:query:dial-peer",{detail:r})),r}var UL,zL="/",HL=(new TextEncoder).encode(zL),VL=HL[0];UL=Symbol.toStringTag;var GL=function(){function e(t,n){if((0,K.Z)(this,e),(0,ot.Z)(this,"_buf",void 0),"string"===typeof t)this._buf=FP(t);else{if(!(t instanceof Uint8Array))throw new Error("Invalid key, should be String of Uint8Array");this._buf=t}if(null==n&&(n=!0),n&&this.clean(),0===this._buf.byteLength||this._buf[0]!==VL)throw new Error("Invalid key")}return(0,W.Z)(e,[{key:"toString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"utf8";return BP(this._buf,e)}},{key:"uint8Array",value:function(){return this._buf}},{key:UL,get:function(){return"Key(".concat(this.toString(),")")}},{key:"clean",value:function(){if(null!=this._buf&&0!==this._buf.byteLength||(this._buf=HL),this._buf[0]!==VL){var e=new Uint8Array(this._buf.byteLength+1);e.fill(VL,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===VL;)this._buf=this._buf.subarray(0,-1)}},{key:"less",value:function(e){for(var t=this.list(),n=e.list(),r=0;r<t.length;r++){if(n.length<r+1)return!1;var i=t[r],o=n[r];if(i<o)return!0;if(i>o)return!1}return t.length<n.length}},{key:"reverse",value:function(){return e.withNamespaces(this.list().slice().reverse())}},{key:"namespaces",value:function(){return this.list()}},{key:"baseNamespace",value:function(){var e=this.namespaces();return e[e.length-1]}},{key:"list",value:function(){return this.toString().split(zL).slice(1)}},{key:"type",value:function(){return function(e){var t=e.split(":");if(t.length<2)return"";return t.slice(0,-1).join(":")}(this.baseNamespace())}},{key:"name",value:function(){return function(e){var t=e.split(":");return t[t.length-1]}(this.baseNamespace())}},{key:"instance",value:function(t){return new e(this.toString()+":"+t)}},{key:"path",value:function(){var t=this.parent().toString();return t.endsWith(zL)||(t+=zL),new e(t+=this.type())}},{key:"parent",value:function(){var t=this.list();return 1===t.length?new e(zL):new e(t.slice(0,-1).join(zL))}},{key:"child",value:function(t){return this.toString()===zL?t:t.toString()===zL?this:new e(this.toString()+t.toString(),!1)}},{key:"isAncestorOf",value:function(e){return e.toString()!==this.toString()&&e.toString().startsWith(this.toString())}},{key:"isDecendantOf",value:function(e){return e.toString()!==this.toString()&&this.toString().startsWith(e.toString())}},{key:"isTopLevel",value:function(){return 1===this.list().length}},{key:"concat",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.withNamespaces([].concat((0,ye.Z)(this.namespaces()),(0,ye.Z)(function(e){var t;return(t=[]).concat.apply(t,(0,ye.Z)(e))}(n.map((function(e){return e.namespaces()}))))))}}],[{key:"withNamespaces",value:function(t){return new e(t.join(zL))}},{key:"random",value:function(){return new e(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;return crypto.getRandomValues(new Uint8Array(e)).reduce((function(e,t){return e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")}),"")}().replace(/-/g,""))}},{key:"asKey",value:function(t){return t instanceof Uint8Array||"string"===typeof t?new e(t):"function"===typeof t.uint8Array?new e(t.uint8Array()):null}}]),e}();var KL=FP("/pk/");function WL(e){return(0,Nt.Z)((0,Nt.Z)({},e),{},{multiaddrs:e.multiaddrs.filter((function(e){var t=e.stringTuples(),n=(0,k.Z)(t,1),r=(0,k.Z)(n[0],2),i=r[0],o=r[1];if(53===i||54===i||55===i)return"localhost"!==o;if(4!==i&&6!==i)return!1;if(null==o)return!1;var a=bA(o);return null==a||!a}))})}function qL(e){return(0,Nt.Z)((0,Nt.Z)({},e),{},{multiaddrs:e.multiaddrs.filter((function(e){var t=e.stringTuples(),n=(0,k.Z)(t,1),r=(0,k.Z)(n[0],2),i=r[0],o=r[1];if("localhost"===o)return!0;if(4!==i&&6!==i)return!1;if(null==o)return!1;var a=bA(o);return null!=a&&a}))})}function YL(e){return QL.apply(this,arguments)}function QL(){return(QL=(0,u.Z)((0,s.Z)().mark((function e(t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.sha256.digest(t);case 2:return n=e.sent,e.abrupt("return",n.digest);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function XL(e){return $L.apply(this,arguments)}function $L(){return($L=(0,u.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",YL(t.toBytes()));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function JL(e){return new GL("".concat("/dht/record","/").concat(BP(e,"base32")),!1)}function eN(e){return MP([KL,e.toBytes()])}function tN(e){return"/pk/"===BP(e.subarray(0,4))}function nN(e){return(0,Ps.cv)(e.subarray(4))}function rN(e,t){var n=new Date;return new gP(e,t,n).serialize()}var iN=function(){function e(t,n){(0,K.Z)(this,e),(0,ot.Z)(this,"log",void 0),(0,ot.Z)(this,"components",void 0),(0,ot.Z)(this,"validators",void 0),(0,ot.Z)(this,"selectors",void 0),(0,ot.Z)(this,"peerRouting",void 0),(0,ot.Z)(this,"queryManager",void 0),(0,ot.Z)(this,"network",void 0);var r=n.validators,i=n.selectors,o=n.peerRouting,a=n.queryManager,s=n.network,u=n.lan;this.components=t,this.log=(0,ru.kg)("libp2p:kad-dht:".concat(u?"lan":"wan",":content-fetching")),this.validators=r,this.selectors=i,this.peerRouting=o,this.queryManager=a,this.network=s}return(0,W.Z)(e,[{key:"putLocal",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,n){var r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=JL(t),e.next=3,this.components.datastore.put(r,n);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getLocal",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.log("getLocal %b",t),n=JL(t),this.log("fetching record for key %k",n),e.next=5,this.components.datastore.get(n);case 5:return r=e.sent,this.log("found %k in local datastore",n),i=gP.deserialize(r),e.next=10,rP(this.validators,i);case 10:return e.abrupt("return",i);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendCorrectionRecord",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return(0,g.Z)((0,s.Z)().mark((function o(){var a,u,c,l,f,h,p,d,v,g,b,w,k,E,x;return(0,s.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:r.log("sendCorrection for %b",e),a=rN(e,n),u=(0,Ae.Z)(t),o.prev=3,u.s();case 5:if((c=u.n()).done){o.next=61;break}if(l=c.value,f=l.value,h=l.from,!IP(f,n)){o.next=10;break}return r.log("record was ok"),o.abrupt("continue",59);case 10:if(!r.components.peerId.equals(h)){o.next=22;break}return o.prev=11,p=JL(e),r.log("Storing corrected record for key ".concat(p.toString())),o.next=16,(0,m.Z)(r.components.datastore.put(p,a.subarray()));case 16:o.next=21;break;case 18:o.prev=18,o.t0=o.catch(11),r.log.error("Failed error correcting self",o.t0);case 21:return o.abrupt("continue",59);case 22:d=!1,(v=new DL(TL.PUT_VALUE,e,0)).record=gP.deserialize(a),g=!1,b=!1,o.prev=27,k=(0,y.Z)(r.network.sendRequest(h,v,i));case 29:return o.next=31,(0,m.Z)(k.next());case 31:if(!(g=!(E=o.sent).done)){o.next=39;break}return"PEER_RESPONSE"===(x=E.value).name&&null!=x.record&&IP(x.record.value,gP.deserialize(a).value)&&(d=!0),o.next=36,x;case 36:g=!1,o.next=29;break;case 39:o.next=45;break;case 41:o.prev=41,o.t1=o.catch(27),b=!0,w=o.t1;case 45:if(o.prev=45,o.prev=46,!g||null==k.return){o.next=50;break}return o.next=50,(0,m.Z)(k.return());case 50:if(o.prev=50,!b){o.next=53;break}throw w;case 53:return o.finish(50);case 54:return o.finish(45);case 55:if(d){o.next=58;break}return o.next=58,BL({from:h,error:new ar.s("value not put correctly","ERR_PUT_VALUE_INVALID")},i);case 58:r.log.error("Failed error correcting entry");case 59:o.next=5;break;case 61:o.next=66;break;case 63:o.prev=63,o.t2=o.catch(3),u.e(o.t2);case 66:return o.prev=66,u.f(),o.finish(66);case 69:case"end":return o.stop()}}),o,null,[[3,63,66,69],[11,18],[27,41,45,55],[46,,50,54]])})))()}},{key:"put",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,g.Z)((0,s.Z)().mark((function i(){var o,a;return(0,s.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return n.log("put key %b value %b",e,t),o=rN(e,t),a=JL(e),n.log("storing record for key ".concat(a.toString())),i.next=6,(0,m.Z)(n.components.datastore.put(a,o.subarray()));case 6:return i.delegateYield((0,at.Z)((0,y.Z)(_P(n.peerRouting.getClosestPeers(e,{signal:r.signal}),(function(t){return wP(t,(function(t){return(0,u.Z)((0,s.Z)().mark((function i(){var a,u,c,l,f,h,p,d;return(0,s.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if("FINAL_PEER"===t.name){i.next=2;break}return i.abrupt("return",[t]);case 2:a=[],(u=new DL(TL.PUT_VALUE,e,0)).record=gP.deserialize(o),n.log("send put to %p",t.peer.id),c=!1,l=!1,i.prev=8,h=(0,y.Z)(n.network.sendRequest(t.peer.id,u,r));case 10:return i.next=12,h.next();case 12:if(!(c=!(p=i.sent).done)){i.next=21;break}if(d=p.value,a.push(d),"PEER_RESPONSE"===d.name){i.next=17;break}return i.abrupt("continue",18);case 17:null!=d.record&&IP(d.record.value,gP.deserialize(o).value)||a.push(BL({from:t.peer.id,error:new ar.s("value not put correctly","ERR_PUT_VALUE_INVALID")},r));case 18:c=!1,i.next=10;break;case 21:i.next=27;break;case 23:i.prev=23,i.t0=i.catch(8),l=!0,f=i.t0;case 27:if(i.prev=27,i.prev=28,!c||null==h.return){i.next=32;break}return i.next=32,h.return();case 32:if(i.prev=32,!l){i.next=35;break}throw f;case 35:return i.finish(32);case 36:return i.finish(27);case 37:return i.abrupt("return",a);case 38:case"end":return i.stop()}}),i,null,[[8,23,27,37],[28,,32,36]])})))}))}),(function(e){return EP(e,{ordered:!1,concurrency:3})}),function(){var e=(0,g.Z)((0,s.Z)().mark((function e(t){var n,r,i,o,a,u;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!1,r=!1,e.prev=2,o=(0,y.Z)(t);case 4:return e.next=6,(0,m.Z)(o.next());case 6:if(!(n=!(a=e.sent).done)){e.next=12;break}return u=a.value,e.delegateYield((0,at.Z)((0,y.Z)(u),m.Z),"t0",9);case 9:n=!1,e.next=4;break;case 12:e.next=18;break;case 14:e.prev=14,e.t1=e.catch(2),r=!0,i=e.t1;case 18:if(e.prev=18,e.prev=19,!n||null==o.return){e.next=23;break}return e.next=23,(0,m.Z)(o.return());case 23:if(e.prev=23,!r){e.next=26;break}throw i;case 26:return e.finish(23);case 27:return e.finish(18);case 28:case"end":return e.stop()}}),e,null,[[2,14,18,28],[19,,23,27]])})));return function(t){return e.apply(this,arguments)}}())),m.Z),"t0",7);case 7:case"end":return i.stop()}}),i)})))()}},{key:"get",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,g.Z)((0,s.Z)().mark((function r(){var i,o,a,u,c,l,f,h,p,d;return(0,s.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t.log("get %b",e),i=[],o=!1,a=!1,r.prev=4,c=(0,y.Z)(t.getMany(e,n));case 6:return r.next=8,(0,m.Z)(c.next());case 8:if(!(o=!(l=r.sent).done)){r.next=16;break}return"VALUE"===(f=l.value).name&&i.push(f),r.next=13,f;case 13:o=!1,r.next=6;break;case 16:r.next=22;break;case 18:r.prev=18,r.t0=r.catch(4),a=!0,u=r.t0;case 22:if(r.prev=22,r.prev=23,!o||null==c.return){r.next=27;break}return r.next=27,(0,m.Z)(c.return());case 27:if(r.prev=27,!a){r.next=30;break}throw u;case 30:return r.finish(27);case 31:return r.finish(22);case 32:if(0!==i.length){r.next=34;break}return r.abrupt("return");case 34:h=i.map((function(e){return e.value})),p=0,r.prev=36,p=eP(t.selectors,e,h),r.next=44;break;case 40:if(r.prev=40,r.t1=r.catch(36),"ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY"===r.t1.code){r.next=44;break}throw r.t1;case 44:if(d=h[p],t.log("GetValue %b %b",e,d),null!=d){r.next=48;break}throw new ar.s("best value was not found","ERR_NOT_FOUND");case 48:return r.delegateYield((0,at.Z)((0,y.Z)(t.sendCorrectionRecord(e,i,d,n)),m.Z),"t2",49);case 49:return r.next=51,i[p];case 51:case"end":return r.stop()}}),r,null,[[4,18,22,32],[23,,27,31],[36,40]])})))()}},{key:"getMany",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,g.Z)((0,s.Z)().mark((function r(){var i,o,a;return(0,s.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t.log("getMany values for %b",e),r.prev=1,r.next=4,(0,m.Z)(t.getLocal(e));case 4:return i=r.sent,r.next=7,FL({value:i.value,from:t.components.peerId},n);case 7:r.next=12;break;case 9:r.prev=9,r.t0=r.catch(1),t.log("error getting local value for %b",e,r.t0);case 12:return o=t,a=function(){var t=(0,g.Z)((function(t){var r=t.peer,i=t.signal;return(0,s.Z)().mark((function t(){var a,u,c,l,f,h;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=!1,u=!1,t.prev=2,l=(0,y.Z)(o.peerRouting.getValueOrPeers(r,e,{signal:i}));case 4:return t.next=6,(0,m.Z)(l.next());case 6:if(!(a=!(f=t.sent).done)){t.next=16;break}return h=f.value,t.next=10,h;case 10:if("PEER_RESPONSE"!==h.name||null==h.record){t.next=13;break}return t.next=13,FL({from:r,value:h.record.value},n);case 13:a=!1,t.next=4;break;case 16:t.next=22;break;case 18:t.prev=18,t.t0=t.catch(2),u=!0,c=t.t0;case 22:if(t.prev=22,t.prev=23,!a||null==l.return){t.next=27;break}return t.next=27,(0,m.Z)(l.return());case 27:if(t.prev=27,!u){t.next=30;break}throw c;case 30:return t.finish(27);case 31:return t.finish(22);case 32:case"end":return t.stop()}}),t,null,[[2,18,22,32],[23,,27,31]])}))()}));return function(e){return t.apply(this,arguments)}}(),r.delegateYield((0,at.Z)((0,y.Z)(t.queryManager.run(e,a,n)),m.Z),"t1",15);case 15:case"end":return r.stop()}}),r,null,[[1,9]])})))()}}]),e}(),oN=function(){function e(t,n){(0,K.Z)(this,e),(0,ot.Z)(this,"log",void 0),(0,ot.Z)(this,"components",void 0),(0,ot.Z)(this,"network",void 0),(0,ot.Z)(this,"peerRouting",void 0),(0,ot.Z)(this,"queryManager",void 0),(0,ot.Z)(this,"routingTable",void 0),(0,ot.Z)(this,"providers",void 0);var r=n.network,i=n.peerRouting,o=n.queryManager,a=n.routingTable,s=n.providers,u=n.lan;this.components=t,this.log=(0,ru.kg)("libp2p:kad-dht:".concat(u?"lan":"wan",":content-routing")),this.network=r,this.peerRouting=i,this.queryManager=o,this.routingTable=a,this.providers=s}return(0,W.Z)(e,[{key:"provide",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,g.Z)((0,s.Z)().mark((function i(){var o,a,c;return(0,s.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return n.log("provide %s",e),i.next=3,(0,m.Z)(n.providers.addProvider(e,n.components.peerId));case 3:return(o=new DL(TL.ADD_PROVIDER,e.multihash.bytes,0)).providerPeers=[{id:n.components.peerId,multiaddrs:t,protocols:[]}],a=0,c=function(t){return(0,u.Z)((0,s.Z)().mark((function i(){var u,c,l,f,h,p,d;return(0,s.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if("FINAL_PEER"===t.name){i.next=2;break}return i.abrupt("return",[t]);case 2:u=[],n.log("putProvider %s to %p",e,t.peer.id),i.prev=4,n.log("sending provider record for %s to %p",e,t.peer.id),c=!1,l=!1,i.prev=8,h=(0,y.Z)(n.network.sendMessage(t.peer.id,o,r));case 10:return i.next=12,h.next();case 12:if(!(c=!(p=i.sent).done)){i.next=19;break}"PEER_RESPONSE"===(d=p.value).name&&(n.log("sent provider record for %s to %p",e,t.peer.id),a++),u.push(d);case 16:c=!1,i.next=10;break;case 19:i.next=25;break;case 21:i.prev=21,i.t0=i.catch(8),l=!0,f=i.t0;case 25:if(i.prev=25,i.prev=26,!c||null==h.return){i.next=30;break}return i.next=30,h.return();case 30:if(i.prev=30,!l){i.next=33;break}throw f;case 33:return i.finish(30);case 34:return i.finish(25);case 35:i.next=41;break;case 37:i.prev=37,i.t1=i.catch(4),n.log.error("error sending provide record to peer %p",t.peer.id,i.t1),u.push(BL({from:t.peer.id,error:i.t1},r));case 41:return i.abrupt("return",u);case 42:case"end":return i.stop()}}),i,null,[[4,37],[8,21,25,35],[26,,30,34]])})))},i.delegateYield((0,at.Z)((0,y.Z)(_P(n.peerRouting.getClosestPeers(e.multihash.bytes,r),(function(e){return wP(e,(function(e){return c(e)}))}),(function(e){return EP(e,{ordered:!1,concurrency:3})}),function(){var e=(0,g.Z)((0,s.Z)().mark((function e(t){var n,r,i,o,a,u;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!1,r=!1,e.prev=2,o=(0,y.Z)(t);case 4:return e.next=6,(0,m.Z)(o.next());case 6:if(!(n=!(a=e.sent).done)){e.next=12;break}return u=a.value,e.delegateYield((0,at.Z)((0,y.Z)(u),m.Z),"t0",9);case 9:n=!1,e.next=4;break;case 12:e.next=18;break;case 14:e.prev=14,e.t1=e.catch(2),r=!0,i=e.t1;case 18:if(e.prev=18,e.prev=19,!n||null==o.return){e.next=23;break}return e.next=23,(0,m.Z)(o.return());case 23:if(e.prev=23,!r){e.next=26;break}throw i;case 26:return e.finish(23);case 27:return e.finish(18);case 28:case"end":return e.stop()}}),e,null,[[2,14,18,28],[19,,23,27]])})));return function(t){return e.apply(this,arguments)}}())),m.Z),"t0",8);case 8:n.log("sent provider records to %d peers",a);case 9:case"end":return i.stop()}}),i)})))()}},{key:"findProviders",value:function(e,t){var n=this;return(0,g.Z)((0,s.Z)().mark((function r(){var i,o,a,u,c,l,f,h,p,d,v,b,w,k,E,x,_,S,A,Z,T;return(0,s.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.routingTable.kBucketSize,o=e.multihash.bytes,a=n,n.log("findProviders %c",e),r.next=6,(0,m.Z)(n.providers.getProviders(e));case 6:if(!((u=r.sent).length>0)){r.next=40;break}c=[],l=(0,Ae.Z)(u.slice(0,i)),r.prev=10,l.s();case 12:if((f=l.n()).done){r.next=28;break}return h=f.value,r.prev=14,r.next=17,(0,m.Z)(n.components.peerStore.get(h));case 17:p=r.sent,c.push({id:h,multiaddrs:p.addresses.map((function(e){return e.multiaddr})),protocols:p.protocols}),r.next=26;break;case 21:if(r.prev=21,r.t0=r.catch(14),"ERR_NOT_FOUND"===r.t0.code){r.next=25;break}throw r.t0;case 25:n.log("no peer store entry for %p",h);case 26:r.next=12;break;case 28:r.next=33;break;case 30:r.prev=30,r.t1=r.catch(10),l.e(r.t1);case 33:return r.prev=33,l.f(),r.finish(33);case 36:return r.next=38,LL({from:n.components.peerId,messageType:TL.GET_PROVIDERS,providers:c},t);case 38:return r.next=40,ML({from:n.components.peerId,providers:c},t);case 40:if(!(u.length>=i)){r.next=42;break}return r.abrupt("return");case 42:d=function(){var e=(0,g.Z)((function(e){var n=e.peer,r=e.signal;return(0,s.Z)().mark((function e(){var i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new DL(TL.GET_PROVIDERS,o,0),e.delegateYield((0,at.Z)((0,y.Z)(a.network.sendRequest(n,i,(0,Nt.Z)((0,Nt.Z)({},t),{},{signal:r}))),m.Z),"t0",2);case 2:case"end":return e.stop()}}),e)}))()}));return function(t){return e.apply(this,arguments)}}(),v=new Set(u.map((function(e){return e.toString()}))),b=!1,w=!1,r.prev=46,E=(0,y.Z)(n.queryManager.run(o,d,t));case 48:return r.next=50,(0,m.Z)(E.next());case 50:if(!(b=!(x=r.sent).done)){r.next=84;break}return _=x.value,r.next=54,_;case 54:if("PEER_RESPONSE"!==_.name){r.next=81;break}n.log("Found %d provider entries for %c and %d closer peers",_.providers.length,e,_.closer.length),S=[],A=(0,Ae.Z)(_.providers),r.prev=58,A.s();case 60:if((Z=A.n()).done){r.next=68;break}if(T=Z.value,!v.has(T.id.toString())){r.next=64;break}return r.abrupt("continue",66);case 64:v.add(T.id.toString()),S.push(T);case 66:r.next=60;break;case 68:r.next=73;break;case 70:r.prev=70,r.t2=r.catch(58),A.e(r.t2);case 73:return r.prev=73,A.f(),r.finish(73);case 76:if(!(S.length>0)){r.next=79;break}return r.next=79,ML({from:_.from,providers:S},t);case 79:if(v.size!==i){r.next=81;break}return r.abrupt("return");case 81:b=!1,r.next=48;break;case 84:r.next=90;break;case 86:r.prev=86,r.t3=r.catch(46),w=!0,k=r.t3;case 90:if(r.prev=90,r.prev=91,!b||null==E.return){r.next=95;break}return r.next=95,(0,m.Z)(E.return());case 95:if(r.prev=95,!w){r.next=98;break}throw k;case 98:return r.finish(95);case 99:return r.finish(90);case 100:case"end":return r.stop()}}),r,null,[[10,30,33,36],[14,21],[46,86,90,100],[58,70,73,76],[91,,95,99]])})))()}}]),e}();var aN=function(e){if(null!=e[Symbol.asyncIterator])return(0,u.Z)((0,s.Z)().mark((function t(){var n,r,i,o,a,u;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=!1,r=!1,t.prev=2,o=(0,y.Z)(e);case 4:return t.next=6,o.next();case 6:if(!(n=!(a=t.sent).done)){t.next=12;break}return u=a.value,t.abrupt("return",u);case 9:n=!1,t.next=4;break;case 12:t.next=18;break;case 14:t.prev=14,t.t0=t.catch(2),r=!0,i=t.t0;case 18:if(t.prev=18,t.prev=19,!n||null==o.return){t.next=23;break}return t.next=23,o.return();case 23:if(t.prev=23,!r){t.next=26;break}throw i;case 26:return t.finish(23);case 27:return t.finish(18);case 28:return t.abrupt("return",void 0);case 29:case"end":return t.stop()}}),t,null,[[2,14,18,28],[19,,23,27]])})))();var t,n=(0,Ae.Z)(e);try{for(n.s();!(t=n.n()).done;){return t.value}}catch(r){n.e(r)}finally{n.f()}};function sN(e){return null!=e[Symbol.asyncIterator]}var uN=function e(t){var n=Ct.encodingLength(t),r=OP(n);return Ct.encode(t,r),e.bytes=n,r};function cN(e,t){var n,r,i=(0,s.Z)().mark(a),o=null!==(r=(t=null!==(n=t)&&void 0!==n?n:{}).lengthEncoder)&&void 0!==r?r:uN;function a(e){var t;return(0,s.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!((t=o(e.byteLength))instanceof Uint8Array)){n.next=6;break}return n.next=4,t;case 4:n.next=7;break;case 6:return n.delegateYield(t,"t0",7);case 7:if(!(e instanceof Uint8Array)){n.next=12;break}return n.next=10,e;case 10:n.next=13;break;case 12:return n.delegateYield(e,"t1",13);case 13:case"end":return n.stop()}}),i)}return sN(e)?(0,g.Z)((0,s.Z)().mark((function t(){var n,r,i,o,u,c;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=!1,r=!1,t.prev=2,o=(0,y.Z)(e);case 4:return t.next=6,(0,m.Z)(o.next());case 6:if(!(n=!(u=t.sent).done)){t.next=12;break}return c=u.value,t.delegateYield((0,at.Z)((0,y.Z)(a(c)),m.Z),"t0",9);case 9:n=!1,t.next=4;break;case 12:t.next=18;break;case 14:t.prev=14,t.t1=t.catch(2),r=!0,i=t.t1;case 18:if(t.prev=18,t.prev=19,!n||null==o.return){t.next=23;break}return t.next=23,(0,m.Z)(o.return());case 23:if(t.prev=23,!r){t.next=26;break}throw i;case 26:return t.finish(23);case 27:return t.finish(18);case 28:case"end":return t.stop()}}),t,null,[[2,14,18,28],[19,,23,27]])})))():(0,s.Z)().mark((function t(){var n,r,i;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=(0,Ae.Z)(e),t.prev=1,n.s();case 3:if((r=n.n()).done){t.next=8;break}return i=r.value,t.delegateYield(a(i),"t0",6);case 6:t.next=3;break;case 8:t.next=13;break;case 10:t.prev=10,t.t1=t.catch(1),n.e(t.t1);case 13:return t.prev=13,n.f(),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,10,13,16]])}))()}uN.bytes=0,cN.single=function(e,t){var n,r,i=null!==(r=(t=null!==(n=t)&&void 0!==n?n:{}).lengthEncoder)&&void 0!==r?r:uN;return new vt(i(e.byteLength),e)};var lN;!function(e){e[e.LENGTH=0]="LENGTH",e[e.DATA=1]="DATA"}(lN||(lN={}));var fN=function e(t){var n=Ct.decode(t);return e.bytes=Ct.encodingLength(n),n};function hN(e,t){var n,r,i,o=(0,s.Z)().mark(p),a=new vt,u=lN.LENGTH,c=-1,l=null!==(n=null===t||void 0===t?void 0:t.lengthDecoder)&&void 0!==n?n:fN,f=null!==(r=null===t||void 0===t?void 0:t.maxLengthLength)&&void 0!==r?r:8,h=null!==(i=null===t||void 0===t?void 0:t.maxDataLength)&&void 0!==i?i:4194304;function p(){var e,n;return(0,s.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(a.byteLength>0)){r.next=32;break}if(u!==lN.LENGTH){r.next=21;break}if(r.prev=2,!((c=l(a))<0)){r.next=6;break}throw Mt()(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");case 6:if(!(c>h)){r.next=8;break}throw Mt()(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");case 8:e=l.bytes,a.consume(e),null!=(null===t||void 0===t?void 0:t.onLength)&&t.onLength(c),u=lN.DATA,r.next=21;break;case 14:if(r.prev=14,r.t0=r.catch(2),!(r.t0 instanceof RangeError)){r.next=20;break}if(!(a.byteLength>f)){r.next=19;break}throw Mt()(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");case 19:return r.abrupt("break",32);case 20:throw r.t0;case 21:if(u!==lN.DATA){r.next=30;break}if(!(a.byteLength<c)){r.next=24;break}return r.abrupt("break",32);case 24:return n=a.sublist(0,c),a.consume(c),null!=(null===t||void 0===t?void 0:t.onData)&&t.onData(n),r.next=29,n;case 29:u=lN.LENGTH;case 30:r.next=0;break;case 32:case"end":return r.stop()}}),o,null,[[2,14]])}return sN(e)?(0,g.Z)((0,s.Z)().mark((function t(){var n,r,i,o,u,c;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=!1,r=!1,t.prev=2,o=(0,y.Z)(e);case 4:return t.next=6,(0,m.Z)(o.next());case 6:if(!(n=!(u=t.sent).done)){t.next=13;break}return c=u.value,a.append(c),t.delegateYield((0,at.Z)((0,y.Z)(p()),m.Z),"t0",10);case 10:n=!1,t.next=4;break;case 13:t.next=19;break;case 15:t.prev=15,t.t1=t.catch(2),r=!0,i=t.t1;case 19:if(t.prev=19,t.prev=20,!n||null==o.return){t.next=24;break}return t.next=24,(0,m.Z)(o.return());case 24:if(t.prev=24,!r){t.next=27;break}throw i;case 27:return t.finish(24);case 28:return t.finish(19);case 29:if(!(a.byteLength>0)){t.next=31;break}throw Mt()(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF");case 31:case"end":return t.stop()}}),t,null,[[2,15,19,29],[20,,24,28]])})))():(0,s.Z)().mark((function t(){var n,r,i;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=(0,Ae.Z)(e),t.prev=1,n.s();case 3:if((r=n.n()).done){t.next=9;break}return i=r.value,a.append(i),t.delegateYield(p(),"t0",7);case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t1=t.catch(1),n.e(t.t1);case 14:return t.prev=14,n.f(),t.finish(14);case 17:if(!(a.byteLength>0)){t.next=19;break}throw Mt()(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF");case 19:case"end":return t.stop()}}),t,null,[[1,11,14,17]])}))()}fN.bytes=0,hN.fromReader=function(e,t){var n=1;return hN((0,g.Z)((0,s.Z)().mark((function t(){var r,i,o;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=1,t.next=4,(0,m.Z)(e.next(n));case 4:if(r=t.sent,i=r.done,o=r.value,!0!==i){t.next=9;break}return t.abrupt("return");case 9:if(null==o){t.next=12;break}return t.next=12,o;case 12:t.next=19;break;case 14:if(t.prev=14,t.t0=t.catch(1),"ERR_UNDER_READ"!==t.t0.code){t.next=18;break}return t.abrupt("return",{done:!0,value:null});case 18:throw t.t0;case 19:return t.prev=19,n=1,t.finish(19);case 22:t.next=0;break;case 24:case"end":return t.stop()}}),t,null,[[1,14,19,22]])})))(),(0,Nt.Z)((0,Nt.Z)({},null!==t&&void 0!==t?t:{}),{},{onLength:function(e){n=e}}))};var pN=function(e){(0,X.Z)(n,e);var t=(0,$.Z)(n);function n(e,r){var i;(0,K.Z)(this,n),i=t.call(this),(0,ot.Z)((0,nr.Z)(i),"log",void 0),(0,ot.Z)((0,nr.Z)(i),"protocol",void 0),(0,ot.Z)((0,nr.Z)(i),"running",void 0),(0,ot.Z)((0,nr.Z)(i),"components",void 0);var o=r.protocol,a=r.lan;return i.components=e,i.log=(0,ru.kg)("libp2p:kad-dht:".concat(a?"lan":"wan",":network")),i.running=!1,i.protocol=o,i}return(0,W.Z)(n,[{key:"start",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.running){e.next=2;break}return e.abrupt("return");case 2:this.running=!0;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.running=!1;case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isStarted",value:function(){return this.running}},{key:"sendRequest",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,g.Z)((0,s.Z)().mark((function i(){var o,a,u;return(0,s.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(n.running){i.next=2;break}return i.abrupt("return");case 2:return n.log("sending %s to %p",t.type,e),i.next=5,jL({peer:e},r);case 5:return i.next=7,PL({to:e,type:t.type},r);case 7:return i.prev=7,i.next=10,(0,m.Z)(n.components.connectionManager.openConnection(e,r));case 10:return o=i.sent,i.next=13,(0,m.Z)(o.newStream(n.protocol,r));case 13:return a=i.sent,i.next=16,(0,m.Z)(n._writeReadMessage(a,t.serialize(),r));case 16:return u=i.sent,i.next=19,LL({from:e,messageType:u.type,closer:u.closerPeers,providers:u.providerPeers,record:u.record},r);case 19:i.next=25;break;case 21:return i.prev=21,i.t0=i.catch(7),i.next=25,BL({from:e,error:i.t0},r);case 25:return i.prev=25,i.finish(25);case 28:case"end":return i.stop()}}),i,null,[[7,21,25,28]])})))()}},{key:"sendMessage",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,g.Z)((0,s.Z)().mark((function i(){var o,a;return(0,s.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(n.running){i.next=2;break}return i.abrupt("return");case 2:return n.log("sending %s to %p",t.type,e),i.next=5,jL({peer:e},r);case 5:return i.next=7,PL({to:e,type:t.type},r);case 7:return i.prev=7,i.next=10,(0,m.Z)(n.components.connectionManager.openConnection(e,r));case 10:return o=i.sent,i.next=13,(0,m.Z)(o.newStream(n.protocol,r));case 13:return a=i.sent,i.next=16,(0,m.Z)(n._writeMessage(a,t.serialize(),r));case 16:return i.next=18,LL({from:e,messageType:t.type},r);case 18:i.next=24;break;case 20:return i.prev=20,i.t0=i.catch(7),i.next=24,BL({from:e,error:i.t0},r);case 24:return i.prev=24,i.finish(24);case 27:case"end":return i.stop()}}),i,null,[[7,20,24,27]])})))()}},{key:"_writeMessage",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,n,r){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null!=r.signal&&(t=yu(t,r.signal)),e.next=3,_P([n],(function(e){return cN(e)}),t,zR);case 3:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_writeReadMessage",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,n,r){var i,o,a=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null!=r.signal&&(t=yu(t,r.signal)),e.next=3,_P([n],(function(e){return cN(e)}),t,(function(e){return hN(e)}),function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,aN(t);case 2:if(null==(n=e.sent)){e.next=5;break}return e.abrupt("return",n);case 5:throw new ar.s("No message received","ERR_NO_MESSAGE_RECEIVED");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:return i=e.sent,(o=DL.deserialize(i)).closerPeers.forEach((function(e){a.dispatchEvent(new Dh("peer",{detail:e}))})),o.providerPeers.forEach((function(e){a.dispatchEvent(new Dh("peer",{detail:e}))})),e.abrupt("return",o);case 8:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),n}(Ch);function dN(e,t){for(var n=0;n<e.byteLength;n++){if(e[n]<t[n])return-1;if(e[n]>t[n])return 1}return e.byteLength>t.byteLength?1:e.byteLength<t.byteLength?-1:0}function vN(e,t){if(e.length!==t.length)throw new Error("Inputs should have the same length");for(var n=OP(e.length),r=0;r<e.length;r++)n[r]=e[r]^t[r];return DP(n)}var yN=function(){function e(t,n){(0,K.Z)(this,e),(0,ot.Z)(this,"originDhtKey",void 0),(0,ot.Z)(this,"capacity",void 0),(0,ot.Z)(this,"peerDistances",void 0),this.originDhtKey=t,this.capacity=n,this.peerDistances=[]}return(0,W.Z)(e,[{key:"length",get:function(){return this.peerDistances.length}},{key:"peers",get:function(){return this.peerDistances.map((function(e){return e.peerId}))}},{key:"add",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.peerDistances.find((function(e){return e.peerId.equals(t)}))){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,XL(t);case 4:n=e.sent,r={peerId:t,distance:vN(this.originDhtKey,n)},this.peerDistances.push(r),this.peerDistances.sort((function(e,t){return dN(e.distance,t.distance)})),this.peerDistances=this.peerDistances.slice(0,this.capacity);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"anyCloser",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r,i,o,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return",!1);case 2:if(0!==this.length){e.next=4;break}return e.abrupt("return",!0);case 4:return e.next=6,Promise.all(t.map(XL));case 6:n=e.sent,r=this.peerDistances[this.peerDistances.length-1].distance,i=(0,Ae.Z)(n),e.prev=9,i.s();case 11:if((o=i.n()).done){e.next=18;break}if(a=o.value,!(dN(vN(this.originDhtKey,a),r)<0)){e.next=16;break}return e.abrupt("return",!0);case 16:e.next=11;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(9),i.e(e.t0);case 23:return e.prev=23,i.f(),e.finish(23);case 26:return e.abrupt("return",!1);case 27:case"end":return e.stop()}}),e,this,[[9,20,23,26]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),gN=function(){function e(t,n){(0,K.Z)(this,e),(0,ot.Z)(this,"components",void 0),(0,ot.Z)(this,"log",void 0),(0,ot.Z)(this,"routingTable",void 0),(0,ot.Z)(this,"network",void 0),(0,ot.Z)(this,"validators",void 0),(0,ot.Z)(this,"queryManager",void 0);var r=n.routingTable,i=n.network,o=n.validators,a=n.queryManager,s=n.lan;this.components=t,this.routingTable=r,this.network=i,this.validators=o,this.queryManager=a,this.log=(0,ru.kg)("libp2p:kad-dht:".concat(s?"lan":"wan",":peer-routing"))}return(0,W.Z)(e,[{key:"findPeerLocal",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.routingTable.find(t);case 2:if(null==(r=e.sent)){e.next=15;break}return this.log("findPeerLocal found %p in routing table",t),e.prev=5,e.next=8,this.components.peerStore.get(r);case 8:n=e.sent,e.next=15;break;case 11:if(e.prev=11,e.t0=e.catch(5),"ERR_NOT_FOUND"===e.t0.code){e.next=15;break}throw e.t0;case 15:if(null!=n){e.next=26;break}return e.prev=16,e.next=19,this.components.peerStore.get(t);case 19:n=e.sent,e.next=26;break;case 22:if(e.prev=22,e.t1=e.catch(16),"ERR_NOT_FOUND"===e.t1.code){e.next=26;break}throw e.t1;case 26:if(null==n){e.next=29;break}return this.log("findPeerLocal found %p in peer store",t),e.abrupt("return",{id:n.id,multiaddrs:n.addresses.map((function(e){return e.multiaddr})),protocols:[]});case 29:return e.abrupt("return",void 0);case 30:case"end":return e.stop()}}),e,this,[[5,11],[16,22]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_getValueSingle",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,g.Z)((0,s.Z)().mark((function i(){var o;return(0,s.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return o=new DL(TL.GET_VALUE,t,0),i.delegateYield((0,at.Z)((0,y.Z)(n.network.sendRequest(e,o,r)),m.Z),"t0",2);case 2:case"end":return i.stop()}}),i)})))()}},{key:"getPublicKeyFromNode",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,g.Z)((0,s.Z)().mark((function r(){var i,o,a,u,c,l,f,h;return(0,s.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:i=eN(e),o=!1,a=!1,r.prev=3,c=(0,y.Z)(t._getValueSingle(e,i,n));case 5:return r.next=7,(0,m.Z)(c.next());case 7:if(!(o=!(l=r.sent).done)){r.next=24;break}return f=l.value,r.next=11,f;case 11:if("PEER_RESPONSE"!==f.name||null==f.record){r.next=21;break}return r.next=14,(0,m.Z)((0,Ps.y5)(Ts({bytes:f.record.value})));case 14:if((h=r.sent).equals(e)){r.next=17;break}throw new ar.s("public key does not match id","ERR_PUBLIC_KEY_DOES_NOT_MATCH_ID");case 17:if(null!=h.publicKey){r.next=19;break}throw new ar.s("public key missing","ERR_PUBLIC_KEY_MISSING");case 19:return r.next=21,FL({from:e,value:h.publicKey},n);case 21:o=!1,r.next=5;break;case 24:r.next=30;break;case 26:r.prev=26,r.t0=r.catch(3),a=!0,u=r.t0;case 30:if(r.prev=30,r.prev=31,!o||null==c.return){r.next=35;break}return r.next=35,(0,m.Z)(c.return());case 35:if(r.prev=35,!a){r.next=38;break}throw u;case 38:return r.finish(35);case 39:return r.finish(30);case 40:throw new ar.s("Node not responding with its public key: ".concat(e.toString()),"ERR_INVALID_RECORD");case 41:case"end":return r.stop()}}),r,null,[[3,26,30,40],[31,,35,39]])})))()}},{key:"findPeer",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,g.Z)((0,s.Z)().mark((function r(){var i,o,a,u,c,l,f,h,p,d;return(0,s.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t.log("findPeer %p",e),r.next=3,(0,m.Z)(t.findPeerLocal(e));case 3:if(null==(i=r.sent)){r.next=9;break}return t.log("found local"),r.next=8,NL({from:t.components.peerId,peer:i},n);case 8:return r.abrupt("return");case 9:o=t,a=function(){var t=(0,g.Z)((function(t){var r=t.peer,i=t.signal;return(0,s.Z)().mark((function t(){var a,u,c,l,f,h,p,d;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=new DL(TL.FIND_NODE,e.toBytes(),0),u=!1,c=!1,t.prev=3,f=(0,y.Z)(o.network.sendRequest(r,a,(0,Nt.Z)((0,Nt.Z)({},n),{},{signal:i})));case 5:return t.next=7,(0,m.Z)(f.next());case 7:if(!(u=!(h=t.sent).done)){t.next=19;break}return p=h.value,t.next=11,p;case 11:if("PEER_RESPONSE"!==p.name){t.next=16;break}if(null==(d=p.closer.find((function(t){return t.id.equals(e)})))){t.next=16;break}return t.next=16,NL({from:p.from,peer:d},n);case 16:u=!1,t.next=5;break;case 19:t.next=25;break;case 21:t.prev=21,t.t0=t.catch(3),c=!0,l=t.t0;case 25:if(t.prev=25,t.prev=26,!u||null==f.return){t.next=30;break}return t.next=30,(0,m.Z)(f.return());case 30:if(t.prev=30,!c){t.next=33;break}throw l;case 33:return t.finish(30);case 34:return t.finish(25);case 35:case"end":return t.stop()}}),t,null,[[3,21,25,35],[26,,30,34]])}))()}));return function(e){return t.apply(this,arguments)}}(),u=!1,c=!1,l=!1,r.prev=14,h=(0,y.Z)(t.queryManager.run(e.toBytes(),a,n));case 16:return r.next=18,(0,m.Z)(h.next());case 18:if(!(c=!(p=r.sent).done)){r.next=26;break}return"FINAL_PEER"===(d=p.value).name&&(u=!0),r.next=23,d;case 23:c=!1,r.next=16;break;case 26:r.next=32;break;case 28:r.prev=28,r.t0=r.catch(14),l=!0,f=r.t0;case 32:if(r.prev=32,r.prev=33,!c||null==h.return){r.next=37;break}return r.next=37,(0,m.Z)(h.return());case 37:if(r.prev=37,!l){r.next=40;break}throw f;case 40:return r.finish(37);case 41:return r.finish(32);case 42:if(u){r.next=45;break}return r.next=45,BL({from:t.components.peerId,error:new ar.s("Not found","ERR_NOT_FOUND")},n);case 45:case"end":return r.stop()}}),r,null,[[14,28,32,42],[33,,37,41]])})))()}},{key:"getClosestPeers",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,g.Z)((0,s.Z)().mark((function r(){var i,o,a,c,l,f,h,p,d,v,b,w,k,E,x;return(0,s.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t.log("getClosestPeers to %b",e),r.next=3,(0,m.Z)(YL(e));case 3:return i=r.sent,o=t.routingTable.closestPeers(i),a=t,c=new yN(i,t.routingTable.kBucketSize),r.next=9,(0,m.Z)(Promise.all(o.map(function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.add(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())));case 9:l=function(){var t=(0,g.Z)((function(t){var r=t.peer,i=t.signal;return(0,s.Z)().mark((function t(){var o;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.log("closerPeersSingle %s from %p",BP(e,"base32"),r),o=new DL(TL.FIND_NODE,e,0),t.delegateYield((0,at.Z)((0,y.Z)(a.network.sendRequest(r,o,(0,Nt.Z)((0,Nt.Z)({},n),{},{signal:i}))),m.Z),"t0",3);case 3:case"end":return t.stop()}}),t)}))()}));return function(e){return t.apply(this,arguments)}}(),f=!1,h=!1,r.prev=12,d=(0,y.Z)(t.queryManager.run(e,l,n));case 14:return r.next=16,(0,m.Z)(d.next());case 16:if(!(f=!(v=r.sent).done)){r.next=26;break}return b=v.value,r.next=20,b;case 20:if("PEER_RESPONSE"!==b.name){r.next=23;break}return r.next=23,(0,m.Z)(Promise.all(b.closer.map(function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.add(t.id);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())));case 23:f=!1,r.next=14;break;case 26:r.next=32;break;case 28:r.prev=28,r.t0=r.catch(12),h=!0,p=r.t0;case 32:if(r.prev=32,r.prev=33,!f||null==d.return){r.next=37;break}return r.next=37,(0,m.Z)(d.return());case 37:if(r.prev=37,!h){r.next=40;break}throw p;case 40:return r.finish(37);case 41:return r.finish(32);case 42:t.log("found %d peers close to %b",c.length,e),w=(0,Ae.Z)(c.peers),r.prev=44,w.s();case 46:if((k=w.n()).done){r.next=62;break}return E=k.value,r.prev=48,r.next=51,(0,m.Z)(t.components.peerStore.get(E));case 51:return x=r.sent,r.next=54,NL({from:t.components.peerId,peer:{id:E,multiaddrs:x.addresses.map((function(e){return e.multiaddr})),protocols:x.protocols}},n);case 54:r.next=60;break;case 56:if(r.prev=56,r.t1=r.catch(48),"ERR_NOT_FOUND"===r.t1.code){r.next=60;break}throw r.t1;case 60:r.next=46;break;case 62:r.next=67;break;case 64:r.prev=64,r.t2=r.catch(44),w.e(r.t2);case 67:return r.prev=67,w.f(),r.finish(67);case 70:case"end":return r.stop()}}),r,null,[[12,28,32,42],[33,,37,41],[44,64,67,70],[48,56]])})))()}},{key:"getValueOrPeers",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,g.Z)((0,s.Z)().mark((function i(){var o,a,u,c,l,f,h;return(0,s.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:o=!1,a=!1,i.prev=2,c=(0,y.Z)(n._getValueSingle(e,t,r));case 4:return i.next=6,(0,m.Z)(c.next());case 6:if(!(o=!(l=i.sent).done)){i.next=27;break}if("PEER_RESPONSE"!==(f=l.value).name){i.next=22;break}if(null==f.record){i.next=22;break}return i.prev=10,i.next=13,(0,m.Z)(n._verifyRecordOnline(f.record));case 13:i.next=22;break;case 15:return i.prev=15,i.t0=i.catch(10),h="invalid record received, discarded",n.log(h),i.next=21,BL({from:f.from,error:new ar.s(h,"ERR_INVALID_RECORD")},r);case 21:return i.abrupt("continue",24);case 22:return i.next=24,f;case 24:o=!1,i.next=4;break;case 27:i.next=33;break;case 29:i.prev=29,i.t1=i.catch(2),a=!0,u=i.t1;case 33:if(i.prev=33,i.prev=34,!o||null==c.return){i.next=38;break}return i.next=38,(0,m.Z)(c.return());case 38:if(i.prev=38,!a){i.next=41;break}throw u;case 41:return i.finish(38);case 42:return i.finish(33);case 43:case"end":return i.stop()}}),i,null,[[2,29,33,43],[10,15],[34,,38,42]])})))()}},{key:"_verifyRecordOnline",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t.timeReceived){e.next=2;break}throw new ar.s("invalid record received","ERR_INVALID_RECORD");case 2:return e.next=4,rP(this.validators,new gP(t.key,t.value,t.timeReceived));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getCloserPeersOffline",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,n){var r,i,o,a,u,c,l;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,YL(t);case 2:r=e.sent,i=this.routingTable.closestPeers(r),o=[],a=(0,Ae.Z)(i),e.prev=6,a.s();case 8:if((u=a.n()).done){e.next=25;break}if(!(c=u.value).equals(n)){e.next=12;break}return e.abrupt("continue",23);case 12:return e.prev=12,e.next=15,this.components.peerStore.get(c);case 15:l=e.sent,o.push({id:c,multiaddrs:l.addresses.map((function(e){return e.multiaddr})),protocols:l.protocols}),e.next=23;break;case 19:if(e.prev=19,e.t0=e.catch(12),"ERR_NOT_FOUND"===e.t0.code){e.next=23;break}throw e.t0;case 23:e.next=8;break;case 25:e.next=30;break;case 27:e.prev=27,e.t1=e.catch(6),a.e(e.t1);case 30:return e.prev=30,a.f(),e.finish(30);case 33:return o.length>0?this.log("getCloserPeersOffline found %d peer(s) closer to %b than %p",o.length,t,n):this.log("getCloserPeersOffline could not find peer closer to %b than %p",t,n),e.abrupt("return",o);case 35:case"end":return e.stop()}}),e,this,[[6,27,30,33],[12,19]])})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),mN=n(34737),bN=n.n(mN),wN=(0,ru.kg)("libp2p:kad-dht:providers"),kN=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,K.Z)(this,e),(0,ot.Z)(this,"components",void 0),(0,ot.Z)(this,"cache",void 0),(0,ot.Z)(this,"cleanupInterval",void 0),(0,ot.Z)(this,"provideValidity",void 0),(0,ot.Z)(this,"syncQueue",void 0),(0,ot.Z)(this,"started",void 0),(0,ot.Z)(this,"cleaner",void 0);var r=n.cacheSize,i=n.cleanupInterval,o=n.provideValidity;this.components=t,this.cleanupInterval=null!==i&&void 0!==i?i:36e5,this.provideValidity=null!==o&&void 0!==o?o:864e5,this.cache=bN()(null!==r&&void 0!==r?r:256),this.syncQueue=new uc.Z({concurrency:1}),this.started=!1}return(0,W.Z)(e,[{key:"isStarted",value:function(){return this.started}},{key:"start",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.started){e.next=2;break}return e.abrupt("return");case 2:this.started=!0,this.cleaner=setInterval((function(){t._cleanup().catch((function(e){wN.error(e)}))}),this.cleanupInterval);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.started=!1,null!=this.cleaner&&(clearInterval(this.cleaner),this.cleaner=void 0);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_cleanup",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.syncQueue.add((0,u.Z)((0,s.Z)().mark((function e(){var n,r,i,o,a,u,c,l,f,h,p,d,v,g,m,b,w,E,x,_,S,A,Z,T,C,I,D,O,R,P,L;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Date.now(),r=0,i=0,o=new Map,a=t.components.datastore.batch(),u=t.components.datastore.query({prefix:cP}),c=!1,l=!1,e.prev=8,h=(0,y.Z)(u);case 10:return e.next=12,h.next();case 12:if(!(c=!(p=e.sent).done)){e.next=18;break}d=p.value;try{v=SN(d.key),g=v.cid,m=v.peerId,b=TN(d.value).getTime(),w=Date.now(),x=(E=w-b)>t.provideValidity,wN("comparing: %d - %d = %d > %d %s",w,b,E,t.provideValidity,x?"(expired)":""),x&&(i++,a.delete(d.key),(S=null!==(_=o.get(g))&&void 0!==_?_:new Set).add(m),o.set(g,S)),r++}catch(s){wN.error(s.message)}case 15:c=!1,e.next=10;break;case 18:e.next=24;break;case 20:e.prev=20,e.t0=e.catch(8),l=!0,f=e.t0;case 24:if(e.prev=24,e.prev=25,!c||null==h.return){e.next=29;break}return e.next=29,h.return();case 29:if(e.prev=29,!l){e.next=32;break}throw f;case 32:return e.finish(29);case 33:return e.finish(24);case 34:if(!(o.size>0)){e.next=40;break}return wN("deleting %d / %d entries",i,r),e.next=38,a.commit();case 38:e.next=41;break;case 40:wN("nothing to delete");case 41:A=(0,Ae.Z)(o);try{for(A.s();!(Z=A.n()).done;)if(T=(0,k.Z)(Z.value,2),C=T[0],I=T[1],D=EN(C),null!=(O=t.cache.get(D))){R=(0,Ae.Z)(I);try{for(R.s();!(P=R.n()).done;)L=P.value,O.delete(L)}catch(s){R.e(s)}finally{R.f()}0===O.size?t.cache.remove(D):t.cache.set(D,O)}}catch(s){A.e(s)}finally{A.f()}wN("Cleanup successful (%dms)",Date.now()-n);case 44:case"end":return e.stop()}}),e,null,[[8,20,24,34],[25,,29,33]])}))));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getProvidersMap",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=EN(t),null!=(r=this.cache.get(n))){e.next=7;break}return e.next=5,AN(this.components.datastore,t);case 5:r=e.sent,this.cache.set(n,r);case 7:return e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"addProvider",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,n){var r=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.syncQueue.add((0,u.Z)((0,s.Z)().mark((function e(){var i,o,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return wN("%p provides %s",n,t),e.next=3,r._getProvidersMap(t);case 3:return i=e.sent,wN("loaded %s provs",i.size),o=new Date,i.set(n.toString(),o),a=EN(t),r.cache.set(a,i),e.next=11,xN(r.components.datastore,t,n,o);case 11:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getProviders",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.syncQueue.add((0,u.Z)((0,s.Z)().mark((function e(){var r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return wN("get providers for %s",t),e.next=3,n._getProvidersMap(t);case 3:return r=e.sent,e.abrupt("return",(0,ye.Z)(r.keys()).map((function(e){return(0,Ps.jE)(e)})));case 5:case"end":return e.stop()}}),e)}))),{throwOnTimeout:!0}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function EN(e){var t="string"===typeof e?e:BP(e.multihash.bytes,"base32");return"".concat(cP,"/").concat(t)}function xN(e,t,n,r){return _N.apply(this,arguments)}function _N(){return(_N=(0,u.Z)((0,s.Z)().mark((function e(t,n,r,i){var o,a,u;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=[EN(n),"/",r.toString()].join(""),a=new GL(o),u=Uint8Array.from(A().encode(i.getTime())),e.next=5,t.put(a,u);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function SN(e){var t=e.toString().split("/");if(5!==t.length)throw new Error("incorrectly formatted provider entry key in datastore: ".concat(e.toString()));return{cid:t[3],peerId:t[4]}}function AN(e,t){return ZN.apply(this,arguments)}function ZN(){return(ZN=(0,u.Z)((0,s.Z)().mark((function e(t,n){var r,i,o,a,u,c,l,f,h,p;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=new Map,i=t.query({prefix:EN(n)}),o=!1,a=!1,e.prev=4,c=(0,y.Z)(i);case 6:return e.next=8,c.next();case 8:if(!(o=!(l=e.sent).done)){e.next=15;break}f=l.value,h=SN(f.key),p=h.peerId,r.set(p,TN(f.value));case 12:o=!1,e.next=6;break;case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(4),a=!0,u=e.t0;case 21:if(e.prev=21,e.prev=22,!o||null==c.return){e.next=26;break}return e.next=26,c.return();case 26:if(e.prev=26,!a){e.next=29;break}throw u;case 29:return e.finish(26);case 30:return e.finish(21);case 31:return e.abrupt("return",r);case 32:case"end":return e.stop()}}),e,null,[[4,17,21,31],[22,,26,30]])})))).apply(this,arguments)}function TN(e){return new Date(A().decode(e))}function CN(e){var t=new globalThis.AbortController;function n(){t.abort();var r,i=(0,Ae.Z)(e);try{for(i.s();!(r=i.n()).done;){var o=r.value;null!=(null===o||void 0===o?void 0:o.removeEventListener)&&o.removeEventListener("abort",n)}}catch(a){i.e(a)}finally{i.f()}}var r,i=(0,Ae.Z)(e);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(!0===(null===o||void 0===o?void 0:o.aborted)){n();break}null!=(null===o||void 0===o?void 0:o.addEventListener)&&o.addEventListener("abort",n)}}catch(s){i.e(s)}finally{i.f()}var a=t.signal;return a.clear=function(){var t,r=(0,Ae.Z)(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;null!=(null===i||void 0===i?void 0:i.removeEventListener)&&i.removeEventListener("abort",n)}}catch(s){r.e(s)}finally{r.f()}},a}var IN=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF");function DN(e){return ON.apply(this,arguments)}function ON(){return ON=(0,g.Z)((0,s.Z)().mark((function e(t){var n,r,i,o,a,c,l,f,h,p,d,v,g,b,w;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w=function(e,r){if(null!=e){v.add(e);var c=BigInt("0x"+BP(vN(r,b),"base16"));g.add((0,u.Z)((0,s.Z)().mark((function r(){var u,h,m,k,E,x,_,S,A,Z,T,C;return(0,s.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:u=[o],null!=p&&u.push(AbortSignal.timeout(p)),h=CN(u),r.prev=3,m=!1,k=!1,r.prev=6,x=(0,y.Z)(a({key:n,peer:e,signal:h,pathIndex:l,numPaths:f}));case 8:return r.next=10,x.next();case 10:if(!(m=!(_=r.sent).done)){r.next=49;break}if(S=_.value,!h.aborted){r.next=14;break}return r.abrupt("return");case 14:if("PEER_RESPONSE"!==S.name){r.next=45;break}A=(0,Ae.Z)(S.closer),r.prev=16,A.s();case 18:if((Z=A.n()).done){r.next=37;break}if(T=Z.value,!v.has(T.id)){r.next=23;break}return d("already seen %p in query",T.id),r.abrupt("continue",35);case 23:if(!i.equals(T.id)){r.next=26;break}return d("not querying ourselves"),r.abrupt("continue",35);case 26:return r.next=28,XL(T.id);case 28:if(C=r.sent,!(BigInt("0x"+BP(vN(C,b),"base16"))>c)){r.next=33;break}return d("skipping %p as they are not closer to %b than %p",T.id,n,e),r.abrupt("continue",35);case 33:d("querying closer peer %p",T.id),w(T.id,C);case 35:r.next=18;break;case 37:r.next=42;break;case 39:r.prev=39,r.t0=r.catch(16),A.e(r.t0);case 42:return r.prev=42,A.f(),r.finish(42);case 45:g.emit("completed",S);case 46:m=!1,r.next=8;break;case 49:r.next=55;break;case 51:r.prev=51,r.t1=r.catch(6),k=!0,E=r.t1;case 55:if(r.prev=55,r.prev=56,!m||null==x.return){r.next=60;break}return r.next=60,x.return();case 60:if(r.prev=60,!k){r.next=63;break}throw E;case 63:return r.finish(60);case 64:return r.finish(55);case 65:r.next=71;break;case 67:if(r.prev=67,r.t2=r.catch(3),o.aborted){r.next=71;break}return r.abrupt("return",BL({from:e,error:r.t2},t));case 71:return r.prev=71,h.clear(),r.finish(71);case 74:case"end":return r.stop()}}),r,null,[[3,67,71,74],[6,51,55,65],[16,39,42,45],[56,,60,64]])}))),{priority:IN-c}).catch((function(e){d.error(e)}))}},n=t.key,r=t.startingPeer,i=t.ourPeerId,o=t.signal,a=t.query,c=t.alpha,l=t.pathIndex,f=t.numPaths,h=t.cleanUp,p=t.queryFuncTimeout,d=t.log,v=t.peersSeen,g=new uc.Z({concurrency:c}),e.next=5,(0,m.Z)(YL(n));case 5:return b=e.sent,e.t0=w,e.t1=r,e.next=10,(0,m.Z)(XL(r));case 10:return e.t2=e.sent,(0,e.t0)(e.t1,e.t2),e.delegateYield((0,at.Z)((0,y.Z)(RN(g,o,h,d)),m.Z),"t3",13);case 13:case"end":return e.stop()}}),e)}))),ON.apply(this,arguments)}function RN(e,t,n,r){return PN.apply(this,arguments)}function PN(){return PN=(0,g.Z)((0,s.Z)().mark((function e(t,n,r,i){var o,a,u,c,l;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=Ut(),a=!0,u=[],c=function(){a&&(i("clean up queue, results %d, queue size %d, pending tasks %d",u.length,t.size,t.pending),a=!1,t.clear(),u.splice(0,u.length))},t.on("completed",(function(e){u.push(e),o.resolve()})),t.on("error",(function(e){i("queue error",e),c(),o.reject(e)})),t.on("idle",(function(){i("queue idle"),a=!1,o.resolve()})),n.addEventListener("abort",(function(){i("abort queue");var e=a;c(),e&&o.reject(new ar.s("Query aborted","ERR_QUERY_ABORTED"))})),r.addEventListener("cleanup",(function(){c(),o.resolve()}));case 9:if(!a){e.next=22;break}return e.next=12,(0,m.Z)(o.promise);case 12:o=Ut();case 13:if(!(u.length>0)){e.next=20;break}if(null==(l=u.shift())){e.next=18;break}return e.next=18,l;case 18:e.next=13;break;case 20:e.next=9;break;case 22:return e.delegateYield((0,at.Z)((0,y.Z)(u),m.Z),"t0",23);case 23:case"end":return e.stop()}}),e)}))),PN.apply(this,arguments)}var LN=function(){function e(t,n){(0,K.Z)(this,e),(0,ot.Z)(this,"components",void 0),(0,ot.Z)(this,"lan",void 0),(0,ot.Z)(this,"disjointPaths",void 0),(0,ot.Z)(this,"alpha",void 0),(0,ot.Z)(this,"shutDownController",void 0),(0,ot.Z)(this,"running",void 0),(0,ot.Z)(this,"queries",void 0),(0,ot.Z)(this,"metrics",void 0),(0,ot.Z)(this,"routingTable",void 0),(0,ot.Z)(this,"initialQuerySelfHasRun",void 0);var r=n.lan,i=void 0!==r&&r,o=n.disjointPaths,a=void 0===o?20:o,s=n.alpha,u=void 0===s?3:s;this.components=t,this.disjointPaths=null!==a&&void 0!==a?a:20,this.running=!1,this.alpha=null!==u&&void 0!==u?u:3,this.lan=i,this.queries=0,this.initialQuerySelfHasRun=n.initialQuerySelfHasRun,this.routingTable=n.routingTable,this.shutDownController=new AbortController;try{null!=Xb.setMaxListeners&&(0,Xb.setMaxListeners)(1/0,this.shutDownController.signal)}catch(c){}}return(0,W.Z)(e,[{key:"isStarted",value:function(){return this.running}},{key:"start",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.running=!0,null!=this.components.metrics&&null==this.metrics&&(this.metrics={runningQueries:this.components.metrics.registerMetric("libp2p_kad_dht_".concat(this.lan?"lan":"wan","_running_queries")),queryTime:this.components.metrics.registerMetric("libp2p_kad_dht_".concat(this.lan?"lan":"wan","_query_time_seconds"))});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.running=!1,this.shutDownController.abort();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"run",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,g.Z)((0,s.Z)().mark((function i(){var o,a,u,c,l,f,h,p,d,v,g,b,w,k,E,x,_,S,A;return(0,s.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(n.running){i.next=2;break}throw new Error("QueryManager not started");case 2:if(a=null===(o=n.metrics)||void 0===o?void 0:o.queryTime.timer(),null==r.signal){r.signal=AbortSignal.timeout(vP);try{null!=Xb.setMaxListeners&&(0,Xb.setMaxListeners)(1/0,r.signal)}catch(s){}}u=CN([n.shutDownController.signal,r.signal]);try{null!=Xb.setMaxListeners&&(0,Xb.setMaxListeners)(1/0,u)}catch(Z){}if(c=(0,ru.kg)("libp2p:kad-dht:".concat(n.lan?"lan":"wan",":query:")+BP(e,"base58btc")),l=Date.now(),f=new Ch,i.prev=9,!0===r.isSelfQuery||null==n.initialQuerySelfHasRun){i.next=15;break}return c("waiting for initial query-self query before continuing"),i.next=14,(0,m.Z)(Promise.race([new Promise((function(e,t){u.addEventListener("abort",(function(){t(new ar._("Query was aborted before self-query ran"))}))})),n.initialQuerySelfHasRun.promise]));case 14:n.initialQuerySelfHasRun=void 0;case 15:return c("query:start"),n.queries++,null===(h=n.metrics)||void 0===h||h.runningQueries.update(n.queries),i.next=20,(0,m.Z)(YL(e));case 20:if(p=i.sent,d=n.routingTable.closestPeers(p),v=d.slice(0,Math.min(n.disjointPaths,d.length)),0!==d.length){i.next=26;break}return c.error("Running query with no peers"),i.abrupt("return");case 26:g=new Xk,b=v.map((function(i,o){return DN({key:e,startingPeer:i,ourPeerId:n.components.peerId,signal:u,query:t,pathIndex:o,numPaths:v.length,alpha:n.alpha,cleanUp:f,queryFuncTimeout:r.queryFuncTimeout,log:c,peersSeen:g,onProgress:r.onProgress})})),w=!1,k=!1,i.prev=30,x=(0,y.Z)(WR.apply(void 0,(0,ye.Z)(b)));case 32:return i.next=34,(0,m.Z)(x.next());case 34:if(!(w=!(_=i.sent).done)){i.next=42;break}return S=_.value,i.next=38,S;case 38:"QUERY_ERROR"===S.name&&c("error",S.error);case 39:w=!1,i.next=32;break;case 42:i.next=48;break;case 44:i.prev=44,i.t0=i.catch(30),k=!0,E=i.t0;case 48:if(i.prev=48,i.prev=49,!w||null==x.return){i.next=53;break}return i.next=53,(0,m.Z)(x.return());case 53:if(i.prev=53,!k){i.next=56;break}throw E;case 56:return i.finish(53);case 57:return i.finish(48);case 58:i.next=66;break;case 60:if(i.prev=60,i.t1=i.catch(9),n.running||"ERR_QUERY_ABORTED"!==i.t1.code){i.next=65;break}i.next=66;break;case 65:throw i.t1;case 66:return i.prev=66,u.clear(),n.queries--,null===(A=n.metrics)||void 0===A||A.runningQueries.update(n.queries),null!=a&&a(),f.dispatchEvent(new Dh("cleanup")),c("query:done in %dms",Date.now()-l),i.finish(66);case 74:case"end":return i.stop()}}),i,null,[[9,60,66,74],[30,44,48,58],[49,,53,57]])})))()}}]),e}();var NN=function(e){if(null!=e[Symbol.asyncIterator])return(0,u.Z)((0,s.Z)().mark((function t(){var n,r,i,o,a,u;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=0,r=!1,i=!1,t.prev=3,a=(0,y.Z)(e);case 5:return t.next=7,a.next();case 7:if(!(r=!(u=t.sent).done)){t.next=13;break}u.value,n++;case 10:r=!1,t.next=5;break;case 13:t.next=19;break;case 15:t.prev=15,t.t0=t.catch(3),i=!0,o=t.t0;case 19:if(t.prev=19,t.prev=20,!r||null==a.return){t.next=24;break}return t.next=24,a.return();case 24:if(t.prev=24,!i){t.next=27;break}throw o;case 27:return t.finish(24);case 28:return t.finish(19);case 29:return t.abrupt("return",n);case 30:case"end":return t.stop()}}),t,null,[[3,15,19,29],[20,,24,28]])})))();var t,n=0,r=(0,Ae.Z)(e);try{for(r.s();!(t=r.n()).done;){t.value;n++}}catch(i){r.e(i)}finally{r.f()}return n};var BN=function(e,t){return null!=e[Symbol.asyncIterator]?(0,g.Z)((0,s.Z)().mark((function n(){var r,i,o,a,u,c,l;return(0,s.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=0,!(t<1)){n.next=3;break}return n.abrupt("return");case 3:i=!1,o=!1,n.prev=5,u=(0,y.Z)(e);case 7:return n.next=9,(0,m.Z)(u.next());case 9:if(!(i=!(c=n.sent).done)){n.next=19;break}return l=c.value,n.next=13,l;case 13:if(++r!==t){n.next=16;break}return n.abrupt("return");case 16:i=!1,n.next=7;break;case 19:n.next=25;break;case 21:n.prev=21,n.t0=n.catch(5),o=!0,a=n.t0;case 25:if(n.prev=25,n.prev=26,!i||null==u.return){n.next=30;break}return n.next=30,(0,m.Z)(u.return());case 30:if(n.prev=30,!o){n.next=33;break}throw a;case 33:return n.finish(30);case 34:return n.finish(25);case 35:case"end":return n.stop()}}),n,null,[[5,21,25,35],[26,,30,34]])})))():(0,s.Z)().mark((function n(){var r,i,o,a;return(0,s.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=0,!(t<1)){n.next=3;break}return n.abrupt("return");case 3:i=(0,Ae.Z)(e),n.prev=4,i.s();case 6:if((o=i.n()).done){n.next=15;break}return a=o.value,n.next=10,a;case 10:if(++r!==t){n.next=13;break}return n.abrupt("return");case 13:n.next=6;break;case 15:n.next=20;break;case 17:n.prev=17,n.t0=n.catch(4),i.e(n.t0);case 20:return n.prev=20,i.f(),n.finish(20);case 23:case"end":return n.stop()}}),n,null,[[4,17,20,23]])}))()},MN=function(e){(0,X.Z)(n,e);var t=(0,$.Z)(n);function n(e){var r;return(0,K.Z)(this,n),(r=t.call(this,e)).name="TimeoutError",r}return(0,W.Z)(n)}((0,Ze.Z)(Error)),FN=function(e){(0,X.Z)(n,e);var t=(0,$.Z)(n);function n(e){var r;return(0,K.Z)(this,n),(r=t.call(this)).name="AbortError",r.message=e,r}return(0,W.Z)(n)}((0,Ze.Z)(Error)),jN=function(e){return void 0===globalThis.DOMException?new FN(e):new DOMException(e)},UN=function(e){var t=void 0===e.reason?jN("This operation was aborted."):e.reason;return t instanceof Error?t:jN(t)};var zN=function(e){var t=e.on||e.addListener||e.addEventListener,n=e.off||e.removeListener||e.removeEventListener;if(!t||!n)throw new TypeError("Emitter is not compatible");return{addListener:t.bind(e),removeListener:n.bind(e)}};function HN(e,t,n){var r,i=new Promise((function(i,o){if(!((n=(0,Nt.Z)({rejectionEvents:["error"],multiArgs:!1,resolveImmediately:!1},n)).count>=0)||n.count!==Number.POSITIVE_INFINITY&&!Number.isInteger(n.count))throw new TypeError("The `count` option should be at least 0 or more");var a=[t].flat(),s=[],u=zN(e),c=u.addListener,l=u.removeListener,f=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];var a=n.multiArgs?t:t[0];n.filter&&!n.filter(a)||(s.push(a),n.count===s.length&&(r(),i(s)))},h=function(e){r(),o(e)};r=function(){var e,t=(0,Ae.Z)(a);try{for(t.s();!(e=t.n()).done;){var r=e.value;l(r,f)}}catch(u){t.e(u)}finally{t.f()}var i,o=(0,Ae.Z)(n.rejectionEvents);try{for(o.s();!(i=o.n()).done;){var s=i.value;l(s,h)}}catch(u){o.e(u)}finally{o.f()}};var p,d=(0,Ae.Z)(a);try{for(d.s();!(p=d.n()).done;){c(p.value,f)}}catch(g){d.e(g)}finally{d.f()}var v,y=(0,Ae.Z)(n.rejectionEvents);try{for(y.s();!(v=y.n()).done;){c(v.value,h)}}catch(g){y.e(g)}finally{y.f()}n.resolveImmediately&&i(s)}));if(i.cancel=r,"number"===typeof n.timeout){var o=function(e,t,n,r){var i,o=new Promise((function(o,a){if("number"!==typeof t||1!==Math.sign(t))throw new TypeError("Expected `milliseconds` to be a positive number, got `".concat(t,"`"));if(t!==Number.POSITIVE_INFINITY){if((r=(0,Nt.Z)({customTimers:{setTimeout:setTimeout,clearTimeout:clearTimeout}},r)).signal){var c=r.signal;c.aborted&&a(UN(c)),c.addEventListener("abort",(function(){a(UN(c))}))}i=r.customTimers.setTimeout.call(void 0,(function(){if("function"!==typeof n){var r="string"===typeof n?n:"Promise timed out after ".concat(t," milliseconds"),i=n instanceof Error?n:new MN(r);"function"===typeof e.cancel&&e.cancel(),a(i)}else try{o(n())}catch(s){a(s)}}),t),(0,u.Z)((0,s.Z)().mark((function t(){return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.t0=o,t.next=4,e;case 4:t.t1=t.sent,(0,t.t0)(t.t1),t.next=11;break;case 8:t.prev=8,t.t2=t.catch(0),a(t.t2);case 11:return t.prev=11,r.customTimers.clearTimeout.call(void 0,i),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])})))()}else o(e)}));return o.clear=function(){clearTimeout(i),i=void 0},o}(i,n.timeout);return o.cancel=r,o}return i}function VN(e,t,n){"function"===typeof n&&(n={filter:n});var r=HN(e,t,n=(0,Nt.Z)((0,Nt.Z)({},n),{},{count:1,resolveImmediately:!1})),i=r.then((function(e){return e[0]}));return i.cancel=r.cancel,i}var GN=function(){function e(t,n){var r;(0,K.Z)(this,e),(0,ot.Z)(this,"log",void 0),(0,ot.Z)(this,"components",void 0),(0,ot.Z)(this,"peerRouting",void 0),(0,ot.Z)(this,"routingTable",void 0),(0,ot.Z)(this,"count",void 0),(0,ot.Z)(this,"interval",void 0),(0,ot.Z)(this,"initialInterval",void 0),(0,ot.Z)(this,"queryTimeout",void 0),(0,ot.Z)(this,"started",void 0),(0,ot.Z)(this,"timeoutId",void 0),(0,ot.Z)(this,"controller",void 0),(0,ot.Z)(this,"initialQuerySelfHasRun",void 0),(0,ot.Z)(this,"querySelfPromise",void 0);var i=n.peerRouting,o=n.lan,a=n.count,s=n.interval,u=n.queryTimeout,c=n.routingTable;this.components=t,this.log=(0,ru.kg)("libp2p:kad-dht:".concat(o?"lan":"wan",":query-self")),this.started=!1,this.peerRouting=i,this.routingTable=c,this.count=null!==a&&void 0!==a?a:20,this.interval=null!==s&&void 0!==s?s:lP,this.initialInterval=null!==(r=n.initialInterval)&&void 0!==r?r:fP,this.queryTimeout=null!==u&&void 0!==u?u:hP,this.initialQuerySelfHasRun=n.initialQuerySelfHasRun}return(0,W.Z)(e,[{key:"isStarted",value:function(){return this.started}},{key:"start",value:function(){var e=this;this.started||(this.started=!0,clearTimeout(this.timeoutId),this.timeoutId=setTimeout((function(){e.querySelf().catch((function(t){e.log.error("error running self-query",t)}))}),this.initialInterval))}},{key:"stop",value:function(){this.started=!1,null!=this.timeoutId&&clearTimeout(this.timeoutId),null!=this.controller&&this.controller.abort()}},{key:"querySelf",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t,n,r=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.started){e.next=3;break}return this.log("skip self-query because we are not started"),e.abrupt("return");case 3:if(null==this.querySelfPromise){e.next=6;break}return this.log("joining existing self query"),e.abrupt("return",this.querySelfPromise.promise);case 6:if(this.querySelfPromise=Ut(),0!==this.routingTable.size){e.next=10;break}return e.next=10,VN(this.routingTable,"peer:add");case 10:if(!this.started){e.next=29;break}this.controller=new AbortController,t=CN([this.controller.signal,AbortSignal.timeout(this.queryTimeout)]);try{null!=Xb.setMaxListeners&&(0,Xb.setMaxListeners)(1/0,t)}catch(i){}return e.prev=14,this.log("run self-query, look for %d peers timing out after %dms",this.count,this.queryTimeout),e.next=18,_P(this.peerRouting.getClosestPeers(this.components.peerId.toBytes(),{signal:t,isSelfQuery:!0}),(function(e){return BN(e,r.count)}),function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",NN(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 18:n=e.sent,this.log("self-query ran successfully - found %d peers",n),null!=this.initialQuerySelfHasRun&&(this.initialQuerySelfHasRun.resolve(),this.initialQuerySelfHasRun=void 0),e.next=26;break;case 23:e.prev=23,e.t0=e.catch(14),this.log.error("self-query error",e.t0);case 26:return e.prev=26,t.clear(),e.finish(26);case 29:if(this.querySelfPromise.resolve(),this.querySelfPromise=void 0,this.started){e.next=33;break}return e.abrupt("return");case 33:this.timeoutId=setTimeout((function(){r.querySelf().catch((function(e){r.log.error("error running self-query",e)}))}),this.interval);case 34:case"end":return e.stop()}}),e,this,[[14,23,26,29]])})));return function(){return e.apply(this,arguments)}}()}]),e}();function KN(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;++n)if(e[n]!==t[n])return!1;return!0}function WN(e,t){if(!(t instanceof Uint8Array))throw new TypeError(e+" is not a Uint8Array")}var qN,YN=function(e){(0,X.Z)(n,e);var t=(0,$.Z)(n);function n(e){var r,i,o,a,s;return(0,K.Z)(this,n),s=t.call(this),(0,ot.Z)((0,nr.Z)(s),"localNodeId",void 0),(0,ot.Z)((0,nr.Z)(s),"root",void 0),(0,ot.Z)((0,nr.Z)(s),"numberOfNodesPerKBucket",void 0),(0,ot.Z)((0,nr.Z)(s),"numberOfNodesToPing",void 0),(0,ot.Z)((0,nr.Z)(s),"distance",void 0),(0,ot.Z)((0,nr.Z)(s),"arbiter",void 0),s.localNodeId=e.localNodeId,s.numberOfNodesPerKBucket=null!==(r=e.numberOfNodesPerKBucket)&&void 0!==r?r:20,s.numberOfNodesToPing=null!==(i=e.numberOfNodesToPing)&&void 0!==i?i:3,s.distance=null!==(o=e.distance)&&void 0!==o?o:n.distance,s.arbiter=null!==(a=e.arbiter)&&void 0!==a?a:n.arbiter,WN("option.localNodeId as parameter 1",s.localNodeId),s.root={contacts:[],dontSplit:!1,left:null,right:null},s}return(0,W.Z)(n,[{key:"add",value:function(e){WN("contact.id",null===e||void 0===e?void 0:e.id);for(var t=0,n=this.root;null===n.contacts;)n=this._determineNode(n,e.id,t++);var r=this._indexOf(n,e.id);return r>=0?(this._update(n,r,e),this):n.contacts.length<this.numberOfNodesPerKBucket?(n.contacts.push(e),this.safeDispatchEvent("added",{detail:e}),this):n.dontSplit?(this.safeDispatchEvent("ping",{detail:{oldContacts:n.contacts.slice(0,this.numberOfNodesToPing),newContact:e}}),this):(this._split(n,t),this.add(e))}},{key:"closest",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;if(WN("id",e),!Number.isInteger(n)&&n!==1/0||n<=0)throw new TypeError("n is not positive number");for(var r=[],i=[this.root],o=0;i.length>0&&r.length<n;){var a=i.pop();if(null!=a)if(null===a.contacts){var s=this._determineNode(a,e,o++);i.push(a.left===s?a.right:a.left),i.push(s)}else r=r.concat(a.contacts)}return r.map((function(n){return{distance:t.distance(n.id,e),contact:n}})).sort((function(e,t){return e.distance-t.distance})).slice(0,n).map((function(e){return e.contact}))}},{key:"count",value:function(){for(var e=0,t=[this.root];t.length>0;){var n=t.pop();null!=n&&(null===n.contacts?t.push(n.right,n.left):e+=n.contacts.length)}return e}},{key:"_determineNode",value:function(e,t,n){var r=n>>3,i=n%8;return t.length<=r&&0!==i?e.left:0!==(t[r]&1<<7-i)?e.right:e.left}},{key:"get",value:function(e){WN("id",e);for(var t=0,n=this.root;null===n.contacts;)n=this._determineNode(n,e,t++);var r=this._indexOf(n,e);return r>=0?n.contacts[r]:void 0}},{key:"_indexOf",value:function(e,t){for(var n=0;n<e.contacts.length;++n)if(KN(e.contacts[n].id,t))return n;return-1}},{key:"remove",value:function(e){WN("the id as parameter 1",e);for(var t=0,n=this.root;null===n.contacts;)n=this._determineNode(n,e,t++);var r=this._indexOf(n,e);if(r>=0){var i=n.contacts.splice(r,1)[0];this.safeDispatchEvent("removed",{detail:i})}return this}},{key:"_split",value:function(e,t){e.left={contacts:[],dontSplit:!1,left:null,right:null},e.right={contacts:[],dontSplit:!1,left:null,right:null};var n,r=(0,Ae.Z)(e.contacts);try{for(r.s();!(n=r.n()).done;){var i=n.value;this._determineNode(e,i.id,t).contacts.push(i)}}catch(a){r.e(a)}finally{r.f()}e.contacts=null;var o=this._determineNode(e,this.localNodeId,t);(e.left===o?e.right:e.left).dontSplit=!0}},{key:"toArray",value:function(){for(var e=[],t=[this.root];t.length>0;){var n=t.pop();null!=n&&(null===n.contacts?t.push(n.right,n.left):e=e.concat(n.contacts))}return e}},{key:"toIterable",value:(0,s.Z)().mark((function e(){var t,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[this.root];case 1:if(!(t.length>0)){e.next=12;break}if(null!=(n=t.pop())){e.next=5;break}return e.abrupt("continue",10);case 5:if(null!==n.contacts){e.next=9;break}t.push(n.right,n.left),e.next=10;break;case 9:return e.delegateYield(n.contacts,"t0",10);case 10:e.next=1;break;case 12:case"end":return e.stop()}}),e,this)}))},{key:"_update",value:function(e,t,n){if(!KN(e.contacts[t].id,n.id))throw new Error("wrong index for _update");var r=e.contacts[t],i=this.arbiter(r,n);i===r&&r!==n||(e.contacts.splice(t,1),e.contacts.push(i),this.safeDispatchEvent("updated",{detail:{incumbent:r,selection:i}}))}}],[{key:"arbiter",value:function(e,t){var n,r;return(null!==(n=e.vectorClock)&&void 0!==n?n:0)>(null!==(r=t.vectorClock)&&void 0!==r?r:0)?e:t}},{key:"distance",value:function(e,t){for(var n=0,r=0,i=Math.min(e.length,t.length),o=Math.max(e.length,t.length);r<i;++r)n=256*n+(e[r]^t[r]);for(;r<o;++r)n=256*n+255;return n}}]),n}(Ch),QN=function(e){(0,X.Z)(n,e);var t=(0,$.Z)(n);function n(e,r){var i;(0,K.Z)(this,n),i=t.call(this),(0,ot.Z)((0,nr.Z)(i),"kBucketSize",void 0),(0,ot.Z)((0,nr.Z)(i),"kb",void 0),(0,ot.Z)((0,nr.Z)(i),"pingQueue",void 0),(0,ot.Z)((0,nr.Z)(i),"log",void 0),(0,ot.Z)((0,nr.Z)(i),"components",void 0),(0,ot.Z)((0,nr.Z)(i),"lan",void 0),(0,ot.Z)((0,nr.Z)(i),"pingTimeout",void 0),(0,ot.Z)((0,nr.Z)(i),"pingConcurrency",void 0),(0,ot.Z)((0,nr.Z)(i),"running",void 0),(0,ot.Z)((0,nr.Z)(i),"protocol",void 0),(0,ot.Z)((0,nr.Z)(i),"tagName",void 0),(0,ot.Z)((0,nr.Z)(i),"tagValue",void 0),(0,ot.Z)((0,nr.Z)(i),"metrics",void 0);var o=r.kBucketSize,a=r.pingTimeout,s=r.lan,u=r.pingConcurrency,c=r.protocol,l=r.tagName,f=r.tagValue;i.components=e,i.log=(0,ru.kg)("libp2p:kad-dht:".concat(s?"lan":"wan",":routing-table")),i.kBucketSize=null!==o&&void 0!==o?o:20,i.pingTimeout=null!==a&&void 0!==a?a:1e4,i.pingConcurrency=null!==u&&void 0!==u?u:10,i.lan=s,i.running=!1,i.protocol=c,i.tagName=null!==l&&void 0!==l?l:"kad-close",i.tagValue=null!==f&&void 0!==f?f:50;var h=function(){var e,t;null===(e=i.metrics)||void 0===e||e.pingQueueSize.update(i.pingQueue.size),null===(t=i.metrics)||void 0===t||t.pingRunning.update(i.pingQueue.pending)};return i.pingQueue=new uc.Z({concurrency:i.pingConcurrency}),i.pingQueue.addListener("add",h),i.pingQueue.addListener("next",h),i._onPing=i._onPing.bind((0,nr.Z)(i)),i}return(0,W.Z)(n,[{key:"isStarted",value:function(){return this.running}},{key:"start",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.running=!0,null!=this.components.metrics&&(this.metrics={routingTableSize:this.components.metrics.registerMetric("libp2p_kad_dht_".concat(this.lan?"lan":"wan","_routing_table_size")),pingQueueSize:this.components.metrics.registerMetric("libp2p_kad_dht_".concat(this.lan?"lan":"wan","_ping_queue_size")),pingRunning:this.components.metrics.registerMetric("libp2p_kad_dht_".concat(this.lan?"lan":"wan","_ping_running"))}),e.t0=YN,e.next=5,XL(this.components.peerId);case 5:e.t1=e.sent,e.t2=this.kBucketSize,e.t3={localNodeId:e.t1,numberOfNodesPerKBucket:e.t2,numberOfNodesToPing:1},t=new e.t0(e.t3),this.kb=t,t.addEventListener("ping",this._onPing),this._tagPeers(t);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.running=!1,this.pingQueue.clear(),this.kb=void 0;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_tagPeers",value:function(e){var t=this,n=new Xk,r=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return function(){clearTimeout(t),t=setTimeout((function(){e()}),n)}}((function(){var r=new Xk(e.closest(e.localNodeId,20).map((function(e){return e.peer}))),i=r.difference(n),o=n.difference(r);Promise.resolve().then((0,u.Z)((0,s.Z)().mark((function e(){var n,r,a,u,c,l;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,Ae.Z)(i),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return a=r.value,e.next=7,t.components.peerStore.merge(a,{tags:(0,ot.Z)({},t.tagName,{value:t.tagValue})});case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:u=(0,Ae.Z)(o),e.prev=18,u.s();case 20:if((c=u.n()).done){e.next=26;break}return l=c.value,e.next=24,t.components.peerStore.merge(l,{tags:(0,ot.Z)({},t.tagName,void 0)});case 24:e.next=20;break;case 26:e.next=31;break;case 28:e.prev=28,e.t1=e.catch(18),u.e(e.t1);case 31:return e.prev=31,u.f(),e.finish(31);case 34:case"end":return e.stop()}}),e,null,[[1,11,14,17],[18,28,31,34]])})))).catch((function(e){t.log.error("Could not update peer tags",e)})),n=r}));e.addEventListener("added",(function(e){r(),t.safeDispatchEvent("peer:add",{detail:e.detail.peer})})),e.addEventListener("removed",(function(e){r(),t.safeDispatchEvent("peer:remove",{detail:e.detail.peer})}))}},{key:"_onPing",value:function(e){var t=this,n=e.detail,r=n.oldContacts,i=n.newContact;this.pingQueue.add((0,u.Z)((0,s.Z)().mark((function e(){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.running){e.next=2;break}return e.abrupt("return");case 2:return n=0,e.prev=3,e.next=6,Promise.all(r.map(function(){var e=(0,u.Z)((0,s.Z)().mark((function e(r){var i,o,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i={signal:AbortSignal.timeout(t.pingTimeout)},t.log("pinging old contact %p",r.peer),e.next=5,t.components.connectionManager.openConnection(r.peer,i);case 5:return o=e.sent,e.next=8,o.newStream(t.protocol,i);case 8:e.sent.close(),n++,e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),t.running&&null!=t.kb&&(t.log.error("could not ping peer %p",r.peer,e.t0),t.log("evicting old contact after ping failed %p",r.peer),t.kb.remove(r.id));case 16:return e.prev=16,null===(a=t.metrics)||void 0===a||a.routingTableSize.update(t.size),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[0,13,16,19]])})));return function(t){return e.apply(this,arguments)}}()));case 6:t.running&&n<r.length&&null!=t.kb&&(t.log("adding new contact %p",i.peer),t.kb.add(i)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),t.log.error("could not process k-bucket ping event",e.t0);case 12:case"end":return e.stop()}}),e,null,[[3,9]])})))).catch((function(e){t.log.error("could not process k-bucket ping event",e)}))}},{key:"size",get:function(){return null==this.kb?0:this.kb.count()}},{key:"find",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,XL(t);case 2:if(n=e.sent,null==(r=this.closestPeer(n))||!t.equals(r)){e.next=6;break}return e.abrupt("return",r);case 6:return e.abrupt("return",void 0);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"closestPeer",value:function(e){var t=this.closestPeers(e,1);if(t.length>0)return t[0]}},{key:"closestPeers",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.kBucketSize;return null==this.kb?[]:this.kb.closest(e,t).map((function(e){return e.peer}))}},{key:"add",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.kb){e.next=2;break}throw new Error("RoutingTable is not started");case 2:return e.next=4,XL(t);case 4:r=e.sent,this.kb.add({id:r,peer:t}),this.log("added %p with kad id %b",t,r),null===(n=this.metrics)||void 0===n||n.routingTableSize.update(this.size);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"remove",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.kb){e.next=2;break}throw new Error("RoutingTable is not started");case 2:return e.next=4,XL(t);case 4:r=e.sent,this.kb.remove(r),null===(n=this.metrics)||void 0===n||n.routingTableSize.update(this.size);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(Ch),XN=[77591,22417,43971,28421,740,29829,71467,228973,196661,78537,27689,36431,44415,14362,19456,106025,96308,2882,49509,21149,87173,131409,75844,23676,121838,30291,17492,2953,7564,110620,129477,127283,53113,72417,165166,109690,21200,102125,24049,71504,90342,25307,72039,26812,26715,32264,133800,71161,88956,171987,51779,24425,16671,30251,186294,247761,14202,2121,8465,35024,4876,85917,169730,3638,256836,96184,943,18678,6583,52907,35807,112254,214097,18796,11595,9243,23554,887,268203,382004,24590,111335,11625,16619,29039,102425,69006,97976,92362,32552,63717,41433,128974,137630,59943,10019,13986,35430,33665,108037,43799,43280,38195,29078,58629,18265,14425,46832,235538,40830,77881,110717,58937,3463,325358,51300,47623,117252,19007,10170,20540,91237,294813,4951,79841,56232,36270,128547,69209,66275,100156,32063,73531,34439,80937,28892,44466,88595,216307,32583,49620,16605,82127,45807,21630,78726,20235,40163,111007,96926,5567,72083,21665,58844,39419,179767,48328,42662,51550,5251,37811,49608,81056,50854,55513,20922,18891,197409,164656,32593,71449,220474,58919,85682,67854,13758,35066,3565,61905,214793,119572,141419,21504,10302,27354,67003,46131,32668,15165,64871,34450,17821,2757,11452,34189,5160,12257,85523,560,53385,65887,119549,135620,312353,115979,122356,10867,193231,124537,54783,90675,120791,4715,142253,50943,17271,43358,25331,4917,120566,34580,12878,33786,160528,32523,4869,301307,104817,81491,23276,8832,97911,31265,52065,7998,49622,9715,43998,34091,84587,20664,69041,29419,53205,10838,58288,116145,6185,5154,141795,35924,21307,144738,43730,12085,8279,10002,119,133779,199668,72938,31768,39176,67875,38453,9700,44144,4121,116048,41733,12868,82669,92308,128,34262,11332,7712,90764,36141,13553,71312,77470,117314,96549,49135,23602,54468,28605,6327,62308,17171,67531,21319,14105,894,107722,46157,8503,51069,100472,45138,15246,14577,35609,191464,1757,13364,161349,32067,91705,81144,52339,5408,91066,21983,14157,100545,4372,26630,129112,1423,29676,213626,4397,88436,99190,6877,49958,26122,114348,60661,29818,293118,50042,179738,16400,163423,89627,31040,43973,36638,45952,5153,1894,109322,1898,134021,12402,112077,68309,190269,69866,31938,107383,11522,105232,11248,14868,39852,71707,186525,16530,38162,106212,11700,5130,16608,26998,59586,108399,230033,43683,48135,82179,2073,5015,196684,189293,16378,23452,8301,35640,11632,214551,29240,57644,33137,91949,55157,52384,117313,5090,17717,89668,49363,82238,241035,66216,29066,184088,97206,62820,26595,4241,135635,173672,8202,459,71355,146294,29587,3008,135385,141203,14803,6634,45094,69362,50925,546,51884,62011,83296,234584,44515,56050,89476,87751,19373,12691,149923,19794,13833,35846,87557,58339,2884,19145,25647,12224,11024,77338,64608,122297,53025,7205,36189,36294,170779,21750,7739,173883,75192,35664,224240,113121,30181,26267,27036,117827,92015,106516,55628,203549,67949,60462,60844,35911,20457,1820,920,19773,8738,73173,181993,38521,98254,76257,46008,92796,5384,26868,151566,22124,2411,15919,186872,180021,28099,152961,78811,80237,62352,102653,74259,184890,16792,123702,224945,29940,19512,75283,14059,112691,92811,233329,20411,138569,53341,109802,50600,134528,66747,5529,166531,31578,64732,67189,1596,126357,967,167999,206598,109752,119431,207825,78791,91938,10301,27311,24233,252343,28831,32812,66002,112267,90895,8786,8095,16824,22866,21813,60507,174833,19549,130985,117051,52110,6938,81923,123864,38061,919,18680,53534,46739,112893,161529,85429,26761,11900,81121,91968,15390,217947,56524,1713,6654,37089,85630,138866,61850,16491,75577,16884,98296,73523,6140,44645,6062,36366,29844,57946,37932,42472,5266,20834,19309,33753,127182,134259,35810,41805,45878,312001,14881,47757,49251,120050,44252,3708,25856,107864,120347,1228,36550,41682,34496,47025,8393,173365,246526,12894,161607,35670,90785,126572,2095,124731,157033,58694,554,12786,9642,4817,16136,47864,174698,66992,4639,69284,10625,40710,27763,51738,30404,264105,137904,109882,52487,42824,57514,2740,10479,146799,107390,16586,88038,174951,9410,16185,44158,5568,40658,46108,12763,97385,26175,108859,664,230732,67470,46663,14395,50750,141320,93140,15361,47997,55784,6791,307840,118569,107326,18056,58281,260415,54691,8790,73332,45633,7511,45674,143373,14031,11799,94491,35646,96544,14560,26049,32983,25791,83814,42094,231370,63955,139212,2359,169908,3108,183486,105867,28197,32941,124968,26402,88267,149768,23053,3078,19091,52924,25383,19209,111548,97361,3959,24880,235061,9099,24921,161254,151405,20508,7159,34381,20133,11434,74036,19974,34769,36585,1076,22454,17354,38727,235160,111547,96454,117448,156940,91330,37299,7310,26915,117060,51369,22620,61861,322264,106850,111694,15091,2624,40345,300446,177064,1707,27389,54792,327783,132669,183543,59003,17744,20603,151134,106923,53084,71803,279424,319816,11579,21946,16728,38274,72711,5085,83391,88646,40159,25027,34680,10752,12988,54126,30365,18338,100445,230674,44874,84974,143877,123253,139372,28082,91477,144002,13096,219729,46016,50029,42377,14601,6660,58244,58978,23918,88206,113611,64452,17541,41032,10942,12021,49189,10978,40175,37156,10947,71709,106894,112538,57007,137486,150608,152719,40615,7746,279716,13101,19524,28708,40578,72320,1096,182051,94527,51275,22833,45164,81917,77519,48508,5421,140302,37845,149830,5587,27579,5357,428725,248187,6326,206760,39814,32585,89923,44341,288753,284443,96368,31201,94189,119504,20359,52073,103216,179,27934,32801,96035,34111,34309,101326,18198,20704,210266,37643,27880,141873,106e3,19414,56614,167714,66483,107885,86602,4379,20796,75467,4987,5017,118857,26003,34308,114428,29198,6686,29697,73632,3739,69795,16798,41504,7207,30722,21436,36735,28067,28545,3239,11221,36031,41889,100010,19247,317673,29495,174554,6424,129725,53845,94986,7955,59676,2604,191497,19735,102214,62954,23844,11872,179525,261436,34492,428,78404,142035,16747,17246,27578,37021,33672,57944,26056,135760,2369,61674,122066,31327,19374,157065,40553,130982,69619,71290,38855,72100,92903,95940,51422,165999,65713,57873,50726,7288,20272,2081,42326,22624,81120,57914,79352,19447,1684,72302,11774,302559,161481,96396,13692,414988,3721,79066,56627,46883,21150,11747,12184,5856,113458,176117,84416,52079,27933,3354,59765,141359,2212,216309,2555,23458,196722,142463,45701,44548,28798,19418,215,29916,9396,10574,114226,84475,13520,18694,34056,4524,90302,62930,13539,19407,77209,7728,38088,9535,2263,23875,183945,17750,26274,67172,10585,28042,22199,7478,51331,66030,26774,192929,31434,25850,50197,52926,178158,4679,181256,70184,229600,9959,105594,72158,73974,2726,35085,78087,23284,35568,51713,155676,5401,27254,11966,17569,223253,71993,103357,111477,55722,30504,26034,46774,35392,36285,214814,41143,163465,1051,16094,81044,6636,76489,179102,20712,39178,35683,125177,54219,30617,52994,25324,50123,2543,87529,58995,10688,125199,12388,60158,125481,131646,7642,133350,65874,3438,97277,101450,10075,56344,116821,50778,60547,98016,106135,13859,14255,16300,77373,173521,8285,45932,37426,4054,114295,55947,7703,39114,52,51119,128135,19714,60715,9554,50492,88180,2823,118271,52993,122625,97919,23859,37895,25040,33614,32102,20431,3577,9275,15686,43031,157741,110358,1884,40291,125391,13736,5008,64881,87336,77381,70711,43032,49155,118587,70494,4318,10168,30126,12580,10524,280104,104001,145413,2862,84140,6603,106005,13566,12780,11251,42830,571,179910,82443,13146,469,42714,32591,265217,424024,92553,54721,134100,6007,15242,114681,59030,16718,85465,200214,85982,55174,165013,23493,56964,82529,109150,32706,27568,82442,5350,14976,13165,44890,60021,21343,33978,17264,4655,22328,27819,75730,16567,55483,14510,17926,45827,150609,3704,7385,272531,161543,76904,122163,52405,2039,19165,41623,14423,228354,3369,176360,85491,7122,35789,303724,4465,13628,2233,55311,118771,20713,10006,221519,45115,71021,35650,29775,7337,10864,20665,21142,1746,15080,1624,32449,10905,105743,229797,7701,3940,22997,178467,57208,389057,39683,59403,63344,63125,54847,69691,18336,56448,3362,37202,18282,29648,138224,35867,10495,5911,28814,26653,31514,176702,26550,45621,11734,4525,40543,73944,121080,27858,155561,14887,44670,30742,8796,107455,113472,56369,75581,183777,240095,133699,153299,8768,160464,26058,49078,103971,21875,71486,44888,17156,9678,89541,123019,102337,3972,83930,21245,87852,109660,287918,183019,686,10100,39177,283941,11274,24736,26793,26214,25995,77011,141580,4070,23742,46285,46632,30700,26669,19056,35951,115575,174034,56097,35463,87425,24575,44245,38701,82317,85922,281616,100333,147697,61503,7730,84330,8530,59917,61597,17173,9092,32658,90288,193136,39023,20381,56654,31132,7779,1919,1375,117128,30819,11169,40938,23935,115201,101155,151034,4835,11231,74550,89388,59951,91704,107312,167882,115062,12732,72738,88703,464019,158267,57995,60496,737,14371,123867,4174,243339,159946,7568,16025,134556,110916,38103,191,80226,88794,29688,27230,10454,76308,57647,77409,113483,66864,14745,19808,12023,46583,84805,16015,17102,2231,20611,3547,95740,250131,34559,108894,8498,15853,159169,148920,20942,2813,93160,45188,210613,45531,52587,149062,39782,28194,57849,60965,84954,89766,84453,100927,16501,27658,165311,103841,54192,207341,19558,20084,319622,5672,205467,98462,61849,36279,13609,147177,24726,165015,209489,59591,31157,6551,117580,75060,141146,277310,21072,22023,106474,63041,137443,122965,68371,5383,42146,98961,113467,30863,23794,4843,99630,30392,82679,13699,241612,33601,93146,24319,18643,32155,95669,40440,15333,34089,67799,142144,58245,38633,114531,117400,77861,188726,5507,2568,8853,10987,107222,2663,2421,11530,13345,30075,41785,118661,104786,17459,12490,16281,71936,193555,17431,5944,71758,26485,77317,20803,367167,158,7362,93430,11735,172445,46002,11532,54482,930,62911,2235,23004,179236,4764,101859,208113,22477,55163,95579,14098,67320,162556,90709,156949,3826,57492,4025,34092,87442,104565,6718,186015,28214,14209,10039,107186,233912,58877,81637,55265,39828,6194,145813,50831,105849,4974,88319,122296,10272,197216,95714,51540,72418,23324,91555,8743,140452,250249,51666,34124,7229,38592,129641,78169,174242,22464,149964,51450,14034,10026,95376,26190,120062,14401,8700,265,31386,143573,7203,229889,61567,4227,140981,2466,72052,10787,10062,30958,6099,38471,30103,23202,208101,70847,467,58934,32271,32984,36637,24107,30771,17109,73353,13650,2098,157040,67366,66904,106018,265380,107238,18535,44025,32681,144983,62505,91295,56120,3082,77508,10322,63023,36700,81885,224127,16721,45023,239261,111272,13852,7866,149243,204199,32309,22084,42029,38316,126644,104973,14406,43454,67322,61310,15789,40285,24026,181047,6301,70927,23319,115823,27248,66693,115875,278566,63007,146844,56841,59007,87368,180001,22370,42114,80605,12022,10374,308,25079,14689,12618,63368,7936,264973,212291,136713,95999,105801,18965,32075,48700,52230,35119,96912,32992,8586,16606,101333,101812,14969,39930,759,193090,27387,42914,12937,5058,62646,64528,38624,25743,37502,3716,4435,30352,178687,26461,132611,42002,138442,35833,59582,16345,8048,60319,49349,309,47800,49739,90482,26405,34470,63786,32479,85028,39866,47846,11649,23934,29466,2816,42864,31828,7410,74885,49632,47629,111801,90749,19536,18767,105764,59606,21223,10746,76298,22220,39408,7190,79654,64856,11602,82156,272765,17079,70089,245473,51813,184407,384678,1576,122249,5064,27481,6188,25790,74361,27541,318284,45430,31488,620,93579,45723,192118,22670,51913,4162,70244,35966,26397,16199,50899,209613,121702,287507,2993,36101,132229,67345,33062,76295,118628,78705,52316,34375,107083,107454,44863,127561,33964,3073,154010,190914,55967,39074,6272,31047,5550,41123,26154,98638,47110,19998,148091,50229,31329,59900,195442,19106,61347,73497,70015,682,45850,25776,38022,148951,6288,37411,232526,109277,27286,32342,9262,5220,16651,23175,46740,129438,78614,121925,66914,88710,127952,5563,21500,34521,10739,14863,191006,62956,17359,16749,67027,56284,69134,43301,35039,58883,54466,60823,404451,75743,59856,86979,7923,34273,83785,32142,7693,268986,197428,282681,17049,22346,22990,92245,107180,3357,37104,96724,49153,7683,31197,43267,82231,164276,23696,20848,188364,22309,24821,158707,1018,22514,70922,27792,45589,59709,10765,736,35218,63479,51987,24275,63588,55361,92929,81964,4658,20122,12330,44058,13065,311456,72224,8337,211229,38979,22590,138478,52757,32595,133600,8838,31549,94412,43391,90056,1585,94802,127271,6223,31889,137038,132910,2165,57616,230152,6080,10748,36737,74579,134062,50525,180532,119270,34556,76155,82394,52595,29258,31435,87820,67996,26943,183878,38007,2410,13526,180297,69856,3503,187396,167700,7838,16701,9199,56267,3661,37407,65994,23767,5708,62508,221700,67088,86978,46776,84434,32088,5612,9149,88244,21685,95151,46750,189612,2979,506311,2594,3628,40074,105039,78243,28523,6651,38058,71999,30992,12764,68261,108991,6165,26450,61961,13400,22426,7490,60890,109623,2070,12958,50355,67979,257096,7213,42578,52121,35716,65461,7516,124758,39268,302,64712,14977,1467,219452,2840,34229,11121,21602,19270,63574,8024,1532,17331,79839,78885,52029,180767,57957,6069,91265,61380,55767,8927,32881,287603,22149,35029,68876,6428,199567,46926,13412,104132,21434,366616,45060,110046,81924,128910,45886,52821,130416,29416,77342,21762,67329,121432,79924,11724,38625,81006,102033,28338,13326,3250,82056,82526,38212,21112,12382,111495,3263,7414,86274,93490,40844,30224,45212,24019,48411,71367,24941,76729,57776,3769,38114,202019,197745,31953,237533,33270,201580,255648,100798,44741,32241,98468,106931,10085,15090,170358,33154,66787,18819,69760,25061,234005,82660,6295,131975,16874,9076,4094,25005,17740,40908,19533,220019,44330,99792,50040,19619,13950,55228,24423,31253,95308,103177,184795,28590,82285,5059,3210,75525,49894,70007,56178,10580,36051,139681,21617,98736,3555,106306,164189,37352,63915,47824,24883,145530,61904,28444,11483,19837,145446,30420,112972,85939,11835,191233,2262,20705,58630,1753,148334,1197,144714,6887,11223,107667,60879,77914,4151,57417,81594,96681,169430,1784,20444,95138,254041,27038,596,7117,72808,13759,3353,126776,21074,55322,27081,36942,39547,139830,179275,4453,713,8722,71399,19204,25785,22794,23923,104114,11291,25458,102309,88396,75288,230440,206396,104551,58447,130857,37247,94734,31548,176529,226077,65159,20104,10096,66881,94191,237909,27109,37404,1520,27421,25220,113003,23423,24884,50585,6286,231877,150800,11789,3226,90004,60642,5053,202400,61442,132531,175329,57138,30116,103847,9973,75367,16452,32360,59119,21246,10191,164804,23305,61051,37348,154530,13214,5468,50403,66754,130976,50559,80515,14436,155492,84017,5472,43107,41240,2890,90431,70188,382,76234,48040,50211,281038,237007,32115,142178,1536,22761,96429,1811,31243,1679,49143,55209,17402,235054,61494,7462,77030,34925,87609,78002,9499,9027,73289,201078,101379,63544,27666,5469,10642,30029,49816,132979,95620,58086,351930,116300,2110,2043,30845,6154,11279,16727,4122,2277,27281,4971,3650,39060,61970,65951,39674,75686,38151,11370,130809,177895,32665,63725,122267,7857,39618,118483,44792,157755,178624,136994,24260,41308,22471,12404,21707,12486,30473,52781,50246,20247,39065,909,56825,103158,128603,31542,1089,41935,32744,12428,37963,84420,33134,72921,208449,42622,168151,127335,147107,46699,38216,12591,94342,85814,31423,24944,2605,87542,67473,192551,4496,56321,91819,17630,6300,256183,114569,202090,33209,35289,34897,24967,40520,43470,5344,10199,34810,14283,10381,10017,62923,49924,23233,64539,13051,35686,19698,11570,135555,120868,44924,87065,52318,52335,47586,140906,245885,109834,78668,9065,46990,25258,72022,61243,40838,4545,146387,10537,11557,17470,36930,68104,46711,24264,79401,81043,18225,120488,24746,84338,81652,28266,13776,21878,46973,1047,230465,73357,95777,24973,210160,62210,58404,110633,169651,6937,41870,9909,26822,191062,76553,27519,96256,239070,2478,205678,67955,58532,20601,50120,19148,78501,195724,110740,8249,109665,27446,30568,57631,31425,49752,32820,65504,50079,3663,102256,219898,23849,211315,14645,4359,91767,9528,12449,49366,7941,49763,107848,8930,27086,50686,9744,10447,81935,39513,46514,1670,29229,6172,22312,137280,97759,9806,14445,22976,56458,73391,34983,93760,174219,52573,33149,59747,2429,136277,75123,165263,91040,7446,57632,48633,97140,246081,84766,151684,79918,93268,120346,54059,54875,77858,32996,103590,45276,11968,19600,25849,17159,132907,42828,16817,4913,99462,103303,27395,5737,74184,20749,21160,14377,77062,131403,158735,10999,27799,77785,9320,34366,51593,61070,33746,47048,29268,36675,30262,53297,9832,82e3,20188,122292,39917,7331,18160,68301,185935,134830,15031,4935,10004,165845,185534,46923,30109,44134,122631,18874,22903,112790,26561,18549,348902,82871,140345,255565,135390,63556,103747,145055,179600,145662,296111,61661,211987,23952,52342,126343,48450,32919,44277,82185,9591,62139,205363,376969,394874,108461,18040,120885,14798,39863,16571,16794,58271,81025,55206,14640,118656,6361,44092,85970,6262,153863,108244,180200,72264,79947,38044,10050,5735,61221,80712,5471,115689,11391,11661,184257,20010,60116,30320,19327,134598,45455,27542,18004,125092,452272,1549,91523,46567,180063,156026,2608,11174,58848,37788,65907,80194,30490,5786,40775,119519,106241,11323,156297,8425,61495,2617,29675,2425,59886,112582,49142,59618,4863,50597,86710,50650,168632,27693,85641,83643,18993,25768,84284,28090,93592,36627,312804,43381,9887,9402,100931,97165,3311,173330,66805,28935,4963,184460,3201,78102,19126,21607,37496,24938,22615,16153,32862,134792,153318,61120,6067,2812,12826,12792,23825,37559,64662,202250,102694,155488,85881,149193,46233,65383,15521,106982,11358,176786,25752,39717,34208,24510,32464,77742,39371,72028,138229,60688,71386,102834,132477,2208,11548,63670,271279,28351,30338,38620,32491,99845,143885,152266,13252,2825,178663,108097,1775,78201,14897,113573,163346,62292,171129,22183,96598,38733,64971,166776,117445,9968,146393,44677,74867,20908,97328,12761,25656,26785,9148,112344,26115,99176,110121,22437,49547,6180,79320,5835,31392,43328,33377,75870,119860,69497,80273,7325,155219,43167,111173,28347,20222,3763,71752,55041,47252,14618,28088,15012,97805,194698,54636,2036,41349,6173,96604,61530,51859,43782,13361,24334,22668,24792,7070,23441,16789,3209,36211,208475,26242,32880,122181,182407,21444,31060,88459,29929,77907,12716,10934,97005,20599,31690,8403,58445,30303,22700,10336,86731,103115,337709,72556,46788,112566,47684,67089,53548,36874,56487,41387,125985,26893,40071,106683,73712,18787,40105,72992,67246,137276,50802,36790,70328,138827,22466,39263,183295,29858,50975,9322,57397,10654,24364,30383,55799,41600,23584,127295,296610,129078,143558,244131,86397,36049,1085,80677,3820,108139,5476,34767,24683,7758,13060,7239,131671,250593,59556,103392,29810,4188,252323,39404,116877,7651,43600,40338,13554,157253,39196,25978,144387,61211,234,50104,6129,10449,93777,9240,356378,274148,4439,72970,3724,147770,78680,62570,115877,40027,40547,36817,224392,64609,34795,165027,67440,2477,37206,23431,50754,164797,46018,94995,170982,27051,7957,22767,3674,27900,56419,18930,60701,41302,2692,84749,339721,61996,111094,80221,50129,1045,8153,62945,19202,8250,37208,37418,32560,79477,41106,88569,33963,36693,5892,30570,1581,66471,49647,11922,160717,29442,5643,114865,82962,95982,132098,22633,22838,94726,54556,28566,205039,162340,33216,16849,35847,221339,94851,26533,71469,1805,3804,12935,45483,71020,36310,65381,192960,34240,35165,59773,1248,46954,155332,96864,4246,388800,16129,57133,74592,44807,442014,38203,42574,80818,91592,26377,36424,65760,977,77387,22628,147610,28018,30561,98454,6969,119628,63648,18170,36854,26601,64018,22027,37279,51395,152934,21153,9430,58760,194742,5330,55115,34158,28917,174111,13171,122326,1526,43896,66094,25325,4234,148354,11450,275,18999,112191,44365,22723,68409,8733,57746,96565,75007,14196,108844,29475,88599,177563,100792,106156,86323,93726,14248,135341,194131,40126,47099,14779,8272,39597,95983,171398,65882,28052,10393,47213,40689,22120,72212,106829,34964,109146,753,648,21660,30047,17527,181025,5619,145357,4085,216883,9359,186951,24779,53931,24545,36197,223296,62628,168101,4243,107313,30321,26642,13049,51059,31027,107912,807,73550,26551,84369,122422,165872,49754,74213,234264,33151,52014,33100,87183,22365,52500,40013,23302,5652,72723,21404,26107,48434,587,94049,168493,96418,32871,70860,31709,25128,443,71597,166253,15670,70994,26341,133675,28280,75491,54756,47955,56028,26182,11952,113272,472197,64640,110753,17919,337,50642,22576,142,87371,53391,93210,126694,15285,19642,85667,14148,1506,42092,52962,33243,11970,20734,135843,57044,58880,13002,219134,22876,64754,232519,4257,43120,321573,24799,64526,124728,52579,81472,70831,276848,17403,74359,23021,182101,74597,23744,148267,12055,7976,5349,11772,67540,167347,65318,18720,127832,108238,22828,90233,9987,259080,118185,73209,79270,13775,90100,137742,90799,70569,15699,19961,9087,67475,57872,39731,8810,134897,131868,146849,19898,3334,2281,167061,91073,60356,467742,74712,188,53179,137679,92769,29241,9537,132595,80119,1041,88962,5976,40171,44911,102859,139059,104558,98987,47761,19272,71472,113864,175377,73338,10857,23402,23758,1591,139864,5644,4076,118760,16427,134198,18853,20291,100849,37423,22038,36677,19071,195521,57445,11069,31869,55718,66882,148490,44,41296,75242,49704,166810,9906,20943,122258,49112,105667,15969,10344,6408,187694,21399,72742,58970,14867,14376,81889,41856,23225,15042,56993,16074,131389,74276,72407,53875,383108,53597,37363,68993,44854,122548,430927,198279,38430,80409,12245,2981,628,2818,17760,37437,238229,7968,46892,2200,3730,34190,65983,37959,112291,87850,70827,6522,20750,73913,111621,41652,19587,2780,58668,25916,85259,18200,168962,95781,42445,102050,7776,57662,103313,47742,96358,41964,66174,100396,29069,204735,19679,27978,7479,40264,22534,61183,36081,107436,58223,14680,23002,101311,24716,124108,12908,5646,31750,40380,14215,232799,102772,14122,96775,61398,50917,12096,149880,67833,598749,124194,155871,49216,790,14677,65319,56917,7440,145744,95701,12206,49405,129269,76199,45732,9767,11058,9047,210885,11051,7392,26307,2130,8132,147526,20802,232698,115660,50060,59789,57344,107623,80343,112676,23291,9866,160971,34032,118291,15719,59730,164911,28975,2659,58046,78480,21854,66209,53863,109085,116045,29021,46481,107552,22130,18764,70254,31272,11300,52460,43933,84738,20721,53869,190840,79673,105300,7561,321817,66924,13940,33281,101046,183181,32176,71878,5678,62924,79535,56646,40303,19559,27703,93042,73368,42187,3670,37376,46440,7023,36816,109628,20680,5940,276440,275233,170848,112093,136996,14984,20226,111441,77693,112960,48577,39370,55707,50314,123404,26570,54281,61372,123391,4857,35928,246740,132507,106646,44241,7196,92258,9825,37688,51197,303141,5590,15476,132986,10955,85782,34486,26696,7991,28813,18858,39546,11703,11365,38185,5716,93555,11925,40121,60002,6985,10976,171384,3887,43394,13337,56346,6381,252336,39573,75042,53711,1028,31781,44295,95925,131713,7214,68125,43571,70954,213234,1628,8760,13391,65485,17320,56038,1710,25248,60803,57399,19839,3870,326,281556,50945,72400,21460,316244,75619,56246,98775,481,13513,55765,50427,7388,123519,32929,57908,27124,61316,101097,57467,30228,48792,10788,20402,37318,50526,155730,34456,158065,145305,17832,43733,64052,4506,35072,205355,177028,184004,187081,68616,35938,83703,10367,36892,93186,260137,51934,89970,4985,23445,26755,21558,7948,78741,23376,124405,85594,68596,57536,49351,12619,56593,132668,99924,109728,71844,71935,196018,65464,17617,14987,89701,143773,33997,8687,22701,33258,2914,4436,72108,85610,9671,49067,2327,82988,1361,1672,44033,35777,30269,24057,10605,82236,616,15793,13919,47249,112086,116698,9484,80207,90574,33304,68624,93127,56101,42210,160929,4827,38995,38095,4701,125119,5027,33680,9236,231236,14135,87837,23318,70261,78893,30151,81482,14332,1084,74256,27532,46644,79185,3148,62615,6981,55672,31668,36825,1849,14536,37446,14738,23779,43058,162749,72199,1168,21346,5592,85932,85302,9668,18351,57135,150360,2080,228015,77953,34670,119302,151751,31009,106725,84265,45214,59289,74178,113071,263206,111009,4021,44449,188119,192629,123592,392506,292847,114487,12831,205858,9852,20780,79648,75767,357014,97721,18166,21005,67950,33226,204009,16536,2987,11335,66717,144910,47950,17262,55060,15063,2934,51038,26775,178497,66008,3427,49433,128592,20036,157553,63861,3089,23015,51210,28696,35933,49942,71135,231518,99620,17248,21835,176536,20676,16944,38700,165831,233253,295625,36723,13023,52745,10907,19423,67972,125868,95473,82875,1183,108455,52685,33417,64095,21433,52438,33191,127809,44505,211823,7810,2752,95548,162031,7185,91196,47563,61721,33359,17897,23682,42806,178101,22874,49707,199897,75419,82456,8618,11171,79712,116847,18783,44190,46564,5346,59046,95032,7893,14916,3214,26800,24172,121453,34362,10250,17408,18888,4840,68696,22831,13162,36005,32512,14800,62357,41723,45046,27247,37486,5372,2564,34261,298500,66509,133920,89138,31305,117697,19097,108304,81386,84106,23802,46411,63304,946,51417,41777,41041,19501,115864,60743,294354,37955,94165,18116,1156,17937,20645,57114,90804,58042,48643,92288,9861,2557,88546,61333,101008,12853,5148,87856,4152,144503,73841,18718,9789,147565,10846,42085,12789,30223,8993,56352,67203,2448,28215,6052,23540,126319,75933,36689,80235,23231,23561,21383,38800,77548,102798,21234,31468,158608,46188,63960,191679,8051,67014,11185,170078,42186,28827,34777,41930,212079,12421,34750,24111,110344,73918,45171,70826,141949,40063,23979,24254,37309,26724,27179,24718,83648,54938,14591,17425,29525,102675,48975,48654,12316,8929,60640,41709,50168,63264,89812,50716,48632,38755,138583,160123,55579,71829,24230,233277,46322,39650,166388,34718,24108,98252,7031,106695,62498,18258,35062,217827,78731,34824,33354,19520,60852,2432,60224,8587,2836,62955,702,20227,42285,40560,95592,62486,11094,53035,143291,18842,46177,77994,1770,9657,107422,172915,32655,128716,25886,25164,156740,119928,165875,85817,11007,89110,33956,12652,65156,180266,8494,36889,19958,20955,96,1264,118288,135769,44754,86671,5632,19026,168220,289120,33569,93821,66144,70635,7687,5642,2714,55445,56636,71545,184182,93133,7332,37389,12643,52315,22729,11014,158742,17050,152889,50178,34601,41945,52136,9948,26914,63548,95721,115951,40759,8960,158258,38938,49232,48325,42234,81523,253019,66128,40978,20048,238048,38760,62928,122560,118532,43687,137472,163689,26680,9878,17448,51035,16211,60834,36749,29178,14241,59868,150086,2305,26477,42422,34342,165341,83279,33894,14257,29928,12743,13957,125571,89134,66712,10952,16507,147839,30146,7249,16565,45399,39874,114565,215780,31990,230881,171477,102,196546,44538,10880,84948,281705,86651,10617,31395,2342,453658,43569,60561,132901,21845,17727,58556,258242,22262,58728,4008,77997,11806,37431,30599,81375,109137,185787,114085,217292,97453,169085,30593,60212,11544,102056,65580,2384,91655,4855,95725,7295,157994,16228,20669,53276,141590,105246,17334,25440,76067,17967,39321,38911,11362,28559,63807,21627,26468,85816,40120,1025,15234,58319,69516,66512,124548,75845,78873,22137,46681,51242,85683,32909,76747,35555,43396,101465,1765,73094,1077,2962,39028,66777,57831,42048,15828,13962,36041,63657,52412,5242,58846,2141,5506,219012,134451,3936,182230,17558,17153,152237,22621,49377,170216,35257,68233,65374,6510,11126,212151,7184,2480,22517,3437,33073,30156,16557,3768,55067,86829,91e3,12350,148650,66017,79424,70885,49066,28250,21369,51213,34533,11510,3258,18176,18465,84413,6315,36411,163765,4346,356,107618,598,13727,285026,162695,8749,14583,7132,63521,184253,32378,25991,5604,30961,53675,4874,84693,5086,34811,26978,56564,7904,33519,51221,113942,69253,6664,125563,22055,220680,102008,742,51930,19494,176108,44424,35123,13025,75685,11759,74335,22250,181453,131147,16984,132115,154311,11991,76452,52609,85351,196,30969,9198,74919,2529,56838,71779,29187,116304,3504,62330,41190,86153,28393,254926,104228,105189,13264,84359,3574,12415,8534,57147,10175,188174,59504,60932,66318,16407,107921,17638,99103,49278,28403,39786,145865,8462,3558,43406,142271,29139,21989,36552,93955,72365,7176,13556,106185,37957,321774,17782,129017,51154,27938,24952,1935,39366,2791,33489,41582,56078,24558,9311,5449,218786,27808,190429,68013,36020,86003,29735,3404,87348,119357,115714,2324,86796,81973,40992,43376,93621,28784,16808,36367,2517,2909,191926,24978,55303,53308,205724,60068,3098,21375,64784,23949,26579,63121,12319,80145,39967,97861,6757,70143,67642,37082,34698,69140,122883,46151,62187,80934,429,19437,135071,137885,222647,13331,154065,327,61778,74257,40116,37493,14855,85079,237641,42342,102164,199965,71204,4662,29368,5042,113914,122214,8955,13149,102503,43173,5659,163787,69003,307084,63392,171080,21390,81918,86666,36622,24126,28887,5736,28054,207170,163428,79891,346467,95363,38980,111806,80828,9200,19288,294896,114468,87405,111715,141705,7015,72754,68463,48738,243147,33397,101210,37051,98801,82847,20397,4940,185559,18716,54718,83491,11725,40803,1128,12128,23060,5174,7745,67007,46701,1571,27807,180186,256996,18975,16837,7877,212758,250379,15440,87954,57755,24719,124057,83461,258,50864,8874,29038,71289,31627,15429,9005,4061,113851,107716,82819,13651,79656,117851,17539,111446,12938,39724,190787,4352,15402,21070,62708,8539,23777,73853,13552,38810,86117,16285,56400,1718,75342,142863,29033,378,110113,180321,32586,23606,26393,160984,207987,23783,8406,16904,24596,47274,11693,46539,60524,78595,48423,31718,20170,9009,146268,15183,191060,172765,1349,138436,37365,10970,40509,225817,20021,70394,152138,21541,66559,66544,89352,2725,17258,91345,7313,3815,115868,8660,40362,4071,103524,39388,118275,21950,6549,38226,32754,209574,29201,43495,18028,20296,40597,18370,47520,202450,24134,2219,8195,69545,38041,136934,46374,19041,159811,84865,58620,846,98749,13569,30714,97246,32186,4479,27355,92973,35214,151491,75963,37631,1561,27200,238083,23182,60756,12291,25766,39355,102333,87362,65741,59906,19538,201575,48772,102938,24438,292580,39964,66366,9004,61379,50548,37622,38732,28379,68180,76622,17488,69849,5963,7219,48143,43413,55358,540,58691,29506,19245,52193,48621,5518,13048,118625,44755,191081,42061,89197,2259,60665,66994,71210,51232,3585,142096,55024,7892,8345,58653,463307,65658,64319,137941,136323,53499,12746,43492,6978,95163,29925,60175,5128,7352,41463,184756,121146,20473,18426,4598,5309,54580,14277,121151,10691,56711,43880,63409,76682,11830,172218,264898,32632,66536,81062,31649,25788,92774,60222,11100,63159,9432,224657,25240,53613,152,138620,163829,2397,85345,12501,37507,64932,38575,43522,65789,80198,78796,35226,3851,108891,73311,3060,28391,93671,39663,46142,30982,66041,37281,68157,26553,71872,81142,211527,39747,118119,22695,2859,11066,20232,168911,7933,197005,17066,111071,44434,133994,120798,12766,227798,45756,132852,29917,36076,55352,65281,129800,41958,18944,84678,18580,168093,132621,39997,54092,27740,32354,3770,114118,103242,43918,15899,18574,145944,3190,123469,219903,24169,100571,62403,16776,92779,14535,17168,16475,14304,37231,1712,28218,242754,61688,28980,1318,51359,222657,99200,67989,31772,23932,35351,201251,49041,27306,19128,40135,3986,77333,19649,120683,151927,21081,7076,78375,77501,101599,8011,89585,96715,58179,5378,102138,106793,26051,217276,4197,16297,27014,46721,13322,22806,5278,29629,70632,9647,71519,58818,40603,128530,8903,36770,56900,31483,26935,43845,34265,34920,87658,6114,84767,64250,47318,50720,19264,162514,33357,13117,6705,46696,75032,71054,87004,42035,69138,11903,99854,102328,19611,34525,69312,6431,49842,101600,133178,108751,41829,89939,225664,48916,99556,9195,130387,5960,36857,116724,53518,94002,39077,53996,6945,22261,64291,8314,152785,57588,16522,9091,5048,87671,35441,39509,1945,12423,158923,178413,37549,14095,1475,73188,62878,4819,24012,68534,42606,4010,120809,57497,59564,101758,103718,32701,80116,12345,95834,46918,21468,53213,15665,31200,3867,5140,96013,250744,21016,10069,13968,35449,180829,27683,39704,59956,22893,3115,26293,32785,75934,62445,141162,62720,2018,83638,19949,114012,95006,3330,99829,130935,309272,9565,55874,121727,37017,23586,319858,40970,27602,8625,112329,61060,100088,118525,25922,16232,1907,60671,51583,44553,80993,5262,94679,8676,940,20736,11823,3020,16476,12340,152600,97416,3703,25744,66826,16245,16876,46446,84798,74227,176020,45192,61955,75496,23946,23626,40372,26036,6149,11822,30582,16541,41914,82385,232823,40921,80773,14930,3631,7517,39619,4348,36180,126106,138939,62611,1477,113512,47321,25052,14546,118881,29060,23589,128322,36795,18401,137921,104699,267929,36194,172791,18113,4766,188215,30083,332586,94089,5805,77909,22194,68234,154976,43220,40660,70001,184893,138095,11128,103010,22663,5108,212615,8485,5565,49222,54614,26530,42639,16319,55062,152662,105595,21114,22216,10294,68158,10436,86950,7206,62115,3977,3657,59874,456,118617,18156,106663,112229,80992,17442,8217,55551,5133,34344,251927,51153,39364,201321,7816,66803,23057,156724,145664,14276,95705,979,2796,6875,13429,212525,50602,26276,28284,3424,19465,52397,46963,31420,51399,206476,92317,48851,637,100820,83349,10317,60227,21972,6908,282439,32857,224767,95629,83882,42106,87338,69757,29840,68709,37665,45244,114577,49188,175943,54009,186746,106158,70168,3358,234002,50555,9221,129338,9562,20118,32923,78479,118280,65752,4977,10474,102174,60947,129006,10570,83451,8598,8078,159367,123785,80438,16742,5905,5281,181513,42402,6977,163136,93179,42191,14968,50421,112401,105440,33456,57347,121611,4221,94954,36517,24046,27796,6255,33394,72990,135408,116627,1233,57874,25654,95419,68156,401399,313338,55208,45573,93124,119251,47200,38196,11909,130667,45391,73904,64964,167846,4137,115606,52036,62214,7969,160925,7187,1132,134835,40309,73195,64494,80472,444841,61111,26500,45323,40743,53625,52797,22659,15631,29739,36706,28841,39147,102836,26794,10536,14845,87305,45874,12241,127587,83833,57183,79722,30844,41304,84655,20825,92500,3722,25655,27811,10157,81634,31362,34088,92487,70123,22190,185100,72658,139035,192523,88241,2078,230490,44528,85638,100198,22088,29982,291233,241062,13865,4445,137791,37835,107218,31726,19718,38234,72528,23046,19177,66695,5109,17251,28077,5617,21554,47839,72425,133825,1486,73065,181275,141508,21768,62971,63082,2512,34200,9904,120309,6392,91243,68416,268253,41199,116757,138551,185526,41246,28986,4093,19057,17295,4148,245766,122360,35356,112075,20301,75441,10998,7977,19769,62922,937,63547,100196,26427,157820,20983,236696,22935,8140,90315,156004,47204,140973,7726,45097,52725,22636,23436,257282,105247,522,88389,216031,202204,46812,211666,19693,68828,81691,45925,11256,30292,372,5236,167826,88328,232776,151611,5360,82104,18841,80393,25465,18285,20320,72377,31730,33160,45803,38715,27705,37379,24163,18360,103586,4015,32305,269494,91252,20080,36567,54650,7797,57073,12650,31164,42209,6375,261663,105528,81661,106002,2800,5375,17247,43151,4442,15727,194619,100855,144898,62320,78465,39929,16454,1967,28311,61363,17219,9395,8745,121445,76939,80385,162380,22009,54191,44248,16299,122830,48151,74429,78291,64755,14238,44966,2511,17712,67954,93583,829,105899,49935,84750,11591,33185,85447,42717,27409,208542,28965,62052,52525,5597,25694,65594,16343,63224,276188,12475,9331,127507,38522,57287,24128,133161,79723,105548,133695,48917,27558,43278,46520,13778,141954,110785,83366,17715,46317,105763,66298,147013,41086,94180,16478,220447,44611,730,19722,78975,117889,125643,26254,16574,18480,65006,15806,38549,246418,46052,36056,8440,34984,30170,3163,59800,4458,115442,4283,41970,33507,104078,1653,22,121158,276486,3655,6338,24048,133421,23641,2161,24422,36006,8086,10675,181474,12307,29514,59143,14729,52509,87128,122470,19446,80852,33314,24573,119864,14237,9652,57779,6612,51851,15284,98871,90581,124466,156831,21190,22015,71380,161906,87247,69201,18392,17908,108470,72962,40719,14338,17911,95260,43339,20610,78916,20710,72451,11315,31448,17263,58853,178878,48111,116002,45497,80506,82605,85880,36300,121755,25215,36118,301929,88728,405223,276136,553,34704,212438,49970,78329,922,20711,25036,257130,38295,145369,18128,15385,30829,55656,48345,8012,3561,28004,122041,192900,58338,112508,41085,29976,87040,47117,23905,4336,92061,138880,97407,42083,172121,6256,25192,172671,5,93568,1420,12677,31605,56743,40620,6015,78415,231077,31298,80026,13902,19048,24924,170586,32955,176119,87859,36731,6773,27711,24658,26475,115216,133207,93250,95820,88522,8317,5714,124047,55219,86860,19677,23961,22928,162209,8904,225992,359835,56084,96201,29392,96558,86071,93643,55114,13347,8183,95129,82012,2017,123336,34219,115554,157159,47747,101684,41008,18735,193781,104151,226906,7552,179874,124113,31159,21162,44010,14771,51268,166128,31382,73124,77438,92830,205709,12113,1292,38937,13114,1334,2118,15597,69581,14449,21934,76618,48728,67038,14967,51495,24243,87736,147249,26720,11119,46063,43749,5843,44147,152629,133428,65703,14269,45604,57982,28672,55616,45957,8438,95433,37698,220862,132034,39456,61870,4161,26501,73560,56418,9845,4654,20916,10456,88920,119358,9015,65931,96507,48029,38534,21676,109081,43078,34943,25089,6131,28766,23665,5477,10255,16695,67,45778,42443,42770,29534,23733,100513,62617,42630,48746,14191,43753,50295,26007,8792,57243,43119,54725,164253,58250,112304,131796,25165,4651,3188,24831,47748,3705,19540,13211,102095,5593,18699,23666,32005,117571,33541,60584,74573,86311,99443,25172,27222,168938,7143,11853,53560,18834,19960,86522,28217,53266,117700,72989,34323,18721,66450,34346,74056,47217,202002,46269,9429,68582,75458,37823,82843,96652,32549,145144,27958,19820,158086,31955,201406,135379,31207,192545,12950,51704,9094,248263,76147,64028,110009,79407,89345,99284,223492,47966,26848,15359,201137,2861,110507,71231,72297,31851,118777,71039,151051,240855,16333,50766,14727,7939,4149,80908,418780,88378,59276,1327,7284,38576,79814,65820,42199,84860,49574,62596,12396,70598,40117,8648,7994,16836,7630,14047,359699,106878,525,29037,28064,13380,11675,50669,74216,103539,180314,27449,56299,172344,19274,7301,246099,32043,19422,36506,129317,6806,30140,4614,46639,66926,932,86600,6322,27847,233103,10541,39025,34887,3517,12972,26220,2031,66561,115015,48658,47596,12714,33845,3893,16165,35237,89983,14769,11962,147224,47018,29977,27979,5552,82338,86023,131368,1218,24853,237840,132193,15455,40873,3668,65351,53388,15229,59889,272245,47934,11858,34347,18038,90853,86981,300602,19343,114181,29362,84921,6095,106059,79472,38015,1206,48741,6208,8e4,21916,17423,6002,108083,24479,34931,56661,9511,26995,100694,163853,35997,81254,58321,18919,171890,86877,91341,74503,70477,53412,7027,59281,39892,131302,5864,15947,61301,67466,162369,47956,27874,35624,282324,21270,111847,102548,41482,30955,116737,28264,8592,55458,22301,75090,29821,30697,51709,3041,19208,8038,24634,30467,87509,126428,19389,18814,152686,20701,83474,45832,80891,105808,11378,153223,120770,98186,150633,49838,9141,12755,30962,5260,74490,21256,31678,65062,33326,289838,187831,20595,89768,2805,58535,10844,70085,12090,2451,138068,98544,24461,4511,6754,41684,28203,3383,65355,82833,30161,83924,234361,128424,28921,222594,33975,125491,34069,11508,67464,144226,41850,98703,34371,7901,21254,38398,65651,23549,53883,213340,123269,12028,71764,177701,28758,2623,68395,11549,15232,68603,9660,63116,36079,57093,31198,20475,48467,89984,35619,186847,107469,31389,43631,73867,41949,68841,114250,1605,30564,63403,17588,27680,99533,12641,70325,50428,73426,78379,11855,91651,72081,91720,60198,15743,12065,83398,140046,6761,46598,45900,5068,886,62448,148968,37347,19405,9680,15819,43496,63370,75667,163700,37639,3633,22774,34341,183131,134335,37200,23915,7054,14194,12970,26438,13350,285521,25594,8219,104410,91039,168804,138480,149734,15907,33818,61132,60082,4622,110187,56736,13551,73571,3945,73463,65498,17758,263266,17593,2710,27585,54469,38200,45367,63754,28881,3473,12791,98287,31895,65787,4463,94536,24951,36332,59901,28803,52130,86403,7668,181822,74831,18977,9850,177206,145485,109798,7292,31421,26280,77211,58511,12507,127004,11113,147,8729,56208,43066,79926,129937,31345,83947,39915,46146,98763,42566,1337,13192,18323,105163,80570,117753,16555,72883,11077,159438,40764,70933,83329,26066,12276,72059,21655,173836,126713,69454,153482,91585,70644,102558,110483,6764,127864,190133,3961,101798,20945,71138,82402,90884,69669,44753,923,16939,59700,164258,25969,27082,31399,43846,6306,246093,51342,6153,151581,202801,182731,56475,162188,89426,141356,14355,121815,27536,28023,65257,77523,106668,127314,24947,12790,38796,169698,23555,10725,44573,183083,42088,62716,43265,105958,32050,44067,50118,1668,3874,6243,318411,16599,1691,94999,52378,28671,216728,123258,2059,34969,69225,5913,136280,171443,141515,91662,22175,135282,80020,92270,1663,4808,4482,3495,34691,5226,109830,108512,17342,107488,11606,123190,100247,29666,146527,113014,15794,30894,13224,39585,243192,22351,9903,7836,47699,11078,25468,122291,48821,26780,122679,75521,81450,630,4895,92900,55074,74293,17441,3563,111657,103102,51613,12318,52370,36191,68245,34269,40445,41354,122901,168604,182500,62012,42557,11259,24428,115113,86345,12362,3909,78430,86852,134602,20459,47853,93879,22577,7659,3688,38555,13349,17381,56715,91639,12493,10895,92438,3142,37057,28928,2004,36427,32268,34222,209974,10432,67436,41989,173518,107930,27079,62729,30908,55558,5828,45031,14902,53546,8204,144263,60255,14520,88212,86582,109589,69356,8064,47449,8505,66558,16886,4844,52817,111260,215129,12941,91118,650,20770,6273,73089,40618,62790,2873,35002,14023,97208,19386,102646,36993,143736,135457,35385,113601,17893,32627,84439,100619,56016,6581,57264,172160,45452,111710,203627,70131,24100,322787,1996,35665,70078,22358,90922,83658,4097,63200,58499,14542,99153,52159,6615,12414,63415,31986,16823,1579,65405,137809,8841,16898,48082,259,33014,42375,12260,179850,73667,91389,98882,29532,17311,326251,41092,5928,20742,44964,48019,43505,9317,49265,6643,192712,48424,163487,19861,20113,70848,31928,105333,23685,78563,14638,54755,7158,24142,44018,20774,125255,20331,24280,10163,1285,2336,39851,4299,117269,46714,63816,87779,159624,11731,9971,990,137317,108831,50994,74554,162680,23640,131597,146962,170620,34829,91205,21184,1913,63616,18427,93136,156592,17519,67565,115882,138220,78622,88535,18115,2711,33554,109492,54298,971,24914,25863,36363,45715,27099,194995,14299,178181,111488,72395,322385,157719,130787,11897,81843,83999,11369,49280,118604,40922,61332,110343,53407,75639,40582,300440,54722,25637,13694,48248,48278,194521,56203,52779,48783,72627,10953,376,16733,280238,26351,230789,15132,25168,137270,3588,63704,73376,94031,74284,19443,159557,9697,39901,13351,119050,15406,146455,3460,29556,75195,37673,102524,92329,47289,98413,15311,100684,56345,7116,95480,11590,7200,167,23610,58426,17730,136656,27944,53151,2701,8824,103124,3017,90744,113588,53216,79736,65940,26931,498,29568,80540,143543,21292,1740,59268,16561,180816,42323,50174,40890,52866,10703,57169,4700,17191,4424,93511,49698,166650,26972,48631,165169,82879,69326,202970,4007,2376,231325,139592,22119,62851,37504,68816,58345,67398,186643,43331,277416,53749,15746,23102,17432,4793,151138,48822,54265,48203,198688,14305,54287,2291,18018,113378,123260,7180,97549,87027,120085,2920,76080,8190,102005,5641,64580,14955,59802,54028,58884,19367,81779,412567,85957,97053,103637,78871,29364,27637,141728,4767,30686,112738,130146,42745,12730,105040,14844,232,210944,36581,152317,135543,29744,3129,55647,58149,46319,27265,17499,28005,59948,7170,34138,5702,293047,110892,408,91760,218674,18469,46095,81403,14389,4610,35672,73060,11006,74848,104820,118143,190357,20043,105358,141735,5115,27093,45924,123073,52599,29433,9616,238350,78610,24851,58858,26769,31969,24613,18294,4982,32735,39639,143563,112073,202205,12567,4873,88601,44897,81503,101648,81362,34662,85277,17574,48173,21435,221188,40215,39576,80786,26544,64668,81841,10731,37733,247986,149188,127703,495,18382,54388,72446,43071,30974,198723,89608,41360,190,33045,8386,31658,19992,237838,119015,137622,50890,100913,6460,116233,267230,26621,104129,65114,14190,41542,14888,85962,23342,23041,26453,43725,71809,45186,4770,46452,53894,56616,221286,18973,9038,109299,55365,19366,26863,18808,60909,69353,41738,83463,12100,68561,72860,3980,13796,49340,12332,31311,27418,4255,53430,18976,45523,510,14224,30477,26581,4530,3651,101663,139840,22709,150861,31996,63923,120623,262522,3076,10528,2929,14672,130238,18087,9816,121894,100308,25085,55111,14565,18952,53293,2042,369988,23674,61789,133529,28783,108293,35477,47119,36448,71049,40015,33055,78598,198442,1833,159937,40654,77444,189245,113153,8621,18599,38553,35223,166072,2375,11659,21786,89523,6032,12116,63046,159398,18454,3678,32521,47626,11411,103527,38896,42946,15696,26370,10185,8413,37080,165583,4331,63555,14907,72220,50056,6623,62236,36565,49783,10049,17503,100581,55951,146244,24724,9626,17969,25524,109300,173965,99994,101056,46459,43647,53737,277968,8347,123521,74858,33829,44762,77574,877,81377,222525,123532,30602,43881,53145,2973,16284,81940,61281,127044,63620,9875,14756,114829,19032,9202,52759,119141,23928,120551,19607,3599,33401,76821,73233,117430,39968,36539,7071,5446,121735,194059,15206,45283,6706,15603,65615,1207,165723,92275,34773,104447,8396,32353,205240,164323,13600,60555,79205,25532,22907,33410,57480,107111,69630,32137,47832,70913,33161,20321,2371,117348,10714,86246,1625,11763,17900,268,78457,99175,97940,101092,86660,32221,14041,128504,125080,53744,124263,31017,13897,403,31859,21964,5633,111630,5547,77329,17961,18241,84995,25984,12983,67491,62168,47262,5241,297,51191,7351,8967,147212,82060,16821,782,11033,82431,62957,5026,43459,77963,203477,53528,6247,191852,87774,74164,215654,13467,1522,219964,28589,244104,16242,117821,67725,72570,156792,17186,15979,26990,44128,193014,35276,57125,16212,166451,68017,6905,77608,16364,53777,75921,76426,37975,26203,269296,64099,84122,12077,38533,830,4407,20139,963,43028,38902,42911,37503,83343,85045,16979,1165,60835,137387,58380,86990,110066,134540,56331,193845,81238,17922,163093,38744,110641,12502,56404,34862,26865,125964,12965,111648,25547,7771,27196,136980,9555,29551,107158,57885,18831,37705,35505,101742,13970,102109,62548,124657,23328,11124,89592,146376,248050,6241,22033,18337,80685,29898,11908,216623,67721,106162,146610,21377,15085,91552,42041,62560,122532,125336,102365,121537,142559,29693,223919,11515,110495,18776,22494,5895,185059,103592,229351,51220,100102,37027,257855,29359,54123,36066,106493,12244,79258,32002,432,56205,94836,90182,6726,14762,29391,48938,26864,38083,60364,3310,60192,14766,205567,57504,110760,22649,24666,46333,21517,3430,13135,28873,27052,158809,11597,20529,6695,23138,22960,37137,45574,6545,305877,43423,26153,24769,59844,14501,10430,134352,56169,13213,103432,49523,35181,13435,12408,129475,64620,230854,77390,51990,15653,83248,33466,44571,117828,51481,2187,10559,68019,18021,54895,48247,18354,33737,4554,108595,37288,39767,116707,9175,3726,108877,21616,83684,49862,1938,8543,276466,20134,108498,48770,102254,31914,131520,185291,100559,51890,209,19526,76471,50544,71814,99351,8172,198526,28816,20419,9109,98389,136777,76479,75596,30635,165417,48216,120220,25955,211071,39314,24308,32164,2559,146280,43403,9233,17947,90585,1786,86920,125662,2457,64741,32152,32918,122882,78538,44001,31723,56426,23375,103172,88177,145697,52506,49319,68016,31664,41488,18486,110400,7030,28241,986,109199,19900,42147,56864,65287,49183,7858,24e3,30453,840,16673,25907,68916,89927,6309,158335,36407,199737,130464,13137,59603,201778,195292,21015,42466,179062,172561,89492,11075,180407,31868,72493,20998,60217,9865,19530,39274,130266,54539,21623,12535,13505,40641,73375,4087,85633,2153,3117,70680,55788,92096,47509,98493,37490,271936,151475,3032,16171,96642,34106,78425,125761,19591,3366,19316,54508,24183,50786,194248,91528,33253,34622,108355,41741,705,3814,3883,108929,13203,67831,10142,59754,68208,29128,84820,56880,38794,24972,48571,40821,40476,18137,164254,24064,236309,79181,11282,395,39169,2013,51587,28551,9645,701,109513,115899,113566,12762,62045,58322,103726,41343,40866,244102,143816,2490,70346,40973,52618,15412,30720,104315,38917,42027,93676,17513,107418,20706,123890,13399,97727,24044,87962,65606,44250,98044,65276,74790,101473,19350,91570,1326,87790,172042,7577,100813,86896,85891,41512,108130,27794,14875,71431,12835,156250,58135,3759,22476,42176,115873,34686,56523,73643,108505,51491,20838,12721,32863,45700,29496,13700,34294,55360,29206,155942,123812,7706,163234,203,132720,49358,144431,8130,175788,35818,3270,76832,25710,54095,97274,28779,94621,74396,19092,128242,58067,20885,14670,93255,15107,63291,23654,126900,129421,59294,262659,9798,3251,67344,28600,44629,50672,29072,26999,31526,23183,49175,165843,175455,17282,175411,32022,45989,30298,90690,78118,83156,23749,35636,31317,7069,80381,94561,133756,14960,97404,6138,41065,78041,32843,16601,34123,9559,146529,123377,96395,54441,42012,84257,123541,10745,22139,106459,11720,150883,172651,154996,110538,4728,53447,25704,2009,71152,119354,21166,66604,1429,216162,8637,122250,63520,27180,29172,36124,276428,107787,77184,4680,14952,104903,24418,14793,51561,52931,8371,26342,48526,7118,92066,67280,40653,8847,34597,105438,14198,50163,61188,146286,50315,41205,170829,161496,585,197359,95056,1687,365794,91349,48507,5804,49263,5146,104902,96365,117343,132222,46084,96919,16875,8073,262381,79982,52663,13928,16056,153908,15145,109256,132308,18763,24904,167644,13618,40750,18686,147124,114709,150038,52849,2938,12568,48617,8778,5459,44202,44591,74914,17183,248689,13878,7822,80060,23116,194037,18487,2067,7798,43077,33678,244028,31320,74273,2794,19466,8218,36280,183997,48124,19416,29656,19280,98734,7715,18311,30701,133602,150307,126956,7378,2933,79903,13178,12593,86571,26604,92446,13574,44205,65699,427599,21118,8245,14407,27877,47936,33542,7916,26460,117762,21596,37818,2249,127359,209394,60044,47677,308089,36791,154971,31417,6998,150042,174360,12255,43009,29335,48739,3912,101398,53340,2580,146939,151295,45360,125275,15273,45383,27456,48761,23314,8750,60801,85823,104759,27894,123685,66968,39480,26917,55290,83305,2696,98390,57569,145853,340733,4919,20024,52268,30884,7413,203685,70989,112855,4129,50536,349518,68205,332641,159581,135361,236026,37563,176404,64899,6578,122033,63871,1850,85234,82089,66124,74145,121098,107351,12687,36881,117334,13136,14698,85933,93866,18047,32620,310,15094,46e3,88451,23632,36645,27940,87618,80520,58892,20976,27702,140090,96075,67841,103292,238964,87778,107338,17019,83427,67522,7302,8261,47570,116787,8730,80484,61772,174422,56005,131193,52875,14588,28471,59817,9586,15720,158155,51307,109734,15196,11025,59331,3884,52626,102602,84797,25158,27314,4437,20488,76214,189248,35023,114952,157376,2827,62439,102878,129749,36405,10329,109339,108633,36662,1254,13267,5470,87105,58004,15397,10434,159667,21864,52022,179464,3013,32147,31496,116832,18494,105502,129227,107267,50033,13481,9954,24267,22141,16257,116154,36185,950,115685,11305,176708,2048,178671,112573,287867,162328,497663,95170,50979,193861,50987,30368,136257,31830,46549,15119,169876,23788,17462,249887,57377,1949,35448,14791,43769,210091,3783,34612,282103,88380,245190,5457,20491,98908,11402,86899,117916,16028,162584,60644,320177,156096,31065,55876,22e3,77655,9992,23397,13757,317623,63978,215255,2443,17648,93231,27388,104529,93807,55505,140477,12046,112040,70887,40152,94365,112353,25063,114679,266061,71248,119555,15589,2244,617,14129,211431,70110,100652,7777,4383,85911,89221,21010,120615,58357,86405,37554,41647,18,15143,69662,60491,14714,186134,148344,42347,5410,168175,44535,42449,343894,129417,99682,20659,27272,140483,63455,222159,17536,13722,42637,62324,11976,114691,148109,2283,32057,182393,4295,147364,33705,2075,44303,30274,28331,63740,69740,29148,10346,44862,33716,73937,153333,12930,38784,247159,2515,41053,20256,83368,256189,54639,115240,5096,24661,175419,153552,26516,141,138176,63885,34115,47222,55709,2765,28479,38875,236608,12229,22921,77291,54426,45388,2860,57787,114579,295139,105782,17826,71066,19119,54364,69385,16568,12323,28057,33346,34919,124763,155533,101386,31644,8627,49001,303600,29868,63213,9103,77280,71333,9696,138789,37059,24823,5057,21352,32368,114208,56803,19424,10445,58514,8661,209508,26187,171838,10460,63454,14016,122504,41328,21329,46618,32493,38225,7855,31763,7945,29876,8734,6438,24205,97490,139977,130740,47323,33195,85390,57194,13813,60600,21313,96251,7699,27584,170521,139271,1363,4402,336738,129223,84983,69150,13147,3590,163929,207225,155260,55916,20288,4503,8398,98490,11773,27512,37113,84976,86558,28365,11756,116005,182148,13733,115313,47644,67208,85069,9347,14995,226141,14704,101835,41159,35314,13113,63526,214039,29978,50446,83339,17440,129441,72522,118641,97816,24907,73844,15717,118884,167255,96509,162793,30847,36849,51297,78974,77793,10427,1873,2972,9999,35074,28190,64297,146836,46298,60038,163007,108919,61219,2403,75022,127339,4233,110389,69022,9833,128097,88016,79390,222936,22570,94657,28462,56956,38803,81536,30474,152794,19566,16481,147408,74574,81895,20731,1918,1366,76367,187321,54494,24366,21690,61696,33283,107477,77499,31112,414383,74362,18463,218441,120929,59848,258629,201924,69269,454,19989,13054,59894,3623,58908,20681,35723,78523,102680,38988,184112,108087,50944,132704,52966,21699,18860,96349,201411,82697,85395,95658,5093,6427,177894,44191,32755,26961,155739,6249,31310,81030,26574,84311,120155,86730,113535,7424,48888,13516,45747,98098,20077,183995,81945,43210,26704,40420,75831,45648,11180,6855,57927,65528,124096,34851,2598,156633,107572,127352,38169,123845,60142,62722,105584,232364,23211,68120,1601,22169,89299,747,258039,80572,7258,152249,11862,101204,8834,121434,33761,19175,133142,46343,40178,48723,3589,41977,30210,38868,62257,10087,82658,87827,90646,16415,47552,351723,28298,72225,91146,272760,1701,11295,1652,109651,300747,51863,198800,29446,11794,32345,37538,22356,33102,37590,113544,37970,11478,179743,25454,103417,59905,221970,105196,145604,7817,164809,102360,16974,75840,255333,56902,6659,1954,645,59400,67769,7689,18675,5215,13793,20536,27852,3387,29523,259718,16860,94625,43143,29245,15848,233581,22685,63631,78557,22836,133302,84513,1348,51826,47129,98836,58284,1830,1749,94642,10933,6145,12506,10975,13879,103781,144434,10268,28409,32346,52968,121567,107374,77268,23686,35097,10501,155275,15303,47136,21102,168741,55332,90385,15996,84817,681,137803,25054,142275,6163,38175,8056,124296,240642,65621,4934,178205,16101,62803,60964,18230,100622,76465,44689,14545,9543,47514,16852,93380,28048,12047,107106,37575,101485,77047,57326,34819,96137,76916,6469,46264,115983,75768,87668,69942,13027,165,8373,114231,26434,52844,42799,182044,23580,146254,38081,43236,33883,146220,382894,14606,46035,36481,166621,35417,95382,2957,59384,60428,36358,66343,75378,22267,22950,83528,17577,56474,25285,4619,179691,75355,95836,53295,34588,171410,4487,14679,84208,44015,18562,109133,54101,11531,86052,174479,303157,28095,9953,35642,14564,39802,16145,77606,117406,53038,121117,53624,22062,1212,7632,127157,237292,189087,10478,127345,102515,181997,86752,87623,10966,121602,68783,68681,83042,114380,138349,191305,67176,50085,39016,1427,42384,1412,67118,122616,72389,25260,2237,13576,137346,19938,20304,2191,68759,5373,61364,238507,75814,23931,69565,38993,131741,38364,12528,87762,5679,129853,5310,186831,32653,90338,260176,389531,108118,26843,43985,50175,30563,25106,56965,18130,140428,4542,165503,117991,24219,229605,1819,129663,1240,3797,76093,18398,71339,51919,93043,27175,47060,216257,6483,35051,1217,16512,80798,129064,13225,69339,8548,237079,72298,2575,34280,51379,117910,55671,53345,247552,29486,39328,140821,34681,57045,60177,5004,90269,78522,2479,322607,48474,61296,13057,31558,4678,59271,6699,27044,31988,35944,12503,83480,4389,136508,3781,114121,70279,4488,155829,42214,2898,68191,75695,305850,45041,74344,106509,30087,17429,93292,12477,290,23080,114802,35714,18751,26554,105424,17775,2144,2412,100610,65192,113975,52975,180272,135050,129815,76238,106483,21440,63186,4260,46189,9711,28249,4169,23429,23390,8324,141585,63809,67668,38457,38063,39226,59972,1189,203916,62368,14403,16949,61767,85801,1739,40147,35049,76757,33124,62102,15780,103593,103009,53484,22952,67973,114645,6566,5245,50462,7601,8288,3513,194571,80276,1908,54592,5124,58571,2513,6800,273997,193904,1119,17991,117245,2508,129156,82366,26278,71465,63341,56943,39662,106116,94966,156875,9736,2204,122308,94418,27134,1280,24539,49022,45314,3764,50904,46424,30699,28087,293839,9400,33646,40165,822,147499,50263,116179,29085,11863,31314,5578,17797,5104,12454,1604,15342,219206,10232,67800,94261,25872,13565,90339,78971,75377,26649,41184,47695,11514,35369,20767,14227,41953,309396,148270,147938,33074,14453,27499,109019,39018,25738,240196,158931,52820,8612,95853,21524,137010,84901,70869,70021,116794,48404,38771,6732,1070,70990,187297,49140,5238,576,3564,253975,16027,16483,2811,37775,19034,25259,4053,2e3,70083,95774,19713,33431,92703,91314,42381,288770,48194,95985,3991,77418,13406,241328,245086,56533,35275,62725,9246,51924,70181,95331,16163,31410,79016,39312,120878,119371,275987,80124,27712,9186,220,23598,146167,85209,68238,282190,57048,31273,30555,80913,17594,75779,59160,135002,101219,189377,29225,96735,60126,62522,104e3,27620,86814,17240,147533,11001,5425,43682,410,49460,87270,69480,46315,59448,1816,76201,9431,11788,87960,29063,65539,47347,11678,33846,7008,196704,9895,6753,8633,120892,59970,572824,115934,6646,202559,892,48351,37611,251282,57823,67263,57750,26527,34485,90747,7685,88370,6144,64182,1709,41969,21458,62327,181657,49247,225330,122600,114574,107124,85361,111833,63243,71420,15655,191178,72430,18063,51425,54002,12364,53225,86557,18193,97580,41232,138398,67821,128724,8944,233212,101353,52099,42127,14006,120107,32789,32132,3498,18123,33758,56058,5779,128760,59888,98869,18445,84702,51911,13234,218379,20093,39031,8074,70195,20708,23462,24355,131384,60189,26390,10403,41060,7140,10781,49410,42261,87202,82566,41663,43105,60276,2768,5733,74176,28329,2297,145430,131632,83615,122915,105441,655,224102,5284,136426,67763,16294,188511,32538,61049,27893,3394,13951,159099,28542,17930,145360,9492,190122,32285,78855,26440,13570,58648,73908,4239,124561,2444,74172,53131,11468,10794,73566,11623,35343,64710,30481,4163,10328,38309,29901,10538,154377,76132,92405,24839,11679,3465,13449,11637,7824,2337,57754,1260,14458,41118,19878,38661,13416,159180,37074,163164,54137,28627,52134,184900,8520,40385,29546,30502,22386,66527,107458,6850,24022,47983,30603,35083,8934,304066,39500,9,28261,33026,77251,9374,44833,116312,34990,29236,63563,125639,135405,165398,159055,55690,88141,69643,236964,31983,25572,20436,36746,60896,31850,16179,11828,5888,3043,66368,9750,31167,7915,53111,36430,1333,64344,93659,20061,60596,180191,51630,6792,30244,43509,101058,22409,420,44210,109783,43223,27030,72477,72831,32679,29235,7675,47556,12258,39907,149412,84926,118247,24692,71717,105038,86009,45941,41189,89453,29856,52543,30627,226798,67303,59230,67415,34408,1367,99685,16867,128419,52147,4111,125381,117881,16173,44093,102224,31575,23234,24870,83790,127407,239098,3200,994,1255,100903,242275,117266,55116,38205,16140,29662,11307,40414,208793,123355,56470,4862,75600,30119,58218,70828,24075,26974,7802,192353,4851,5475,78720,66596,3409,28573,64396,30381,30690,59859,88256,5406,99945,103064,34463,37727,24238,86643,60088,4057,23741,5967,162904,38240,28356,93858,25510,122879,6897,3278,7057,11971,4400,35461,211413,21395,59615,39471,87233,55795,128426,3051,22470,41950,14705,3974,180108,80476,78442,204996,91987,15634,67610,139015,142373,35611,51134,10387,4353,153456,57749,181039,14183,68447,151532,21107,36452,20551,3186,46247,46383,129666,88736,140662,146243,2066,8360,7978,64818,106963,17896,47801,10723,114821,223295,74192,3293,3393,16987,74064,11277,91622,4270,29828,27951,387869,103235,1374,61988,120083,477,145892,128378,11779,211263,61354,18221,17869,46530,83061,108538,157981,90608,67199,95080,49064,195814,12302,66307,10348,231346,160732,112859,63633,146558,21271,31037,198802,47622,12862,95710,3910,77850,73961,85585,34752,61e3,4082,24595,103679,71107,8208,79568,150019,16615,24961,139857,32664,197366,4559,54735,32696,4126,162019,75698,13916,70108,159638,19834,9349,24675,175560,49643,18206,52459,27992,10809,88865,401975,133172,29e3,34558,30915,3658,25834,42430,36562,125265,18182,10155,40149,97082,208980,19575,60853,90529,66545,9600,789,46420,2317,88593,55595,98980,115302,5742,169155,1073,177901,3472,11189,63711,78643,65472,50459,127979,93,42202,67053,21720,157650,11145,141378,42033,22824,85705,79114,35584,15974,1510,54172,28562,12451,104226,19190,97151,73024,20948,5151,81741,21499,29006,84183,198074,54003,45120,170125,26240,35177,28389,64863,79974,60778,176915,232183,45342,2038,80253,41564,40703,32689,5430,100689,5366,23007,134279,14266,26712,73993,24934,64242,52113,102887,61801,46415,201049,54251,62133,122757,164883,30815,139966,2319,30842,766,13362,10287,134518,86111,81665,82440,28333,43019,18963,8804,161944,23439,102144,101145,80029,39052,248708,30350,117340,11878,128467,974,138625,63961,5237,74778,61834,67040,43814,13690,65947,33809,232476,115258,181745,28824,94013,9510,10246,93722,81976,7217,114383,3493,16014,69045,72692,12145,80981,9507,6692,1620,60820,330444,35474,33962,4797,7053,295463,46445,27026,12491,77988,49524,35675,90947,29114,166705,101385,133782,32704,6186,84595,176031,185623,45966,151302,63069,1699,107491,947,15458,74452,196212,6046,10498,12163,10239,35191,243951,9277,9090,29539,54460,22820,26514,112549,60372,51753,48756,21812,70861,260326,41,44222,10441,16961,48148,138771,216194,5914,52153,53400,212036,56519,26245,10117,45888,15294,138019,90913,26368,43842,42111,23348,6082,194845,161089,156206,51546,11647,30759,302912,262094,8635,78876,26535,35283,54183,31183,85484,147873,12989,5197,6356,72894,65347,20150,27370,73787,1493,45918,12366,190217,20724,13858,10981,67449,81213,7553,14115,72242,271517,11842,48310,88743,143726,22177,3290,243231,58452,62937,12592,1654,40066,33477,13751,9921,128442,15868,7106,75236,83773,10775,36938,10482,170465,17368,17469,161508,32752,98340,800,19824,264456,3901,87319,2867,26782,9630,113102,185815,24197,44584,86366,40224,3636,140916,31731,267731,9567,53678,72984,29389,27963,17106,50282,284911,60170,8322,12608,23374,89652,5268,39044,229766,8869,151350,31436,177342,12269,183212,120418,116270,2843,78888,69192,7865,184099,1086,129897,18383,70508,20242,18508,229924,124569,35749,50589,55626,9884,83115,40971,30671,18135,14452,38861,17844,201826,5549,26413,17189,13561,38539,10679,143331,3314,36785,171194,49685,187713,67506,4618,104039,17060,195080,50648,33159,19238,67559,134840,28599,157523,17130,38064,117398,94355,31918,13575,34538,40326,13997,3494,348283,62481,26862,3603,104426,244363,153709,112487,304612,199674,41239,35545,54869,293005,28223,26277,26899,4533,18518,15492,38587,80488,70485,160395,263,60162,11382,222152,4696,250751,51921,182609,10707,48463,46243,1227,49111,111564,46502,33342,56846,68541,63559,858,139927,16654,229375,76759,26478,33205,95828,23399,92945,2637,35630,28470,143992,50214,14174,21456,166191,65665,1711,21594,78019,97599,111701,36,147151,110246,189022,43021,30397,40757,131935,42065,73335,48039,26596,28984,15102,2361,7421,202167,69744,43766,52826,3642,83304,33873,75140,63169,192389,36551,92748,13039,123959,233220,21738,84447,77230,20228,187852,19095,25799,92136,108774,29237,53947,2299,118106,2687,8830,42331,202924,33667,2023,73763,30704,19363,19779,16737,35629,48081,24068,101013,162338,291912,13749,24745,328289,167679,70086,48299,23306,16732,17801,43322,54589,3586,63653,43624,53474,925,109177,251316,43805,13082,19511,86565,142182,92461,17117,101033,103319,64589,4022,4351,235897,5352,82705,107142,46391,156084,5860,61365,10558,13045,7717,18357,33922,12590,33065,6928,46993,783,46937,67846,8952,26295,6107,119656,18799,17458,50747,4229,179559,112727,118080,20683,41464,125468,51560,49749,44231,7359,35339,62988,136487,67015,5208,29150,24956,105186,48858,6143,18097,6972,16404,73489,58742,97196,36357,164616,5834,32267,13746,147733,15113,132091,34127,106298,39729,106426,22294,9780,15602,36213,71502,42808,66802,599,60755,5851,39120,67363,108623,126368,72770,91263,32486,30596,151717,7951,52002,43103,11768,68942,40901,39344,24037,127500,116890,48403,16926,86750,17745,48648,159545,34460,58419,5634,114317,67865,31462,23352,24010,98185,125708,69686,68337,13610,26271,70691,2980,4768,27225,102402,75453,28106,8104,6931,1176,6274,6475,112635,22498,6176,238686,26832,28893,90319,14441,15682,15087,39517,45270,109134,104440,45965,47645,81772,7876,52683,87720,12898,4505,185665,2769,113401,15664,57592,105229,137381,97059,119268,6876,43309,33886,128363,35476,144249,67013,143587,83367,25703,91436,59347,53236,2289,16519,19844,46309,58558,99834,23313,218816,231303,36388,51333,183535,109792,139277,54306,90139,18235,8275,32710,37677,82464,86025,92204,88842,117723,37570,128723,234242,76350,73795,34896,148247,58424,11105,11744,45746,63372,17118,49772,199520,81902,38004,22911,33752,3125,1995,53792,4689,26909,108150,146062,69674,41811,161444,84855,8999,28561,16731,93937,3189,21967,24890,22943,1356,145300,51569,28802,517,118679,31703,40607,48098,108854,25003,10233,73969,177495,5248,24516,215347,146192,48712,60626,69188,40735,5866,586,101541,6509,47590,52129,5969,222045,110933,25733,24223,65339,62812,2414,155418,35819,16022,78423,43138,20995,128255,240673,46745,236093,72176,57085,97841,61248,107,36068,193177,105427,55726,215229,20446,47228,100420,87091,14429,121708,23605,21157,187721,21880,2997,203976,99166,95068,25877,7724,98925,83401,4829,13182,18229,13718,239662,38653,116505,153497,30589,89029,38962,181302,43853,78872,180301,4786,248240,7401,106136,112590,77745,19731,60880,77789,125748,135487,5975,48627,34084,12419,215770,47557,254582,10364,106495,21856,67539,88981,38805,21428,48732,42316,12149,16078,52808,25327,51322,33850,51147,12253,122354,46077,56483,254553,115417,81834,150991,94662,86668,7381,12841,100650,18218,15741,22372,68294,50705,15535,84660,61887,22553,72299,31361,24824,17743,46820,64288,31582,77006,111674,116384,30760,80920,86149,77192,51979,79691,60342,122805,103800,240873,160744,233114,78962,54920,8608,3484,316104,72548,24337,5088,230040,21926,10172,36838,26,86221,83458,102176,12062,17571,41929,41170,28428,68239,41750,103930,2634,18313,53019,34825,97837,63115,24606,73157,152474,14715,91439,37033,109806,140259,30668,174760,380,135597,95673,136073,65073,134249,13829,17279,122305,4420,46444,10237,64848,203623,70728,10349,182885,65075,24519,25783,40318,34139,22222,63394,55266,102764,41422,20126,65100,90408,53640,35128,48932,11192,38935,96839,34782,39492,19396,41332,6250,5511,19492,51304,25936,104466,54099,73771,86115,5080,7669,30891,111700,13931,25276,72289,135447,14820,258641,25265,31005,281179,75286,393,95359,14623,13584,6680,101227,80173,44933,76666,54542,13244,39348,458,25379,109451,134348,81143,6959,65554,12027,51311,8716,57589,140731,28467,23316,17272,30458,25980,55229,77197,83798,28302,114784,7428,34548,26241,14712,39336,103304,18928,54080,12870,334,87722,15208,16895,142098,114262,39820,83913,57817,28682,7721,14900,108672,11250,62246,42849,415188,1724,26555,24549,25505,26443,107450,145899,61035,43528,6901,60726,65906,267741,21338,147590,42079,18924,73017,135236,15393,5206,4026,84185,1531,5988,113890,82647,303391,7386,69844,71611,189865,76523,31877,13315,19314,198575,32821,1928,67641,25913,104475,103489,3297,70391,18406,15446,113347,19295,93790,27856,1792,167471,116449,8541,4408,41757,63233,25765,86680,64501,27034,24816,34975,6079,4486,49693,36229,16917,21581,62426,27862,11612,54284,35702,194034,355,24277,48262,87411,70504,310164,118018,12516,47559,43502,57433,107139,9290,66533,80863,14634,34312,91725,28606,21342,67241,72355,43244,375789,37402,174015,105070,8342,44167,67494,1890,16365,11723,271002,1865,47918,8350,45564,27742,25110,125803,8553,49504,81925,62211,4534,15491,19011,80373,206920,667,102405,128623,245524,5553,113309,192739,65766,19567,22832,261958,29679,21293,71134,20962,105123,24721,860,21752,33448,18372,157167,94822,35770,173224,232737,75729,28937,46828,28062,25453,5207,140366,36665,30652,6169,67920,150458,92040,23186,184604,92330,20891,176492,49427,27828,38305,42495,143982,49560,25503,90043,29747,65328,47830,12932,11068,77721,9003,25213,94205,140426,46090,89945,138173,192691,33329,112232,129905,35709,27514,1841,19957,31411,127476,53572,17497,173549,55063,175135,19841,69314,5192,237921,117660,150697,4060,273045,50414,98940,65348,153665,164423,58804,156695,48994,213928,86036,28608,8355,39574,34540,16927,135680,18374,151587,10830,53805,16878,16623,4282,48030,8537,14986,46102,13062,72897,72,33050,108227,39451,45935,651,113320,40535,95176,57450,48843,5003,19019,10407,211163,3848,1068,4988,32091,30095,41692,15099,43602,107434,50744,7627,171349,16313,150832,352665,207750,33937,38256,51091,156e3,87889,90663,84175,24908,114900,50365,31494,83829,5398,169342,47521,54818,18935,8356,43094,41212,174536,10082,92550,6678,60614,23355,69721,14796,34149,128830,58187,3179,208,40325,28399,225029,401412,51150,31580,207268,6657,10993,69818,64282,289845,23308,12961,38447,6681,52944,31855,2572,47646,120728,179148,37240,45196,218274,4816,3695,21961,50084,35209,18073,51452,27004,6100,33941,1377,84831,171214,85,141510,9078,99227,32610,6417,11718,49868,65579,87902,73018,49062,46280,61742,21512,40862,107733,15941,29168,157765,144919,14487,5767,158014,140070,7241,573,71584,16921,223566,40331,179473,35081,47926,140885,41508,52104,59180,42310,32811,29048,123517,102413,80208,10104,14746,12649,153641,126022,37965,113017,4171,83,142592,2809,6362,50416,71323,116894,260776,16204,1524,5760,30351,12658,20703,54403,36083,45408,74772,4946,14485,50759,111222,10890,2195,167147,92962,130534,16283,177256,35016,15472,210156,151187,73922,117691,43250,52051,37392,24811,24358,30830,5775,818,21969,1476,127322,151783,58392,31021,106913,65215,89407,90802,28531,11690,20234,95249,44602,37256,18707,11928,5161,4410,26571,51903,49768,22008,25252,65780,209499,68769,203726,13249,137363,48845,86823,6658,5674,31881,1083,1823,108676,34518,166752,13791,14287,91576,91429,8665,11529,26401,16191,91972,30964,5254,28486,54697,79613,66520,18447,22870,45203,194466,22822,51703,12278,76716,44595,73455,33546,12235,144843,36154,51247,11116,33040,3180,225753,60864,1972,28469,12891,28879,10338,144157,56294,353058,38302,41447,87532,110616,27065,168438,6557,1213,50804,144643,24817,2390,136531,38174,247513,16190,4059,122791,131994,137430,39506,57650,16305,5188,54309,106128,20628,88071,67394,395446,250285,66176,91254,1399,114196,43915,60230,44853,27206,106353,43013,18733,345105,226453,51202,16607,57106,117175,35492,10476,89598,127439,15187,39624,13688,61570,10615,31111,59370,6238,175252,32143,224492,41388,95408,34384,148238,78307,38959,9340,160091,61443,15737,11216,41244,170,38299,102443,113097,26382,14027,33707,3957,76300,66160,19431,18900,6952,1717,108656,82206,188021,257335,27295,43999,41210,31777,46956,57457,12657,11489,15697,48060,204748,53583,82422,284790,30503,137341,8120,19615,220311,15991,10217,63424,9808,67431,70976,98221,4491,15177,28535,144789,751,13230,2394,1504,33977,132104,30316,22230,931,97193,185240,24826,22687,174322,15307,22988,1390,188745,180325,29580,59068,74903,18994,29195,79,15436,7622,38462,11566,138710,44828,45774,37768,99236,68137,84083,19282,22698,17134,74807,126662,173497,46248,16938,119735,3212,28292,213652,49013,9975,32180,45660,86250,4801,68788,95490,77482,113751,11994,44624,94452,46839,128497,100316,5798,58588,73184,202987,65417,37790,88524,1606,43156,97964,105717,34947,11203,100060,37742,130074,93653,107799,94311,196106,41347,8035,10780,16390,27883,118236,167395,1979,25006,19375,31628,18916,144723,78502,114047,103107,86492,107686,5844,20934,206963,23556,22591,16562,146333,20167,10471,117434,33085,2863,9740,36669,41849,37271,22790,18209,28979,8231,12952,54408,21731,25130,45208,55748,138120,75826,414,29593,9925,292865,25999,683,123149,7036,92159,86055,61827,103680,23176,54918,58466,57578,13305,5709,86479,16697,31064,17660,200919,10770,49793,33423,32370,52047,16488,62555,6459,8426,83493,7763,59725,82812,18628,67760,79405,68557,9612,7673,28102,56517,69620,171797,32458,29541,15870,81109,32080,207644,71495,21202,11039,91036,61230,2810,130800,32260,4613,60590,37112,75214,33979,126402,155062,30642,63875,12810,194463,82799,47664,16725,36685,43367,61099,449,172150,102867,21691,301838,36745,7130,18671,57316,34852,38034,54182,35578,65900,99486,19771,3456,2658,16914,99866,28390,28109,8262,21147,34353,20006,4228,137085,1675,203023,283196,198286,214375,163329,290603,152574,40471,83506,30068,14730,23177,131539,34759,27668,32178,71896,104799,116305,85430,119262,42860,25160,8911,23428,49437,105322,6519,16203,6349,74711,1230,38045,8540,75165,44736,25909,51026,317034,4984,32281,91312,27060,44431,17817,45363,155937,239085,35697,59784,91993,29531,126740,213757,76560,167776,285273,24262,8237,65030,41160,74437,48804,118916,13159,37842,1031,75349,1478,11655,108777,23435,277425,101734,67469,70231,124711,43532,28514,65526,54956,1e3,21882,17728,25302,40952,52214,149632,1999,2111,3259,63362,89961,220561,39777,26335,9063,10572,12416,34551,34623,38604,24723,5947,15588,69927,66252,119177,69173,46629,28714,70715,212408,20521,406913,74380,11716,50659,50862,37009,88460,130101,7210,53853,538,65120,151950,55806,163748,52837,13153,21100,16674,64536,6091,138201,44837,58547,3723,163,2177,32288,85454,34033,8497,14282,25742,10535,10741,79559,117493,243787,49337,100718,79495,40139,42956,7551,55433,15421,31509,23034,45081,547,61176,53434,328001,8470,36263,30145,4519,74173,53935,11845,73774,60211,78025,3,4102,73782,109293,315332,48412,26683,13714,6865,20128,18490,104141,325,39470,171970,115860,15707,7268,73301,74336,31370,2368,111827,107757,136231,142844,97138,96638,84053,38691,23801,1588,10573,122098,77039,240,186135,146101,11996,18143,112963,46171,155836,348769,47795,121213,116266,132515,3344,144804,31286,99187,255838,129694,35894,48779,55235,148582,71967,65282,15174,13920,47080,6147,108242,157593,125025,7136,1286,28957,127956,28402,98813,20805,7532,109417,40610,5041,32958,15142,18408,108596,33543,50517,27748,80114,233434,91447,487,37094,100048,30541,43477,10639,89862,155868,37667,8726,60684,237903,73408,99589,12190,38739,97348,3914,13594,2680,149016,13907,30171,28343,23530,115225,61104,35821,147679,14337,4297,244282,24085,326976,56428,7851,21303,131620,71446,83253,68692,111870,5224,15813,38197,49026,45057,13660,3306,76345,40671,27905,91072,996,68527,62085,91351,122634,55109,168209,2024,27560,112707,17352,8306,167115,169921,166958,5031,46020,11844,67284,19130,76185,6920,32849,5450,14610,22451,21002,17392,31872,66682,84796,13709,40210,59898,12029,8719,53564,21462,91884,21647,88379,194428,12754,37797,132826,160016,22567,54383,53186,77611,31107,8339,4694,19185,90355,23597,17222,140675,28442,23668,55977,9128,61555,28774,155229,17658,9390,24379,69357,15752,127381,239631,62460,93181,55913,45133,140155,18676,25249,33164,29581,82837,67223,22362,29975,7317,52813,1943,29613,20012,207130,49617,49651,5636,15334,36313,29226,28084,95247,72072,19e3,224932,15811,114,32127,38097,37508,88507,37225,27359,91626,12193,69279,20608,11055,88156,92808,2152,57259,55275,72789,24475,104414,1708,9882,3818,48661,66897,1631,34806,227930,85815,87753,18321,250664,72733,25107,206797,50891,8082,196411,92596,96764,152823,65514,22819,387277,62176,51225,40329,15563,189,3659,73670,64357,51793,275136,33482,86653,74615,67058,11318,125720,15388,22388,8267,1730,102663,170910,40784,7144,85373,13040,7088,94309,583,44224,140424,77439,18496,164026,36578,4722,9151,5824,63365,26510,35199,40500,79277,32495,44614,35233,9566,203293,152144,7097,2330,183480,98629,13423,330887,44130,68600,30939,97829,31012,345465,56747,94879,4939,160027,149761,99423,46099,32251,15332,8761,96094,128555,5763,235318,222223,55729,30241,55420,201746,3987,81382,8259,49325,23287,7719,24633,251100,92311,18591,110533,64759,170260,393860,7175,21144,132887,3593,75346,101277,91109,16387,259187,11627,57459,173829,44694,55780,49797,89192,120443,62622,3904,14814,23887,1027,112258,64955,99800,11132,66353,36202,48624,18158,88481,96882,43059,11040,2455,7077,21651,181159,99126,100434,61388,68186,19161,110468,120052,8819,55324,41494,7014,37689,3618,87729,92615,207943,9823,128657,12587,15857,6379,67628,51216,71775,157617,63244,1503,3864,218754,110864,5769,21492,7243,1192,87921,85529,31512,18537,42698,35350,73510,84474,34301,8991,21013,35034,566,38832,19838,35586,37216,39413,55006,12178,59742,856,84563,6900,25632,17437,49786,30723,13847,70845,4044,7843,23944,235976,55530,48942,6518,20939,73769,192653,52936,95207,23895,132542,142982,22632,87452,48042,54018,178468,10728,26230,23559,363,81269,142012,5718,346258,31456,84333,246476,51018,66692,101804,120570,39962,30373,70593,2864,60541,19425,54209,104092,7201,31545,48018,25865,15442,46257,40443,8328,6451,111782,47527,97754,33046,470,245116,31095,39,91934,87208,73470,36708,36521,12801,70624,36272,8892,79768,12427,55454,103756,5908,52390,62962,22720,141138,94634,41689,128402,126390,6628,106394,35527,134394,82727,254651,194502,148064,89549,3202,28359,957,21954,27906,49840,142747,8307,24206,48978,1186,71728,133038,71474,91306,6333,110959,74600,70387,18983,62609,56057,22970,1147,135850,1321,28834,3578,59715,102227,32827,81415,99952,55636,257598,390,22702,35701,85872,402916,39216,189795,14929,19467,10112,144422,61514,5279,63421,134686,41436,8424,51925,10598,132295,124416,4604,194739,210929,57866,31829,51626,50007,9976,91878,61906,56168,81906,60918,61859,40017,23059,16887,40927,62064,12785,32893,32913,21782,93965,20169,44387,79084,38463,11457,93950,27127,157050,2697,337088,5116,54128,48255,33279,8821,27352,25515,124022,65710,28906,38557,33390,1722,104435,72215,38551,12094,30978,25113,6671,37355,175109,42862,98024,65406,221276,59624,118012,64637,78760,86697,21426,1639,40350,12584,67193,84144,31396,7863,143011,69629,63112,9454,28666,65798,46372,134721,6314,51402,30837,151922,2847,38676,38008,92823,136245,17540,5504,109295,205242,37606,5211,214892,1586,20670,208711,137743,19328,40652,16995,20023,14657,154919,34422,12996,13918,38221,47690,16398,2959,37680,89122,6721,1984